/*! For license information please see sdk.min.js.LICENSE.txt */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(this,(()=>(()=>{var t={153:function(t){var e;e=()=>(()=>{"use strict";var t={147:t=>{t.exports=JSON.parse('{"name":"indigitall-web-core","description":"indigitall web core","version":"4.1.1","main":"index.js","author":"Smart2me S.L.","homepage":"https://indigitall.com","devDependencies":{"@babel/preset-env":"^7.18.10","babel-loader":"^8.2.5","filemanager-webpack-plugin":"^7.0.0","idempotent-babel-polyfill":"^7.4.4","script-loader":"^0.7.2","webpack":"^5.74.0","webpack-bundle-analyzer":"^4.6.1","webpack-cli":"^4.10.0"},"scripts":{"test":"echo \'There are not tests\'","public":"ws --directory ./public --port 80 --log.format dev","build":"webpack --config webpack.config.js --mode=production","build-dev":"webpack --config webpack.config.js --watch --mode=development","delete-node-modules":"rm -rf node_modules/ && rm -f package-lock.json","install-core":"npm install && npm run build"}}')}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return(()=>{n.r(r),n.d(r,{default:()=>U});var t={};n.r(t),n.d(t,{BaseClient:()=>_,BaseRequest:()=>O});var e={};n.r(e),n.d(e,{Channel:()=>b,Device:()=>w,DeviceStatus:()=>P,ErrorDictionary:()=>I,ErrorModel:()=>m,EventType:()=>S});var i={};n.r(i),n.d(i,{CommonUtils:()=>R,CorePermissions:()=>T,CryptoUtils:()=>C,ErrorUtils:()=>v,JsonUtils:()=>D,Log:()=>y,LogLevel:()=>p,Validations:()=>x});var o={platform:"webpush",version:"0.0.1"};const s=n(147);o.version=s.version;const a=o=Object.assign(o,{client:{URL_BASE:"https://device-api.indigitall.com/v1",URL_DEVICE_V2:"https://device-api.indigitall.com/v2",INAPP_URL_BASE:"https://inapp-api.indigitall.com/v1",INBOX_URL_BASE:"https://inbox-api.indigitall.com/v1",CUSTOMER_URL_BASE:"https://device-api.indigitall.com/v2"}}),u=new class{constructor(){this.storage=this.isLocalStorageAvailable()?window.localStorage:null}isLocalStorageAvailable(){try{const t=window.localStorage,e="__storage_test__";if(t)return t.setItem(e,e),t.removeItem(e),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==u.length}return!1}setItem(t,e){return null!=this.storage&&(this.storage.setItem(t,e),!0)}getItem(t){return null!=this.storage?this.storage.getItem(t):null}deleteItem(t){return!!this.storage&&(this.storage.setItem(t,value),!0)}clear(){this.storage&&this.storage.clear()}},c=u,l=new class{constructor(){this.TAG="[IND]IndexedDB: ",this.DB_NAME="indigitall.indexedDB",this.DB_VERSION=1,this.DB_STORE_NAME="indigitallStore",this.DB_STORE_MODE="readwrite",this.DB_KEY_PATH="id",this.DB_STORE_INDEX="storeIndex",this.IDB=indexedDB||mozzIndexedDB||webkitIndexedDB||msIndexedDB}async getDB(){return new Promise(((t,e)=>{const n=this.IDB;if(n){const r=n.open("indigitall.indexedDB",1);r.onupgradeneeded=function(){r.result.createObjectStore("indigitallStore").createIndex("storeIndex","store.key")},r.onsuccess=function(){const e=r.result,n=e.transaction("indigitallStore","readwrite"),i=n.objectStore("indigitallStore"),o=i.index("storeIndex");t({db:e,tx:n,store:i,index:o})},r.onerror=function(t){e(t)}}else e(!1)}))}async get(t,e){return new Promise(((n,r)=>{t||r(!1),t.index.get(e).onsuccess=e=>{e.target.result&&(this.close(t),n(e.target.result.store.value)),r(!1)}}))}async put(t,e,n){return new Promise(((r,i)=>{t||i(!1),t.store.put({store:{key:e,value:n}},e).onsuccess=e=>{this.close(t),r(n)}}))}close(t){if(t.tx)try{t.tx.oncomplete=()=>{t.db.close()}}catch(t){console.error(this.TAG,t)}}async setItem(t,e){try{const n=await this.getDB();return this.put(n,t,e)}catch(t){return t}}async getItem(t){try{const e=await this.getDB();return this.get(e,t)}catch(t){return t}}},h=new class{constructor(){this.SESSION="indigitall.session.storage",this.session=this.isSessionStorageAvailable()?window.sessionStorage:null}isSessionStorageAvailable(){try{const t=window.sessionStorage,e="__storage_test__";if(t)return t.setItem(e,e),t.removeItem(e),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==h.length}return!1}getItem(t){return null!=this.session?this.session.getItem(t):null}setItem(t,e){return null!=this.session&&(this.session.setItem(t,e),!0)}clearMessages(){this.session&&this.session.removeItem("messages")}},f=h,d=class{constructor(){this.storage=c,this.db=l,this.BASE_TIME=60,this.REPOSITORY="indigitall.repository",this.APP_KEY=this.REPOSITORY+".APP_KEY",this.VAPID_PUBLIC=this.REPOSITORY+".VAPID_PUBLIC",this.ENABLED=this.REPOSITORY+".ENABLED",this.DEVICE_ID=this.REPOSITORY+".DEVICE_ID",this.SERVICE_SYNC_TIME=this.REPOSITORY+".SERVICE_SYNC_TIME",this.LOCATION_ENABLED=this.REPOSITORY+".LOCATION_ENABLED",this.LOCATION_UPDATE_MINUTES=this.REPOSITORY+".LOCATION_UPDATE_MINUTES",this.REQUEST_LOCATION=this.REPOSITORY+".REQUEST_LOCATION",this.BROWSER_PUBLIC_KEY=this.REPOSITORY+".BROWSER_PUBLIC_KEY",this.BROWSER_PRIVATE_KEY=this.REPOSITORY+".BROWSER_PRIVATE_KEY",this.PLATFORM=this.REPOSITORY+".PLATFORM",this.BROWSER_NAME=this.REPOSITORY+".BROWSER_NAME",this.BROWSER_VERSION=this.REPOSITORY+".BROWSER_VERSION",this.OS_NAME=this.REPOSITORY+".OS_NAME",this.OS_VERSION=this.REPOSITORY+".OS_VERSION",this.DEVICE_TYPE=this.REPOSITORY+".DEVICE_TYPE",this.SUPPORTED=this.REPOSITORY+".SUPPORTED",this.SERVICE_TIMESTAMP=this.REPOSITORY+".SERVICE_TIMESTAMP",this.LOCATION_TIMESTAMP=this.REPOSITORY+".LOCATION_TIMESTAMP",this.PERMISSION_LOCATION=this.REPOSITORY+".PERMISSION_LOCATION",this.SET_LOG_DEBUG=this.REPOSITORY+".SET_LOG_DEBUG",this.NEW_USER_TIMESTAMP=this.REPOSITORY+".NEW_USER_TIMESTAMP",this.EXTERNAL_ID=this.REPOSITORY+".EXTERNAL_ID",this.REGISTERED_BY_COOKIE=this.REPOSITORY+".REGISTERED_BY_COOKIE",this.LOG_LEVEL=this.REPOSITORY+".LOG_LEVEL",this.LATITUDE=this.REPOSITORY+".LATITUDE",this.LONGITUDE=this.REPOSITORY+".LONGITUDE"}setItemSessionStorage(t,e){f.setItem(t,e)}getItemSessionStorage(t){return f.getItem(t)}clearSessionStorage(){f.clearMessages()}setStorage(t,e){c.setItem(t,e)}getStorage(t){return c.getItem(t)}clearStorage(){c.clear()}setBrowserPublicKey(t){c.setItem(this.BROWSER_PUBLIC_KEY,t)}getBrowserPublicKey(){return c.getItem(this.BROWSER_PUBLIC_KEY)}setBrowserPrivateKey(t){c.setItem(this.BROWSER_PRIVATE_KEY,t)}getBrowserPrivateKey(){return c.getItem(this.BROWSER_PRIVATE_KEY)}async setAppKey(t){c.setItem(this.APP_KEY,t)}getAppKey(){return c.getItem(this.APP_KEY)}setVAPID(t){c.setItem(this.VAPID_PUBLIC,t)}getVAPID(){return c.getItem(this.VAPID_PUBLIC)}setEnabled(t){c.setItem(this.ENABLED,t)}getEnabled(){return c.getItem(this.ENABLED)}setServiceSyncTime(t){c.setItem(this.SERVICE_SYNC_TIME,t*this.BASE_TIME)}getServiceSyncTime(){return c.getItem(this.SERVICE_SYNC_TIME)||1*this.BASE_TIME}setLocationEnabled(t){c.setItem(this.LOCATION_ENABLED,t)}getLocationEnabled(){return c.getItem(this.LOCATION_ENABLED)}setLocationUpdateMinutes(t){c.setItem(this.LOCATION_UPDATE_MINUTES,t)}getLocationUpdateMinutes(){return c.getItem(this.LOCATION_UPDATE_MINUTES)||30}async setRequestLocation(t){c.setItem(this.REQUEST_LOCATION,t)}getRequestLocation(){return!!c&&c.getItem(this.REQUEST_LOCATION)}async setPlatform(t){c.setItem(this.PLATFORM,t)}getPlatform(){return c&&c.getItem(this.PLATFORM)||a.platform}getVersion(){return a.version}async setBrowserName(t){c.setItem(this.BROWSER_NAME,t)}getBrowserName(){return c.getItem(this.BROWSER_NAME)}setBrowserVersion(t){c.setItem(this.BROWSER_VERSION,t)}getBrowserVersion(){return c.getItem(this.BROWSER_VERSION)}async setOsName(t){c.setItem(this.OS_NAME,t)}getOsName(){return c.getItem(this.OS_NAME)}setOsVersion(t){c.setItem(this.OS_VERSION,t)}getOsVersion(){return c.getItem(this.OS_VERSION)}setDeviceType(t){c.setItem(this.DEVICE_TYPE,t)}getDeviceType(){return c.getItem(this.DEVICE_TYPE)}setSupported(t){c.setItem(this.SUPPORTED,t)}getSupported(){return c.getItem(this.SUPPORTED)}setServiceTimestamp(t){c.setItem(this.SERVICE_TIMESTAMP,t)}getServiceTimestamp(){return c.getItem(this.SERVICE_TIMESTAMP)}setLocationTimestamp(t){c.setItem(this.LOCATION_TIMESTAMP,t)}getLocationTimestamp(){return c.getItem(this.LOCATION_TIMESTAMP)}setPermissionLocation(t){c.setItem(this.PERMISSION_LOCATION,t)}getPermissionLocation(){return c.getItem(this.PERMISSION_LOCATION)}setDebugLog(t){c.setItem(this.SET_LOG_DEBUG,t)}getDebugLog(){return"false"!==c.getItem(this.SET_LOG_DEBUG)}setLogLevel(t){c.setItem(this.LOG_LEVEL,t)}getLogLevel(){return c.getItem(this.LOG_LEVEL)}setNewUserTimestamp(t){c.setItem(this.NEW_USER_TIMESTAMP,t)}getNewUserTimestamp(){return c.getItem(this.NEW_USER_TIMESTAMP)}async setExternalIdRequest(t){c&&c.isLocalStorageAvailable()&&c.setItem(this.EXTERNAL_ID,t),l&&l.IDB&&await l.setItem(this.EXTERNAL_ID,t)}async getExternalIdRequest(){let t;try{c&&c.isLocalStorageAvailable()?t=c.getItem(this.EXTERNAL_ID):l&&l.IDB&&(t=await l.getItem(this.EXTERNAL_ID))}catch(t){}return t}setExternalId(t){c.setItem(this.EXTERNAL_ID,t)}getExternalId(){return c.getItem(this.EXTERNAL_ID)}async getDeviceJson(){return c.getItem(this.DEVICE_JSON)}async setDeviceJson(t){c.setItem(this.DEVICE_JSON,t)}async getRegisteredByCookie(){return c.getItem(this.REGISTERED_BY_COOKIE)}async setRegisteredByCookie(t){c.setItem(this.REGISTERED_BY_COOKIE,t)}setLatitude(t){c.setItem(this.LATITUDE,t)}getLatitude(){return c.getItem(this.LATITUDE)}setLongitude(t){c.setItem(this.LONGITUDE,t)}getLongitude(){return c.getItem(this.LONGITUDE)}},p=Object.freeze({DEBUG:1,INFO:2,WARNING:3,ERROR:4}),E=p;class g{constructor(t){this.tag="[IND]",t&&(this.tag=t),this.level=E.INFO,this.setLogLevel((new d).getLogLevel()),this.log=[]}setLogLevel(t){t&&t>=E.DEBUG&&t<=E.ERROR&&(this.level=t)}static addedAsString(t){return"string"==typeof t?t:JSON.stringify(t,null,2)}d(){if(this.level<=E.DEBUG)for(let t=0;t<arguments.length;t++)this.log+=g.addedAsString(arguments[t]);return this}i(){if(this.level<=E.INFO)for(let t=0;t<arguments.length;t++)this.log+=g.addedAsString(arguments[t]);return this}w(){if(this.level<=E.WARNING)for(let t=0;t<arguments.length;t++)this.log+=g.addedAsString(arguments[t]);return this}e(){if(this.level<=E.ERROR)for(let t=0;t<arguments.length;t++)this.log+=g.addedAsString(arguments[t]);return this}e(t){return this.level<=E.ERROR&&(this.log+=`${t.errorCode}: ${t.errorMessage}`),this}writeLog(){this.log.length>0&&console.log(this.tag,this.log),this.log=[]}}const y=g,m=class{constructor(t,e,n){this.errorCode=t,this.errorMessage=e,null!=n&&(this.exceptionMessage=n)}},v=new class{constructor(){}showError(t,e,n){if(null!=t){const r=Object.values(t.ErrorCode).indexOf(e);return r>=0?new m(Object.keys(t.ErrorCode)[r],Object.keys(t.ErrorMessage)[r],n):new m(GENERAL_ERROR,"general error",n)}}},I={ErrorCode:{GENERAL_ERROR:600,API_SERVER_ERROR:500,API_PARAMETER_MISSING:400,API_APPKEY_NOT_VALID:401,API_FORBIDDEN_REQUEST:403,API_DEVICE_NOT_FOUND:404,API_TOPICS_ARE_INSERTED:409,BAD_REQUEST_SERVER_ERROR:410},ErrorMessage:{GENERAL_ERROR:"General Error",API_SERVER_ERROR:"Error server response",API_PARAMETER_MISSING:"Api parameter missing",API_APPKEY_NOT_VALID:"appKey is not valid",API_FORBIDDEN_REQUEST:"forbidden request",API_DEVICE_NOT_FOUND:"device not found",API_TOPICS_ARE_INSERTED:"topics are inserted",BAD_REQUEST_SERVER_ERROR:"bad request"}},_=class{constructor(){this.URL_BASE="",this.GET="GET",this.POST="POST",this.PUT="PUT",this.DELETE="DELETE"}async getURL(){return this.URL_BASE}async call(t,e,n,r){const i=new y("[IND]BaseClient: ");let o=await this.getURL()+n.getPath(e)+n.getParams();n.isJourneyRequest()&&(o=o.replace("v1","v2"));const s={method:t,headers:n.addHeaders()};t!==this.GET&&(s.body=JSON.stringify(n.getBody())),r&&(s.credentials=r);try{const e=await fetch(o,s),r=await e.json();return e.ok?(i.d("Method: "+t+"\nURL: "+o+"\n"+(t!==this.GET?"Request Body: "+JSON.stringify(n.getBody(),null,"\t")+"\n":"")+"Response Code: "+r.statusCode+"\nResponse Message: "+r.message+"\nResponse Body:",JSON.stringify(r.data,null,"\t")).writeLog(),r):(i.d("Method: "+t+"\nURL: "+o+"\n"+(t!==this.GET?"Request Body: "+JSON.stringify(n.getBody(),null,"\t")+"\n":"")+"Response Code: "+e.status+"\nResponse Message: "+e.statusText+"\n").writeLog(),new m(e.status,e.statusText))}catch(e){return i.d("Method: "+t+"\nURL: "+o+"\n"+(t!==this.GET?"Request Body: "+JSON.stringify(n.getBody(),null,"\t")+"\n":"")+"Error: "+e).writeLog(),v.showError(I,I.ErrorCode.GENERAL_ERROR,e)}}async get(t,e){return await this.call(this.GET,t,e)}async post(t,e,n){return await this.call(this.POST,t,e,n)}async put(t,e,n){return await this.call(this.PUT,t,e,n)}async delete(t,e){return await this.call(this.DELETE,t,e)}},O=class{constructor(){this.PARAM_APP_KEY="appKey",this.PARAM_DEVICE_ID="deviceId",this.PARAM_PUSH_TOKEN="pushToken",this.PARAM_ENABLED="enabled",this.PARAM_PLATFORM="platform",this.PARAM_VERSION="version",this.PARAM_TOPICS="topics",this.PARAM_EVENT_TYPE="eventType",this.PARAM_PUSH_ID="pushId",this.PARAM_CLICKED_BUTTON="clickedButton",this.PARAM_PERMISSION_TYPE="permissionType",this.PARAM_LATITUDE="latitude",this.PARAM_LONGITUDE="longitude",this.PARAM_INAPP_ID="inAppId",this.PARAM_INAPP_EVENT_TYPE="eventType",this.PARAM_INAPP_CLICKED_BUTTON="clickedButton",this.PARAM_INAPP_LAST_VERSION_ID="lastVersionId",this.PARAM_INBOX_EXTERNALID="externalId",this.PARAM_INBOX_PAGE="page",this.PARAM_INBOX_PAGE_SIZE="pageSize",this.PARAM_INBOX_DATE_FROM="dateFrom",this.PARAM_INBOX_DATE_TO="dateTo",this.PARAM_INBOX_STATUS="status",this.PARAM_INBOX_SENDER_IDS="sendingIds",this.PARAM_CUSTOMER_ID="customerId",this.PARAM_CUSTOMER_FIELD_NAMES="fieldNames",this.PARAM_CUSTOMER_FIELDS="fields",this.PARAM_CUSTOMER_LINK="link",this.PARAM_CUSTOMER_CHANNEL="channel",this.appKey=(new d).getAppKey(),this.params=null,this.pathParams={},this.headers={}}getParams(){return"?"+this.PARAM_APP_KEY+"="+this.appKey+(this.params?"&"+this.params:"")}getBody(){return this.body?this.body:""}getPath(t){let e=t;return Object.keys(this.pathParams).forEach((t=>{e=e.replace(t,this.pathParams[t])})),e}addHeaders(){const t=new Headers({"Content-Type":"application/json"});return Object.keys(this.headers).forEach((e=>{t.append(e,this.headers[e])})),t}isJourneyRequest(){return this.journeyRequest}setJourneyRequest(t){this.journeyRequest=t}},b=Object.freeze({PUSH:"push",INAPP:"inapp",CHAT:"chat"}),w=class{constructor(t=null,e){null==t?(this.browserPublicKey=(new d).getBrowserPublicKey(),this.browserPrivateKey=(new d).getBrowserPrivateKey(),this.platform=(new d).getPlatform(),this.version=(new d).getVersion(),this.browserName=(new d).getBrowserName(),this.browserVersion=(new d).getBrowserVersion(),this.osName=(new d).getOsName(),this.osVersion=(new d).getOsVersion(),this.deviceType=(new d).getDeviceType(),(new d).getEnabled()&&(this.enabled="true"===(new d).getEnabled()),(new d).getExternalId()&&(this.externalCode=(new d).getExternalId())):e?(t.enabled&&(this.enabled=t.enabled,(new d).setEnabled(this.enabled)),t.registeredByCookie&&(this.registeredByCookie=t.registeredByCookie,(new d).setRegisteredByCookie(this.registeredByCookie))):(t.browserPublicKey&&(this.browserPublicKey=t.browserPublicKey),t.browserPrivateKey&&(this.browserPrivateKey=t.browserPrivateKey),t.platform&&(this.platform=t.platform),t.version&&(this.version=t.version),t.osVersion&&(this.osVersion=t.osVersion),t.browserName&&(this.browserName=t.browserName),t.browserVersion&&(this.browserVersion=t.browserVersion),t.osName&&(this.osName=t.osName),t.deviceType&&(this.deviceType=t.deviceType),t.enabled&&(this.enabled=t.enabled),t.externalCode&&(this.externalCode=t.externalCode)),this.platform&&(this.productName=this.platform),this.version&&(this.productVersion=this.version),navigator&&"language"in navigator&&(this.locale=navigator.language),Intl&&"DateTimeFormat"in Intl&&(this.timeZone=Intl.DateTimeFormat().resolvedOptions().timeZone),this.timeOffset=-(new Date).getTimezoneOffset()}getDeviceId(){return this.deviceId}setDeviceId(t){this.deviceId=t}setExternalCode(t){this.externalCode=t}static setDeviceJson(t){(new d).setDeviceJson(JSON.stringify(t.toJSON()))}toJSON(){const t={};return this.platform&&(t.platform=this.platform),this.version&&(t.version=this.version),this.productName&&(t.productName=this.productName),this.productVersion&&(t.productVersion=this.productVersion),this.browserName&&(t.browserName=this.browserName),this.browserVersion&&(t.browserVersion=this.browserVersion),this.osName&&(t.osName=this.osName),this.osVersion&&(t.osVersion=this.osVersion),this.deviceType&&(t.deviceType=this.deviceType),this.locale&&(t.locale=this.locale),this.timeZone&&(t.timeZome=this.timeZone),this.timeOffset&&(t.timeOffset=this.timeOffset),this.enabled&&(t.enabled=this.enabled),this.browserPublicKey&&(t.browserPublicKey=this.browserPublicKey),this.browserPrivateKey&&(t.browserPrivateKey=this.browserPrivateKey),this.externalCode&&(t.externalCode=this.externalCode),t}},P=Object.freeze({DEFAULT:-1,ENABLE:1,DISABLE:0}),S=Object.freeze({EVENT_TYPE_CLICK:"click",EVENT_TYPE_RECEIVE:"receive",EVENT_TYPE_UPDATE:"update",EVENT_TYPE_ACCEPT:"accept",EVENT_TYPE_REJECT:"reject",EVENT_TYPE_ASK:"ask"}),R=class{static isServiceTimestampExceed(){return!(new d).getServiceTimestamp()||(new d).getServiceSyncTime()<=(Date.now()-(new d).getServiceTimestamp())/6e4}static isFunction(t){return!(!t||"function"!=typeof t)}},T=class{static async getPermissions(){const t=await this.getPermission("geolocation"),e={};return t&&(e.location=t.state),e}static async getPermission(t){try{if(navigator&&navigator.permissions&&navigator.permissions.query&&t)return await navigator.permissions.query({name:t,userVisibleOnly:!0})}catch(t){return null}return null}static async setPermissionsCallback(){await this.setCallback("geolocation",navigator.indigitallRequestLocationPermission)}static async setCallback(t,e){const n=await this.getPermission(t);if(n){let r=n.state;"onchange"in n&&(n.onchange=()=>{new y("[IND]CorePermissions: ").d(t+" permission state has changed from "+r+" to "+n.state).writeLog(),r=n.state,e&&e({name:t,state:n.state})})}}},A=new y("[IND]Crypto"),N=new TextEncoder("utf-8"),L="HMAC",C=class{static async createHmac(t,e){try{const n=window?.crypto?.subtle;if(!n)return;const r=await n.importKey("raw",N.encode(t),{name:L,hash:{name:"SHA-256"}},!1,["sign","verify"]),i=await n.sign(L,r,N.encode(e)),o=new Uint8Array(i),s=Array.prototype.map.call(o,(t=>("00"+t.toString(16)).slice(-2))).join("");return A.d("hmac: ",s).writeLog(),s}catch(t){return void A.e("error:",t).writeLog()}}},D=class{static compareJSON(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const r of n)if(t[r]!==e[r]){if("object"!=typeof t[r]||"object"!=typeof e[r])return!1;if(!isEqual(t[r],e[r]))return!1}return!0}},x=class{static isValidFormat(t){return null!=t&&""!=t&&"null"!=t&&t.length>8}},U={Repository:d,Config:a,Api:t,Models:e,Utils:i}})(),r})(),t.exports=e()},872:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}Object.defineProperty(e,"__esModule",{value:!0});var i={Core:!0};Object.defineProperty(e,"Core",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return o.default}});var o=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var n=u(e);if(n&&n.has(t))return n.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=t[s]}i.default=t,n&&n.set(t,i);return i}(n(153));Object.keys(o).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(i,t)||t in e&&e[t]===o[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return o[t]}}))}));var s,a=(s=n(106))&&s.__esModule?s:{default:s};function u(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(u=function(t){return t?n:e})(t)}},659:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n(545)),i=a(n(358)),o=a(n(568)),s=a(n(801));function a(t){return t&&t.__esModule?t:{default:t}}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(){c=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function h(t,e,n,i){var o=e&&e.prototype instanceof p?e:p,s=Object.create(o.prototype),a=new R(i||[]);return r(s,"_invoke",{value:b(t,n,a)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var d={};function p(){}function E(){}function g(){}var y={};l(y,o,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(T([])));v&&v!==e&&n.call(v,o)&&(y=v);var I=g.prototype=p.prototype=Object.create(y);function _(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function i(r,o,s,a){var c=f(t[r],t,o);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==u(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,s,a)}),(function(t){i("throw",t,s,a)})):e.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return i("throw",t,s,a)}))}a(c.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function b(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return A()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=w(s,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return E.prototype=g,r(I,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:E,configurable:!0}),E.displayName=l(g,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,a,"GeneratorFunction")),t.prototype=Object.create(I),t},t.awrap=function(t){return{__await:t}},_(O.prototype),l(O.prototype,s,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new O(h(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},_(I),l(I,a,"Generator"),l(I,o,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=T,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function l(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){l(o,r,i,s,a,"next",t)}function a(t){l(o,r,i,s,a,"throw",t)}s(void 0)}))}}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,o=void 0,o=function(t,e){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===u(o)?o:String(o)),r)}var i,o}var d=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.URL_BASE="",this.GET="GET",this.POST="POST",this.PUT="PUT",this.DELETE="DELETE"}var e,n,a,u,l,d,p,E,g;return e=t,n=[{key:"getURL",value:(g=h(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.URL_BASE);case 1:case"end":return t.stop()}}),t,this)}))),function(){return g.apply(this,arguments)})},{key:"call",value:(E=h(c().mark((function t(e,n,a,u){var l,h,f,d,p;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=new r.default("[IND]BaseClient: "),t.next=3,this.getURL();case 3:return t.t0=t.sent,t.t1=a.getPath(n),t.t2=t.t0+t.t1,t.t3=a.getParams(),h=t.t2+t.t3,a.isJourneyRequest()&&(h=h.replace("v1","v2")),f={method:e,headers:a.addHeaders()},e!==this.GET&&(f.body=JSON.stringify(a.getBody())),u&&(f.credentials=u),t.prev=12,t.next=15,fetch(h,f);case 15:return d=t.sent,t.next=18,d.json();case 18:if(p=t.sent,!d.ok){t.next=22;break}return l.d("Method: "+e+"\nURL: "+h+"\n"+"".concat(e!==this.GET?"Request Body: "+JSON.stringify(a.getBody(),null,"\t")+"\n":"")+"Response Code: "+p.statusCode+"\nResponse Message: "+p.message+"\nResponse Body:",JSON.stringify(p.data,null,"\t")).writeLog(),t.abrupt("return",p);case 22:return l.d("Method: "+e+"\nURL: "+h+"\n"+"".concat(e!==this.GET?"Request Body: "+JSON.stringify(a.getBody(),null,"\t")+"\n":"")+"Response Code: "+d.status+"\nResponse Message: "+d.statusText+"\n").writeLog(),t.abrupt("return",new i.default(d.status,d.statusText));case 26:return t.prev=26,t.t4=t.catch(12),l.d("Method: "+e+"\nURL: "+h+"\n"+"".concat(e!==this.GET?"Request Body: "+JSON.stringify(a.getBody(),null,"\t")+"\n":"")+"Error: "+t.t4).writeLog(),t.abrupt("return",o.default.showError(s.default,s.default.ErrorCode.GENERAL_ERROR,t.t4));case 30:case"end":return t.stop()}}),t,this,[[12,26]])}))),function(t,e,n,r){return E.apply(this,arguments)})},{key:"get",value:(p=h(c().mark((function t(e,n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(this.GET,e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return p.apply(this,arguments)})},{key:"post",value:(d=h(c().mark((function t(e,n,r){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(this.POST,e,n,r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return d.apply(this,arguments)})},{key:"put",value:(l=h(c().mark((function t(e,n,r){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(this.PUT,e,n,r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return l.apply(this,arguments)})},{key:"delete",value:(u=h(c().mark((function t(e,n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(this.DELETE,e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return u.apply(this,arguments)})}],n&&f(e.prototype,n),a&&f(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=d},580:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(640))&&r.__esModule?r:{default:r};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,s=void 0,s=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===o(s)?s:String(s)),r)}var i,s}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.PARAM_APP_KEY="appKey",this.PARAM_DEVICE_ID="deviceId",this.PARAM_PUSH_TOKEN="pushToken",this.PARAM_ENABLED="enabled",this.PARAM_PLATFORM="platform",this.PARAM_VERSION="version",this.PARAM_TOPICS="topics",this.PARAM_EVENT_TYPE="eventType",this.PARAM_PUSH_ID="pushId",this.PARAM_CLICKED_BUTTON="clickedButton",this.PARAM_PERMISSION_TYPE="permissionType",this.PARAM_LATITUDE="latitude",this.PARAM_LONGITUDE="longitude",this.PARAM_INAPP_ID="inAppId",this.PARAM_INAPP_EVENT_TYPE="eventType",this.PARAM_INAPP_CLICKED_BUTTON="clickedButton",this.PARAM_INAPP_LAST_VERSION_ID="lastVersionId",this.PARAM_INBOX_EXTERNALID="externalId",this.PARAM_INBOX_PAGE="page",this.PARAM_INBOX_PAGE_SIZE="pageSize",this.PARAM_INBOX_DATE_FROM="dateFrom",this.PARAM_INBOX_DATE_TO="dateTo",this.PARAM_INBOX_STATUS="status",this.PARAM_INBOX_SENDER_IDS="sendingIds",this.PARAM_CUSTOMER_ID="customerId",this.PARAM_CUSTOMER_FIELD_NAMES="fieldNames",this.PARAM_CUSTOMER_FIELDS="fields",this.PARAM_CUSTOMER_LINK="link",this.PARAM_CUSTOMER_CHANNEL="channel",this.appKey=(new i.default).getAppKey(),this.params=null,this.pathParams={},this.headers={}}var e,n,r;return e=t,(n=[{key:"getParams",value:function(){return"?"+this.PARAM_APP_KEY+"="+this.appKey+(this.params?"&"+this.params:"")}},{key:"getBody",value:function(){return this.body?this.body:""}},{key:"getPath",value:function(t){var e=this,n=t;return Object.keys(this.pathParams).forEach((function(t){n=n.replace(t,e.pathParams[t])})),n}},{key:"addHeaders",value:function(){var t=this,e=new Headers({"Content-Type":"application/json"});return Object.keys(this.headers).forEach((function(n){e.append(n,t.headers[n])})),e}},{key:"isJourneyRequest",value:function(){return this.journeyRequest}},{key:"setJourneyRequest",value:function(t){this.journeyRequest=t}}])&&s(e.prototype,n),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=a},744:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"BaseClient",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"BaseRequest",{enumerable:!0,get:function(){return i.default}});var r=o(n(659)),i=o(n(580));function o(t){return t&&t.__esModule?t:{default:t}}},802:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r={platform:"webpush",version:"0.0.1"},i=n(248);r.version=i.version;var o=r=Object.assign(r,{client:{URL_BASE:"https://".concat("","device-api.indigitall.com/v1"),URL_DEVICE_V2:"https://".concat("","device-api.indigitall.com/v2"),INAPP_URL_BASE:"https://".concat("","inapp-api.indigitall.com/v1"),INBOX_URL_BASE:"https://".concat("","inbox-api.indigitall.com/v1"),CUSTOMER_URL_BASE:"https://".concat("","device-api.indigitall.com/v2")}});e.default=o},106:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=h(n(802)),o=h(n(640)),s=l(n(744)),a=l(n(253)),u=l(n(550));function c(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(c=function(t){return t?n:e})(t)}function l(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var n=c(e);if(n&&n.has(t))return n.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=t[s]}return i.default=t,n&&n.set(t,i),i}function h(t){return t&&t.__esModule?t:{default:t}}var f={Repository:o.default,Config:i.default,Api:s,Models:a,Utils:u};e.default=f},901:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.Channel=void 0;var n=Object.freeze({PUSH:"push",INAPP:"inapp",CHAT:"chat"});e.Channel=n;var r=n;e.default=r},354:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(640))&&r.__esModule?r:{default:r};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,s=void 0,s=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===o(s)?s:String(s)),r)}var i,s}var u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;s(this,t),null==e?(this.browserPublicKey=(new i.default).getBrowserPublicKey(),this.browserPrivateKey=(new i.default).getBrowserPrivateKey(),this.platform=(new i.default).getPlatform(),this.version=(new i.default).getVersion(),this.browserName=(new i.default).getBrowserName(),this.browserVersion=(new i.default).getBrowserVersion(),this.osName=(new i.default).getOsName(),this.osVersion=(new i.default).getOsVersion(),this.deviceType=(new i.default).getDeviceType(),(new i.default).getEnabled()&&(this.enabled="true"===(new i.default).getEnabled()),(new i.default).getExternalId()&&(this.externalCode=(new i.default).getExternalId())):n?(e.enabled&&(this.enabled=e.enabled,(new i.default).setEnabled(this.enabled)),e.registeredByCookie&&(this.registeredByCookie=e.registeredByCookie,(new i.default).setRegisteredByCookie(this.registeredByCookie))):(e.browserPublicKey&&(this.browserPublicKey=e.browserPublicKey),e.browserPrivateKey&&(this.browserPrivateKey=e.browserPrivateKey),e.platform&&(this.platform=e.platform),e.version&&(this.version=e.version),e.osVersion&&(this.osVersion=e.osVersion),e.browserName&&(this.browserName=e.browserName),e.browserVersion&&(this.browserVersion=e.browserVersion),e.osName&&(this.osName=e.osName),e.deviceType&&(this.deviceType=e.deviceType),e.enabled&&(this.enabled=e.enabled),e.externalCode&&(this.externalCode=e.externalCode)),this.platform&&(this.productName=this.platform),this.version&&(this.productVersion=this.version),navigator&&"language"in navigator&&(this.locale=navigator.language),Intl&&"DateTimeFormat"in Intl&&(this.timeZone=Intl.DateTimeFormat().resolvedOptions().timeZone),this.timeOffset=-(new Date).getTimezoneOffset()}var e,n,r;return e=t,r=[{key:"setDeviceJson",value:function(t){(new i.default).setDeviceJson(JSON.stringify(t.toJSON()))}}],(n=[{key:"getDeviceId",value:function(){return this.deviceId}},{key:"setDeviceId",value:function(t){this.deviceId=t}},{key:"setExternalCode",value:function(t){this.externalCode=t}},{key:"toJSON",value:function(){var t={};return this.platform&&(t.platform=this.platform),this.version&&(t.version=this.version),this.productName&&(t.productName=this.productName),this.productVersion&&(t.productVersion=this.productVersion),this.browserName&&(t.browserName=this.browserName),this.browserVersion&&(t.browserVersion=this.browserVersion),this.osName&&(t.osName=this.osName),this.osVersion&&(t.osVersion=this.osVersion),this.deviceType&&(t.deviceType=this.deviceType),this.locale&&(t.locale=this.locale),this.timeZone&&(t.timeZome=this.timeZone),this.timeOffset&&(t.timeOffset=this.timeOffset),this.enabled&&(t.enabled=this.enabled),this.browserPublicKey&&(t.browserPublicKey=this.browserPublicKey),this.browserPrivateKey&&(t.browserPrivateKey=this.browserPrivateKey),this.externalCode&&(t.externalCode=this.externalCode),t}}])&&a(e.prototype,n),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=u},202:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=Object.freeze({DEFAULT:-1,ENABLE:1,DISABLE:0});e.default=n},801:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={GENERAL_ERROR:600,API_SERVER_ERROR:500,API_PARAMETER_MISSING:400,API_APPKEY_NOT_VALID:401,API_FORBIDDEN_REQUEST:403,API_DEVICE_NOT_FOUND:404,API_TOPICS_ARE_INSERTED:409,BAD_REQUEST_SERVER_ERROR:410};var r={ErrorCode:n,ErrorMessage:{GENERAL_ERROR:"General Error",API_SERVER_ERROR:"Error server response",API_PARAMETER_MISSING:"Api parameter missing",API_APPKEY_NOT_VALID:"appKey is not valid",API_FORBIDDEN_REQUEST:"forbidden request",API_DEVICE_NOT_FOUND:"device not found",API_TOPICS_ARE_INSERTED:"topics are inserted",BAD_REQUEST_SERVER_ERROR:"bad request"}};e.default=r},358:(t,e)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=i.key,s=void 0,s=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===n(s)?s:String(s)),i)}var o,s}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i((function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.errorCode=e,this.errorMessage=n,null!=r&&(this.exceptionMessage=r)}));e.default=o},22:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=Object.freeze({EVENT_TYPE_CLICK:"click",EVENT_TYPE_RECEIVE:"receive",EVENT_TYPE_UPDATE:"update",EVENT_TYPE_ACCEPT:"accept",EVENT_TYPE_REJECT:"reject",EVENT_TYPE_ASK:"ask"});e.default=n},253:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"Channel",{enumerable:!0,get:function(){return r.Channel}}),Object.defineProperty(e,"Device",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"DeviceStatus",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"ErrorDictionary",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"ErrorModel",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"EventType",{enumerable:!0,get:function(){return u.default}});var r=n(901),i=c(n(354)),o=c(n(202)),s=c(n(801)),a=c(n(358)),u=c(n(22));function c(t){return t&&t.__esModule?t:{default:t}}},104:(t,e)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(){r=function(){return t};var t={},e=Object.prototype,i=e.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var i=e&&e.prototype instanceof p?e:p,s=Object.create(i.prototype),a=new R(r||[]);return o(s,"_invoke",{value:b(t,n,a)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var d={};function p(){}function E(){}function g(){}var y={};l(y,a,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(T([])));v&&v!==e&&i.call(v,a)&&(y=v);var I=g.prototype=p.prototype=Object.create(y);function _(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,s,a,u){var c=f(t[o],t,s);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==n(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var s;o(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return s=s?s.then(i,i):i()}})}function b(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return A()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=w(s,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(i.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:A}}function A(){return{value:void 0,done:!0}}return E.prototype=g,o(I,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:E,configurable:!0}),E.displayName=l(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,c,"GeneratorFunction")),t.prototype=Object.create(I),t},t.awrap=function(t){return{__await:t}},_(O.prototype),l(O.prototype,u,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new O(h(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},_(I),l(I,c,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=T,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function i(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var s=t.apply(e,n);function a(t){i(s,r,o,a,u,"next",t)}function u(t){i(s,r,o,a,u,"throw",t)}a(void 0)}))}}function s(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=i.key,s=void 0,s=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===n(s)?s:String(s)),i)}var o,s}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.TAG="[IND]IndexedDB: ",this.DB_NAME="indigitall.indexedDB",this.DB_VERSION=1,this.DB_STORE_NAME="indigitallStore",this.DB_STORE_MODE="readwrite",this.DB_KEY_PATH="id",this.DB_STORE_INDEX="storeIndex",this.IDB=indexedDB||mozzIndexedDB||webkitIndexedDB||msIndexedDB}var e,n,i,a,u,c,l,h;return e=t,n=[{key:"getDB",value:(h=o(r().mark((function t(){var e=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=e.IDB;if(r){var i=r.open("indigitall.indexedDB",1);i.onupgradeneeded=function(){i.result.createObjectStore("indigitallStore").createIndex("storeIndex","store.key")},i.onsuccess=function(){var e=i.result,n=e.transaction("indigitallStore","readwrite"),r=n.objectStore("indigitallStore"),o=r.index("storeIndex");t({db:e,tx:n,store:r,index:o})},i.onerror=function(t){n(t)}}else n(!1)})));case 1:case"end":return t.stop()}}),t)}))),function(){return h.apply(this,arguments)})},{key:"get",value:(l=o(r().mark((function t(e,n){var i=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){e||r(!1),e.index.get(n).onsuccess=function(n){n.target.result&&(i.close(e),t(n.target.result.store.value)),r(!1)}})));case 1:case"end":return t.stop()}}),t)}))),function(t,e){return l.apply(this,arguments)})},{key:"put",value:(c=o(r().mark((function t(e,n,i){var o=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){e||r(!1),e.store.put({store:{key:n,value:i}},n).onsuccess=function(n){o.close(e),t(i)}})));case 1:case"end":return t.stop()}}),t)}))),function(t,e,n){return c.apply(this,arguments)})},{key:"close",value:function(t){if(t.tx)try{t.tx.oncomplete=function(){t.db.close()}}catch(t){console.error(this.TAG,t)}}},{key:"setItem",value:(u=o(r().mark((function t(e,n){var i;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getDB();case 3:return i=t.sent,t.abrupt("return",this.put(i,e,n));case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t,e){return u.apply(this,arguments)})},{key:"getItem",value:(a=o(r().mark((function t(e){var n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getDB();case 3:return n=t.sent,t.abrupt("return",this.get(n,e));case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return a.apply(this,arguments)})}],n&&s(e.prototype,n),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}());e.default=a},795:(t,e)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=i.key,s=void 0,s=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===n(s)?s:String(s)),i)}var o,s}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.storage=this.isLocalStorageAvailable()?window.localStorage:null}var e,n,o;return e=t,(n=[{key:"isLocalStorageAvailable",value:function(){try{var t=window.localStorage,e="__storage_test__";if(t)return t.setItem(e,e),t.removeItem(e),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==i.length}return!1}},{key:"setItem",value:function(t,e){return null!=this.storage&&(this.storage.setItem(t,e),!0)}},{key:"getItem",value:function(t){return null!=this.storage?this.storage.getItem(t):null}},{key:"deleteItem",value:function(t){return!!this.storage&&(this.storage.setItem(t,value),!0)}},{key:"clear",value:function(){this.storage&&this.storage.clear()}}])&&r(e.prototype,n),o&&r(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}()),o=i;e.default=o},640:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n(802)),i=a(n(795)),o=a(n(104)),s=a(n(636));function a(t){return t&&t.__esModule?t:{default:t}}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(){c=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function h(t,e,n,i){var o=e&&e.prototype instanceof p?e:p,s=Object.create(o.prototype),a=new R(i||[]);return r(s,"_invoke",{value:b(t,n,a)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var d={};function p(){}function E(){}function g(){}var y={};l(y,o,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(T([])));v&&v!==e&&n.call(v,o)&&(y=v);var I=g.prototype=p.prototype=Object.create(y);function _(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function i(r,o,s,a){var c=f(t[r],t,o);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==u(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,s,a)}),(function(t){i("throw",t,s,a)})):e.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return i("throw",t,s,a)}))}a(c.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function b(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return A()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=w(s,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return E.prototype=g,r(I,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:E,configurable:!0}),E.displayName=l(g,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,a,"GeneratorFunction")),t.prototype=Object.create(I),t},t.awrap=function(t){return{__await:t}},_(O.prototype),l(O.prototype,s,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new O(h(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},_(I),l(I,a,"Generator"),l(I,o,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=T,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function l(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){l(o,r,i,s,a,"next",t)}function a(t){l(o,r,i,s,a,"throw",t)}s(void 0)}))}}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,o=void 0,o=function(t,e){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===u(o)?o:String(o)),r)}var i,o}var d=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.storage=i.default,this.db=o.default,this.BASE_TIME=60,this.REPOSITORY="indigitall.repository",this.APP_KEY=this.REPOSITORY+".APP_KEY",this.VAPID_PUBLIC=this.REPOSITORY+".VAPID_PUBLIC",this.ENABLED=this.REPOSITORY+".ENABLED",this.DEVICE_ID=this.REPOSITORY+".DEVICE_ID",this.SERVICE_SYNC_TIME=this.REPOSITORY+".SERVICE_SYNC_TIME",this.LOCATION_ENABLED=this.REPOSITORY+".LOCATION_ENABLED",this.LOCATION_UPDATE_MINUTES=this.REPOSITORY+".LOCATION_UPDATE_MINUTES",this.REQUEST_LOCATION=this.REPOSITORY+".REQUEST_LOCATION",this.BROWSER_PUBLIC_KEY=this.REPOSITORY+".BROWSER_PUBLIC_KEY",this.BROWSER_PRIVATE_KEY=this.REPOSITORY+".BROWSER_PRIVATE_KEY",this.PLATFORM=this.REPOSITORY+".PLATFORM",this.BROWSER_NAME=this.REPOSITORY+".BROWSER_NAME",this.BROWSER_VERSION=this.REPOSITORY+".BROWSER_VERSION",this.OS_NAME=this.REPOSITORY+".OS_NAME",this.OS_VERSION=this.REPOSITORY+".OS_VERSION",this.DEVICE_TYPE=this.REPOSITORY+".DEVICE_TYPE",this.SUPPORTED=this.REPOSITORY+".SUPPORTED",this.SERVICE_TIMESTAMP=this.REPOSITORY+".SERVICE_TIMESTAMP",this.LOCATION_TIMESTAMP=this.REPOSITORY+".LOCATION_TIMESTAMP",this.PERMISSION_LOCATION=this.REPOSITORY+".PERMISSION_LOCATION",this.SET_LOG_DEBUG=this.REPOSITORY+".SET_LOG_DEBUG",this.NEW_USER_TIMESTAMP=this.REPOSITORY+".NEW_USER_TIMESTAMP",this.EXTERNAL_ID=this.REPOSITORY+".EXTERNAL_ID",this.REGISTERED_BY_COOKIE=this.REPOSITORY+".REGISTERED_BY_COOKIE",this.LOG_LEVEL=this.REPOSITORY+".LOG_LEVEL",this.LATITUDE=this.REPOSITORY+".LATITUDE",this.LONGITUDE=this.REPOSITORY+".LONGITUDE"}var e,n,a,u,l,d,p,E,g,y,m,v,I,_;return e=t,n=[{key:"setItemSessionStorage",value:function(t,e){s.default.setItem(t,e)}},{key:"getItemSessionStorage",value:function(t){return s.default.getItem(t)}},{key:"clearSessionStorage",value:function(){s.default.clearMessages()}},{key:"setStorage",value:function(t,e){i.default.setItem(t,e)}},{key:"getStorage",value:function(t){return i.default.getItem(t)}},{key:"clearStorage",value:function(){i.default.clear()}},{key:"setBrowserPublicKey",value:function(t){i.default.setItem(this.BROWSER_PUBLIC_KEY,t)}},{key:"getBrowserPublicKey",value:function(){return i.default.getItem(this.BROWSER_PUBLIC_KEY)}},{key:"setBrowserPrivateKey",value:function(t){i.default.setItem(this.BROWSER_PRIVATE_KEY,t)}},{key:"getBrowserPrivateKey",value:function(){return i.default.getItem(this.BROWSER_PRIVATE_KEY)}},{key:"setAppKey",value:(_=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.APP_KEY,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return _.apply(this,arguments)})},{key:"getAppKey",value:function(){return i.default.getItem(this.APP_KEY)}},{key:"setVAPID",value:function(t){i.default.setItem(this.VAPID_PUBLIC,t)}},{key:"getVAPID",value:function(){return i.default.getItem(this.VAPID_PUBLIC)}},{key:"setEnabled",value:function(t){i.default.setItem(this.ENABLED,t)}},{key:"getEnabled",value:function(){return i.default.getItem(this.ENABLED)}},{key:"setServiceSyncTime",value:function(t){i.default.setItem(this.SERVICE_SYNC_TIME,t*this.BASE_TIME)}},{key:"getServiceSyncTime",value:function(){var t=i.default.getItem(this.SERVICE_SYNC_TIME);return t||1*this.BASE_TIME}},{key:"setLocationEnabled",value:function(t){i.default.setItem(this.LOCATION_ENABLED,t)}},{key:"getLocationEnabled",value:function(){return i.default.getItem(this.LOCATION_ENABLED)}},{key:"setLocationUpdateMinutes",value:function(t){i.default.setItem(this.LOCATION_UPDATE_MINUTES,t)}},{key:"getLocationUpdateMinutes",value:function(){var t=i.default.getItem(this.LOCATION_UPDATE_MINUTES);return t||30}},{key:"setRequestLocation",value:(I=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.REQUEST_LOCATION,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return I.apply(this,arguments)})},{key:"getRequestLocation",value:function(){return!!i.default&&i.default.getItem(this.REQUEST_LOCATION)}},{key:"setPlatform",value:(v=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.PLATFORM,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return v.apply(this,arguments)})},{key:"getPlatform",value:function(){return i.default&&i.default.getItem(this.PLATFORM)||r.default.platform}},{key:"getVersion",value:function(){return r.default.version}},{key:"setBrowserName",value:(m=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.BROWSER_NAME,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return m.apply(this,arguments)})},{key:"getBrowserName",value:function(){return i.default.getItem(this.BROWSER_NAME)}},{key:"setBrowserVersion",value:function(t){i.default.setItem(this.BROWSER_VERSION,t)}},{key:"getBrowserVersion",value:function(){return i.default.getItem(this.BROWSER_VERSION)}},{key:"setOsName",value:(y=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.OS_NAME,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return y.apply(this,arguments)})},{key:"getOsName",value:function(){return i.default.getItem(this.OS_NAME)}},{key:"setOsVersion",value:function(t){i.default.setItem(this.OS_VERSION,t)}},{key:"getOsVersion",value:function(){return i.default.getItem(this.OS_VERSION)}},{key:"setDeviceType",value:function(t){i.default.setItem(this.DEVICE_TYPE,t)}},{key:"getDeviceType",value:function(){return i.default.getItem(this.DEVICE_TYPE)}},{key:"setSupported",value:function(t){i.default.setItem(this.SUPPORTED,t)}},{key:"getSupported",value:function(){return i.default.getItem(this.SUPPORTED)}},{key:"setServiceTimestamp",value:function(t){i.default.setItem(this.SERVICE_TIMESTAMP,t)}},{key:"getServiceTimestamp",value:function(){return i.default.getItem(this.SERVICE_TIMESTAMP)}},{key:"setLocationTimestamp",value:function(t){i.default.setItem(this.LOCATION_TIMESTAMP,t)}},{key:"getLocationTimestamp",value:function(){return i.default.getItem(this.LOCATION_TIMESTAMP)}},{key:"setPermissionLocation",value:function(t){i.default.setItem(this.PERMISSION_LOCATION,t)}},{key:"getPermissionLocation",value:function(){return i.default.getItem(this.PERMISSION_LOCATION)}},{key:"setDebugLog",value:function(t){i.default.setItem(this.SET_LOG_DEBUG,t)}},{key:"getDebugLog",value:function(){return"false"!==i.default.getItem(this.SET_LOG_DEBUG)}},{key:"setLogLevel",value:function(t){i.default.setItem(this.LOG_LEVEL,t)}},{key:"getLogLevel",value:function(){return i.default.getItem(this.LOG_LEVEL)}},{key:"setNewUserTimestamp",value:function(t){i.default.setItem(this.NEW_USER_TIMESTAMP,t)}},{key:"getNewUserTimestamp",value:function(){return i.default.getItem(this.NEW_USER_TIMESTAMP)}},{key:"setExternalIdRequest",value:(g=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i.default&&i.default.isLocalStorageAvailable()&&i.default.setItem(this.EXTERNAL_ID,e),!o.default||!o.default.IDB){t.next=4;break}return t.next=4,o.default.setItem(this.EXTERNAL_ID,e);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return g.apply(this,arguments)})},{key:"getExternalIdRequest",value:(E=h(c().mark((function t(){var e;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!i.default||!i.default.isLocalStorageAvailable()){t.next=5;break}e=i.default.getItem(this.EXTERNAL_ID),t.next=9;break;case 5:if(!o.default||!o.default.IDB){t.next=9;break}return t.next=8,o.default.getItem(this.EXTERNAL_ID);case 8:e=t.sent;case 9:t.next=13;break;case 11:t.prev=11,t.t0=t.catch(0);case 13:return t.abrupt("return",e);case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return E.apply(this,arguments)})},{key:"setExternalId",value:function(t){i.default.setItem(this.EXTERNAL_ID,t)}},{key:"getExternalId",value:function(){return i.default.getItem(this.EXTERNAL_ID)}},{key:"getDeviceJson",value:(p=h(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.default.getItem(this.DEVICE_JSON));case 1:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})},{key:"setDeviceJson",value:(d=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.DEVICE_JSON,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return d.apply(this,arguments)})},{key:"getRegisteredByCookie",value:(l=h(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.default.getItem(this.REGISTERED_BY_COOKIE));case 1:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"setRegisteredByCookie",value:(u=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.REGISTERED_BY_COOKIE,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"setLatitude",value:function(t){i.default.setItem(this.LATITUDE,t)}},{key:"getLatitude",value:function(){return i.default.getItem(this.LATITUDE)}},{key:"setLongitude",value:function(t){i.default.setItem(this.LONGITUDE,t)}},{key:"getLongitude",value:function(){return i.default.getItem(this.LONGITUDE)}}],n&&f(e.prototype,n),a&&f(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=d},636:(t,e)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=i.key,s=void 0,s=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===n(s)?s:String(s)),i)}var o,s}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.SESSION="indigitall.session.storage",this.session=this.isSessionStorageAvailable()?window.sessionStorage:null}var e,n,o;return e=t,(n=[{key:"isSessionStorageAvailable",value:function(){try{var t=window.sessionStorage,e="__storage_test__";if(t)return t.setItem(e,e),t.removeItem(e),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==i.length}return!1}},{key:"getItem",value:function(t){return null!=this.session?this.session.getItem(t):null}},{key:"setItem",value:function(t,e){return null!=this.session&&(this.session.setItem(t,e),!0)}},{key:"clearMessages",value:function(){this.session&&this.session.removeItem("messages")}}])&&r(e.prototype,n),o&&r(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}()),o=i;e.default=o},306:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(640))&&r.__esModule?r:{default:r};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,s=void 0,s=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===o(s)?s:String(s)),r)}var i,s}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"isServiceTimestampExceed",value:function(){return!(new i.default).getServiceTimestamp()||(new i.default).getServiceSyncTime()<=(Date.now()-(new i.default).getServiceTimestamp())/6e4}},{key:"isFunction",value:function(t){return!(!t||"function"!=typeof t)}}],(n=null)&&s(e.prototype,n),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=a},897:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(545))&&r.__esModule?r:{default:r};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(){s=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function h(t,e,n,i){var o=e&&e.prototype instanceof p?e:p,s=Object.create(o.prototype),a=new R(i||[]);return r(s,"_invoke",{value:b(t,n,a)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var d={};function p(){}function E(){}function g(){}var y={};l(y,a,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(T([])));v&&v!==e&&n.call(v,a)&&(y=v);var I=g.prototype=p.prototype=Object.create(y);function _(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function i(r,s,a,u){var c=f(t[r],t,s);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==o(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,a,u)}),(function(t){i("throw",t,a,u)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return i("throw",t,a,u)}))}u(c.arg)}var s;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return s=s?s.then(r,r):r()}})}function b(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return A()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=w(s,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return E.prototype=g,r(I,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:E,configurable:!0}),E.displayName=l(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,c,"GeneratorFunction")),t.prototype=Object.create(I),t},t.awrap=function(t){return{__await:t}},_(O.prototype),l(O.prototype,u,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new O(h(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},_(I),l(I,c,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=T,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function a(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){a(o,r,i,s,u,"next",t)}function u(t){a(o,r,i,s,u,"throw",t)}s(void 0)}))}}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,s=void 0,s=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===o(s)?s:String(s)),r)}var i,s}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r,o,a,l,h;return e=t,n=null,r=[{key:"getPermissions",value:(h=u(s().mark((function t(){var e,n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getPermission("geolocation");case 2:return e=t.sent,n={},e&&(n.location=e.state),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"getPermission",value:(l=u(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(navigator&&navigator.permissions&&navigator.permissions.query&&e)){t.next=5;break}return t.next=4,navigator.permissions.query({name:e,userVisibleOnly:!0});case 4:return t.abrupt("return",t.sent);case 5:t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",null);case 10:return t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(t){return l.apply(this,arguments)})},{key:"setPermissionsCallback",value:(a=u(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.setCallback("geolocation",navigator.indigitallRequestLocationPermission);case 2:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"setCallback",value:(o=u(s().mark((function t(e,n){var r,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getPermission(e);case 2:(r=t.sent)&&(o=r.state,"onchange"in r&&(r.onchange=function(){new i.default("[IND]CorePermissions: ").d(e+" permission state has changed from "+o+" to "+r.state).writeLog(),o=r.state,n&&n({name:e,state:r.state})}));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})}],n&&c(e.prototype,n),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=l},95:(t,e,n)=>{"use strict";var r;function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(){o=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function h(t,e,n,i){var o=e&&e.prototype instanceof p?e:p,s=Object.create(o.prototype),a=new R(i||[]);return r(s,"_invoke",{value:b(t,n,a)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var d={};function p(){}function E(){}function g(){}var y={};l(y,a,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(T([])));v&&v!==e&&n.call(v,a)&&(y=v);var I=g.prototype=p.prototype=Object.create(y);function _(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function o(r,s,a,u){var c=f(t[r],t,s);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==i(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var s;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return s=s?s.then(r,r):r()}})}function b(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return A()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=w(s,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return E.prototype=g,r(I,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:E,configurable:!0}),E.displayName=l(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,c,"GeneratorFunction")),t.prototype=Object.create(I),t},t.awrap=function(t){return{__await:t}},_(O.prototype),l(O.prototype,u,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new O(h(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},_(I),l(I,c,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=T,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function s(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=r.key,s=void 0,s=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===i(s)?s:String(s)),r)}var o,s}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.CryptoUtils=void 0;var u=new(((r=n(545))&&r.__esModule?r:{default:r}).default)("[IND]Crypto"),c=new TextEncoder("utf-8"),l="HMAC",h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r,i,h;return e=t,n=null,r=[{key:"createHmac",value:(i=o().mark((function t(e,n){var r,i,s,a,h,f,d;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,s=null===(r=window)||void 0===r||null===(i=r.crypto)||void 0===i?void 0:i.subtle){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,s.importKey("raw",c.encode(e),{name:l,hash:{name:"SHA-256"}},!1,["sign","verify"]);case 6:return a=t.sent,t.next=9,s.sign(l,a,c.encode(n));case 9:return h=t.sent,f=new Uint8Array(h),d=Array.prototype.map.call(f,(function(t){return("00"+t.toString(16)).slice(-2)})).join(""),u.d("hmac: ",d).writeLog(),t.abrupt("return",d);case 16:return t.prev=16,t.t0=t.catch(0),u.e("error:",t.t0).writeLog(),t.abrupt("return");case 20:case"end":return t.stop()}}),t,null,[[0,16]])})),h=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function a(t){s(o,n,r,a,u,"next",t)}function u(t){s(o,n,r,a,u,"throw",t)}a(void 0)}))},function(t,e){return h.apply(this,arguments)})}],n&&a(e.prototype,n),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.CryptoUtils=h;var f=h;e.default=f},568:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(358))&&r.__esModule?r:{default:r};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,s=void 0,s=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===o(s)?s:String(s)),r)}var i,s}var a=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"showError",value:function(t,e,n){if(null!=t){var r=Object.values(t.ErrorCode).indexOf(e);return r>=0?new i.default(Object.keys(t.ErrorCode)[r],Object.keys(t.ErrorMessage)[r],n):new i.default(GENERAL_ERROR,"general error",n)}}}])&&s(e.prototype,n),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}());e.default=a},970:(t,e)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=i.key,s=void 0,s=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===n(s)?s:String(s)),i)}var o,s}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,o;return e=t,o=[{key:"compareJSON",value:function(t,e){var r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(var o=0,s=r;o<s.length;o++){var a=s[o];if(t[a]!==e[a]){if("object"!=n(t[a])||"object"!=n(e[a]))return!1;if(!isEqual(t[a],e[a]))return!1}}return!0}}],(i=null)&&r(e.prototype,i),o&&r(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=i},545:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(n(640)),i=o(n(136));function o(t){return t&&t.__esModule?t:{default:t}}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,o=void 0,o=function(t,e){if("object"!==s(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===s(o)?o:String(o)),r)}var i,o}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tag="[IND]",e&&(this.tag=e),this.level=i.default.INFO,this.setLogLevel((new r.default).getLogLevel()),this.log=[]}var e,n,o;return e=t,n=[{key:"setLogLevel",value:function(t){t&&t>=i.default.DEBUG&&t<=i.default.ERROR&&(this.level=t)}},{key:"d",value:function(){if(this.level<=i.default.DEBUG)for(var e=0;e<arguments.length;e++)this.log+=t.addedAsString(arguments[e]);return this}},{key:"i",value:function(){if(this.level<=i.default.INFO)for(var e=0;e<arguments.length;e++)this.log+=t.addedAsString(arguments[e]);return this}},{key:"w",value:function(){if(this.level<=i.default.WARNING)for(var e=0;e<arguments.length;e++)this.log+=t.addedAsString(arguments[e]);return this}},{key:"e",value:function(t){return this.level<=i.default.ERROR&&(this.log+="".concat(t.errorCode,": ").concat(t.errorMessage)),this}},{key:"writeLog",value:function(){this.log.length>0&&console.log(this.tag,this.log),this.log=[]}}],o=[{key:"addedAsString",value:function(t){return"string"==typeof t?t:JSON.stringify(t,null,2)}}],n&&a(e.prototype,n),o&&a(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=u},136:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.LogLevel=void 0;var n=Object.freeze({DEBUG:1,INFO:2,WARNING:3,ERROR:4});e.LogLevel=n;var r=n;e.default=r},506:(t,e)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=i.key,s=void 0,s=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===n(s)?s:String(s)),i)}var o,s}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"isValidFormat",value:function(t){return null!=t&&""!=t&&"null"!=t&&t.length>8}}],(n=null)&&r(e.prototype,n),i&&r(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=i},550:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"CommonUtils",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"CorePermissions",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"CryptoUtils",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"ErrorUtils",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"JsonUtils",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"Log",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return c.LogLevel}}),Object.defineProperty(e,"Validations",{enumerable:!0,get:function(){return l.default}});var r=h(n(306)),i=h(n(897)),o=h(n(95)),s=h(n(568)),a=h(n(970)),u=h(n(545)),c=n(136),l=h(n(506));function h(t){return t&&t.__esModule?t:{default:t}}},899:function(t){var e;e=()=>(()=>{var t={153:function(t){var e;e=()=>(()=>{"use strict";var t={147:t=>{t.exports=JSON.parse('{"name":"indigitall-web-core","description":"indigitall web core","version":"4.1.1","main":"index.js","author":"Smart2me S.L.","homepage":"https://indigitall.com","devDependencies":{"@babel/preset-env":"^7.18.10","babel-loader":"^8.2.5","filemanager-webpack-plugin":"^7.0.0","idempotent-babel-polyfill":"^7.4.4","script-loader":"^0.7.2","webpack":"^5.74.0","webpack-bundle-analyzer":"^4.6.1","webpack-cli":"^4.10.0"},"scripts":{"test":"echo \'There are not tests\'","public":"ws --directory ./public --port 80 --log.format dev","build":"webpack --config webpack.config.js --mode=production","build-dev":"webpack --config webpack.config.js --watch --mode=development","delete-node-modules":"rm -rf node_modules/ && rm -f package-lock.json","install-core":"npm install && npm run build"}}')}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return(()=>{n.r(r),n.d(r,{default:()=>U});var t={};n.r(t),n.d(t,{BaseClient:()=>_,BaseRequest:()=>O});var e={};n.r(e),n.d(e,{Channel:()=>b,Device:()=>w,DeviceStatus:()=>P,ErrorDictionary:()=>I,ErrorModel:()=>m,EventType:()=>S});var i={};n.r(i),n.d(i,{CommonUtils:()=>R,CorePermissions:()=>T,CryptoUtils:()=>C,ErrorUtils:()=>v,JsonUtils:()=>D,Log:()=>y,LogLevel:()=>p,Validations:()=>x});var o={platform:"webpush",version:"0.0.1"};const s=n(147);o.version=s.version;const a=o=Object.assign(o,{client:{URL_BASE:"https://device-api.indigitall.com/v1",URL_DEVICE_V2:"https://device-api.indigitall.com/v2",INAPP_URL_BASE:"https://inapp-api.indigitall.com/v1",INBOX_URL_BASE:"https://inbox-api.indigitall.com/v1",CUSTOMER_URL_BASE:"https://device-api.indigitall.com/v2"}}),u=new class{constructor(){this.storage=this.isLocalStorageAvailable()?window.localStorage:null}isLocalStorageAvailable(){try{const t=window.localStorage,e="__storage_test__";if(t)return t.setItem(e,e),t.removeItem(e),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==u.length}return!1}setItem(t,e){return null!=this.storage&&(this.storage.setItem(t,e),!0)}getItem(t){return null!=this.storage?this.storage.getItem(t):null}deleteItem(t){return!!this.storage&&(this.storage.setItem(t,value),!0)}clear(){this.storage&&this.storage.clear()}},c=u,l=new class{constructor(){this.TAG="[IND]IndexedDB: ",this.DB_NAME="indigitall.indexedDB",this.DB_VERSION=1,this.DB_STORE_NAME="indigitallStore",this.DB_STORE_MODE="readwrite",this.DB_KEY_PATH="id",this.DB_STORE_INDEX="storeIndex",this.IDB=indexedDB||mozzIndexedDB||webkitIndexedDB||msIndexedDB}async getDB(){return new Promise(((t,e)=>{const n=this.IDB;if(n){const r=n.open("indigitall.indexedDB",1);r.onupgradeneeded=function(){r.result.createObjectStore("indigitallStore").createIndex("storeIndex","store.key")},r.onsuccess=function(){const e=r.result,n=e.transaction("indigitallStore","readwrite"),i=n.objectStore("indigitallStore"),o=i.index("storeIndex");t({db:e,tx:n,store:i,index:o})},r.onerror=function(t){e(t)}}else e(!1)}))}async get(t,e){return new Promise(((n,r)=>{t||r(!1),t.index.get(e).onsuccess=e=>{e.target.result&&(this.close(t),n(e.target.result.store.value)),r(!1)}}))}async put(t,e,n){return new Promise(((r,i)=>{t||i(!1),t.store.put({store:{key:e,value:n}},e).onsuccess=e=>{this.close(t),r(n)}}))}close(t){if(t.tx)try{t.tx.oncomplete=()=>{t.db.close()}}catch(t){console.error(this.TAG,t)}}async setItem(t,e){try{const n=await this.getDB();return this.put(n,t,e)}catch(t){return t}}async getItem(t){try{const e=await this.getDB();return this.get(e,t)}catch(t){return t}}},h=new class{constructor(){this.SESSION="indigitall.session.storage",this.session=this.isSessionStorageAvailable()?window.sessionStorage:null}isSessionStorageAvailable(){try{const t=window.sessionStorage,e="__storage_test__";if(t)return t.setItem(e,e),t.removeItem(e),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==h.length}return!1}getItem(t){return null!=this.session?this.session.getItem(t):null}setItem(t,e){return null!=this.session&&(this.session.setItem(t,e),!0)}clearMessages(){this.session&&this.session.removeItem("messages")}},f=h,d=class{constructor(){this.storage=c,this.db=l,this.BASE_TIME=60,this.REPOSITORY="indigitall.repository",this.APP_KEY=this.REPOSITORY+".APP_KEY",this.VAPID_PUBLIC=this.REPOSITORY+".VAPID_PUBLIC",this.ENABLED=this.REPOSITORY+".ENABLED",this.DEVICE_ID=this.REPOSITORY+".DEVICE_ID",this.SERVICE_SYNC_TIME=this.REPOSITORY+".SERVICE_SYNC_TIME",this.LOCATION_ENABLED=this.REPOSITORY+".LOCATION_ENABLED",this.LOCATION_UPDATE_MINUTES=this.REPOSITORY+".LOCATION_UPDATE_MINUTES",this.REQUEST_LOCATION=this.REPOSITORY+".REQUEST_LOCATION",this.BROWSER_PUBLIC_KEY=this.REPOSITORY+".BROWSER_PUBLIC_KEY",this.BROWSER_PRIVATE_KEY=this.REPOSITORY+".BROWSER_PRIVATE_KEY",this.PLATFORM=this.REPOSITORY+".PLATFORM",this.BROWSER_NAME=this.REPOSITORY+".BROWSER_NAME",this.BROWSER_VERSION=this.REPOSITORY+".BROWSER_VERSION",this.OS_NAME=this.REPOSITORY+".OS_NAME",this.OS_VERSION=this.REPOSITORY+".OS_VERSION",this.DEVICE_TYPE=this.REPOSITORY+".DEVICE_TYPE",this.SUPPORTED=this.REPOSITORY+".SUPPORTED",this.SERVICE_TIMESTAMP=this.REPOSITORY+".SERVICE_TIMESTAMP",this.LOCATION_TIMESTAMP=this.REPOSITORY+".LOCATION_TIMESTAMP",this.PERMISSION_LOCATION=this.REPOSITORY+".PERMISSION_LOCATION",this.SET_LOG_DEBUG=this.REPOSITORY+".SET_LOG_DEBUG",this.NEW_USER_TIMESTAMP=this.REPOSITORY+".NEW_USER_TIMESTAMP",this.EXTERNAL_ID=this.REPOSITORY+".EXTERNAL_ID",this.REGISTERED_BY_COOKIE=this.REPOSITORY+".REGISTERED_BY_COOKIE",this.LOG_LEVEL=this.REPOSITORY+".LOG_LEVEL",this.LATITUDE=this.REPOSITORY+".LATITUDE",this.LONGITUDE=this.REPOSITORY+".LONGITUDE"}setItemSessionStorage(t,e){f.setItem(t,e)}getItemSessionStorage(t){return f.getItem(t)}clearSessionStorage(){f.clearMessages()}setStorage(t,e){c.setItem(t,e)}getStorage(t){return c.getItem(t)}clearStorage(){c.clear()}setBrowserPublicKey(t){c.setItem(this.BROWSER_PUBLIC_KEY,t)}getBrowserPublicKey(){return c.getItem(this.BROWSER_PUBLIC_KEY)}setBrowserPrivateKey(t){c.setItem(this.BROWSER_PRIVATE_KEY,t)}getBrowserPrivateKey(){return c.getItem(this.BROWSER_PRIVATE_KEY)}async setAppKey(t){c.setItem(this.APP_KEY,t)}getAppKey(){return c.getItem(this.APP_KEY)}setVAPID(t){c.setItem(this.VAPID_PUBLIC,t)}getVAPID(){return c.getItem(this.VAPID_PUBLIC)}setEnabled(t){c.setItem(this.ENABLED,t)}getEnabled(){return c.getItem(this.ENABLED)}setServiceSyncTime(t){c.setItem(this.SERVICE_SYNC_TIME,t*this.BASE_TIME)}getServiceSyncTime(){return c.getItem(this.SERVICE_SYNC_TIME)||1*this.BASE_TIME}setLocationEnabled(t){c.setItem(this.LOCATION_ENABLED,t)}getLocationEnabled(){return c.getItem(this.LOCATION_ENABLED)}setLocationUpdateMinutes(t){c.setItem(this.LOCATION_UPDATE_MINUTES,t)}getLocationUpdateMinutes(){return c.getItem(this.LOCATION_UPDATE_MINUTES)||30}async setRequestLocation(t){c.setItem(this.REQUEST_LOCATION,t)}getRequestLocation(){return!!c&&c.getItem(this.REQUEST_LOCATION)}async setPlatform(t){c.setItem(this.PLATFORM,t)}getPlatform(){return c&&c.getItem(this.PLATFORM)||a.platform}getVersion(){return a.version}async setBrowserName(t){c.setItem(this.BROWSER_NAME,t)}getBrowserName(){return c.getItem(this.BROWSER_NAME)}setBrowserVersion(t){c.setItem(this.BROWSER_VERSION,t)}getBrowserVersion(){return c.getItem(this.BROWSER_VERSION)}async setOsName(t){c.setItem(this.OS_NAME,t)}getOsName(){return c.getItem(this.OS_NAME)}setOsVersion(t){c.setItem(this.OS_VERSION,t)}getOsVersion(){return c.getItem(this.OS_VERSION)}setDeviceType(t){c.setItem(this.DEVICE_TYPE,t)}getDeviceType(){return c.getItem(this.DEVICE_TYPE)}setSupported(t){c.setItem(this.SUPPORTED,t)}getSupported(){return c.getItem(this.SUPPORTED)}setServiceTimestamp(t){c.setItem(this.SERVICE_TIMESTAMP,t)}getServiceTimestamp(){return c.getItem(this.SERVICE_TIMESTAMP)}setLocationTimestamp(t){c.setItem(this.LOCATION_TIMESTAMP,t)}getLocationTimestamp(){return c.getItem(this.LOCATION_TIMESTAMP)}setPermissionLocation(t){c.setItem(this.PERMISSION_LOCATION,t)}getPermissionLocation(){return c.getItem(this.PERMISSION_LOCATION)}setDebugLog(t){c.setItem(this.SET_LOG_DEBUG,t)}getDebugLog(){return"false"!==c.getItem(this.SET_LOG_DEBUG)}setLogLevel(t){c.setItem(this.LOG_LEVEL,t)}getLogLevel(){return c.getItem(this.LOG_LEVEL)}setNewUserTimestamp(t){c.setItem(this.NEW_USER_TIMESTAMP,t)}getNewUserTimestamp(){return c.getItem(this.NEW_USER_TIMESTAMP)}async setExternalIdRequest(t){c&&c.isLocalStorageAvailable()&&c.setItem(this.EXTERNAL_ID,t),l&&l.IDB&&await l.setItem(this.EXTERNAL_ID,t)}async getExternalIdRequest(){let t;try{c&&c.isLocalStorageAvailable()?t=c.getItem(this.EXTERNAL_ID):l&&l.IDB&&(t=await l.getItem(this.EXTERNAL_ID))}catch(t){}return t}setExternalId(t){c.setItem(this.EXTERNAL_ID,t)}getExternalId(){return c.getItem(this.EXTERNAL_ID)}async getDeviceJson(){return c.getItem(this.DEVICE_JSON)}async setDeviceJson(t){c.setItem(this.DEVICE_JSON,t)}async getRegisteredByCookie(){return c.getItem(this.REGISTERED_BY_COOKIE)}async setRegisteredByCookie(t){c.setItem(this.REGISTERED_BY_COOKIE,t)}setLatitude(t){c.setItem(this.LATITUDE,t)}getLatitude(){return c.getItem(this.LATITUDE)}setLongitude(t){c.setItem(this.LONGITUDE,t)}getLongitude(){return c.getItem(this.LONGITUDE)}},p=Object.freeze({DEBUG:1,INFO:2,WARNING:3,ERROR:4}),E=p;class g{constructor(t){this.tag="[IND]",t&&(this.tag=t),this.level=E.INFO,this.setLogLevel((new d).getLogLevel()),this.log=[]}setLogLevel(t){t&&t>=E.DEBUG&&t<=E.ERROR&&(this.level=t)}static addedAsString(t){return"string"==typeof t?t:JSON.stringify(t,null,2)}d(){if(this.level<=E.DEBUG)for(let t=0;t<arguments.length;t++)this.log+=g.addedAsString(arguments[t]);return this}i(){if(this.level<=E.INFO)for(let t=0;t<arguments.length;t++)this.log+=g.addedAsString(arguments[t]);return this}w(){if(this.level<=E.WARNING)for(let t=0;t<arguments.length;t++)this.log+=g.addedAsString(arguments[t]);return this}e(){if(this.level<=E.ERROR)for(let t=0;t<arguments.length;t++)this.log+=g.addedAsString(arguments[t]);return this}e(t){return this.level<=E.ERROR&&(this.log+=`${t.errorCode}: ${t.errorMessage}`),this}writeLog(){this.log.length>0&&console.log(this.tag,this.log),this.log=[]}}const y=g,m=class{constructor(t,e,n){this.errorCode=t,this.errorMessage=e,null!=n&&(this.exceptionMessage=n)}},v=new class{constructor(){}showError(t,e,n){if(null!=t){const r=Object.values(t.ErrorCode).indexOf(e);return r>=0?new m(Object.keys(t.ErrorCode)[r],Object.keys(t.ErrorMessage)[r],n):new m(GENERAL_ERROR,"general error",n)}}},I={ErrorCode:{GENERAL_ERROR:600,API_SERVER_ERROR:500,API_PARAMETER_MISSING:400,API_APPKEY_NOT_VALID:401,API_FORBIDDEN_REQUEST:403,API_DEVICE_NOT_FOUND:404,API_TOPICS_ARE_INSERTED:409,BAD_REQUEST_SERVER_ERROR:410},ErrorMessage:{GENERAL_ERROR:"General Error",API_SERVER_ERROR:"Error server response",API_PARAMETER_MISSING:"Api parameter missing",API_APPKEY_NOT_VALID:"appKey is not valid",API_FORBIDDEN_REQUEST:"forbidden request",API_DEVICE_NOT_FOUND:"device not found",API_TOPICS_ARE_INSERTED:"topics are inserted",BAD_REQUEST_SERVER_ERROR:"bad request"}},_=class{constructor(){this.URL_BASE="",this.GET="GET",this.POST="POST",this.PUT="PUT",this.DELETE="DELETE"}async getURL(){return this.URL_BASE}async call(t,e,n,r){const i=new y("[IND]BaseClient: ");let o=await this.getURL()+n.getPath(e)+n.getParams();n.isJourneyRequest()&&(o=o.replace("v1","v2"));const s={method:t,headers:n.addHeaders()};t!==this.GET&&(s.body=JSON.stringify(n.getBody())),r&&(s.credentials=r);try{const e=await fetch(o,s),r=await e.json();return e.ok?(i.d("Method: "+t+"\nURL: "+o+"\n"+(t!==this.GET?"Request Body: "+JSON.stringify(n.getBody(),null,"\t")+"\n":"")+"Response Code: "+r.statusCode+"\nResponse Message: "+r.message+"\nResponse Body:",JSON.stringify(r.data,null,"\t")).writeLog(),r):(i.d("Method: "+t+"\nURL: "+o+"\n"+(t!==this.GET?"Request Body: "+JSON.stringify(n.getBody(),null,"\t")+"\n":"")+"Response Code: "+e.status+"\nResponse Message: "+e.statusText+"\n").writeLog(),new m(e.status,e.statusText))}catch(e){return i.d("Method: "+t+"\nURL: "+o+"\n"+(t!==this.GET?"Request Body: "+JSON.stringify(n.getBody(),null,"\t")+"\n":"")+"Error: "+e).writeLog(),v.showError(I,I.ErrorCode.GENERAL_ERROR,e)}}async get(t,e){return await this.call(this.GET,t,e)}async post(t,e,n){return await this.call(this.POST,t,e,n)}async put(t,e,n){return await this.call(this.PUT,t,e,n)}async delete(t,e){return await this.call(this.DELETE,t,e)}},O=class{constructor(){this.PARAM_APP_KEY="appKey",this.PARAM_DEVICE_ID="deviceId",this.PARAM_PUSH_TOKEN="pushToken",this.PARAM_ENABLED="enabled",this.PARAM_PLATFORM="platform",this.PARAM_VERSION="version",this.PARAM_TOPICS="topics",this.PARAM_EVENT_TYPE="eventType",this.PARAM_PUSH_ID="pushId",this.PARAM_CLICKED_BUTTON="clickedButton",this.PARAM_PERMISSION_TYPE="permissionType",this.PARAM_LATITUDE="latitude",this.PARAM_LONGITUDE="longitude",this.PARAM_INAPP_ID="inAppId",this.PARAM_INAPP_EVENT_TYPE="eventType",this.PARAM_INAPP_CLICKED_BUTTON="clickedButton",this.PARAM_INAPP_LAST_VERSION_ID="lastVersionId",this.PARAM_INBOX_EXTERNALID="externalId",this.PARAM_INBOX_PAGE="page",this.PARAM_INBOX_PAGE_SIZE="pageSize",this.PARAM_INBOX_DATE_FROM="dateFrom",this.PARAM_INBOX_DATE_TO="dateTo",this.PARAM_INBOX_STATUS="status",this.PARAM_INBOX_SENDER_IDS="sendingIds",this.PARAM_CUSTOMER_ID="customerId",this.PARAM_CUSTOMER_FIELD_NAMES="fieldNames",this.PARAM_CUSTOMER_FIELDS="fields",this.PARAM_CUSTOMER_LINK="link",this.PARAM_CUSTOMER_CHANNEL="channel",this.appKey=(new d).getAppKey(),this.params=null,this.pathParams={},this.headers={}}getParams(){return"?"+this.PARAM_APP_KEY+"="+this.appKey+(this.params?"&"+this.params:"")}getBody(){return this.body?this.body:""}getPath(t){let e=t;return Object.keys(this.pathParams).forEach((t=>{e=e.replace(t,this.pathParams[t])})),e}addHeaders(){const t=new Headers({"Content-Type":"application/json"});return Object.keys(this.headers).forEach((e=>{t.append(e,this.headers[e])})),t}isJourneyRequest(){return this.journeyRequest}setJourneyRequest(t){this.journeyRequest=t}},b=Object.freeze({PUSH:"push",INAPP:"inapp",CHAT:"chat"}),w=class{constructor(t=null,e){null==t?(this.browserPublicKey=(new d).getBrowserPublicKey(),this.browserPrivateKey=(new d).getBrowserPrivateKey(),this.platform=(new d).getPlatform(),this.version=(new d).getVersion(),this.browserName=(new d).getBrowserName(),this.browserVersion=(new d).getBrowserVersion(),this.osName=(new d).getOsName(),this.osVersion=(new d).getOsVersion(),this.deviceType=(new d).getDeviceType(),(new d).getEnabled()&&(this.enabled="true"===(new d).getEnabled()),(new d).getExternalId()&&(this.externalCode=(new d).getExternalId())):e?(t.enabled&&(this.enabled=t.enabled,(new d).setEnabled(this.enabled)),t.registeredByCookie&&(this.registeredByCookie=t.registeredByCookie,(new d).setRegisteredByCookie(this.registeredByCookie))):(t.browserPublicKey&&(this.browserPublicKey=t.browserPublicKey),t.browserPrivateKey&&(this.browserPrivateKey=t.browserPrivateKey),t.platform&&(this.platform=t.platform),t.version&&(this.version=t.version),t.osVersion&&(this.osVersion=t.osVersion),t.browserName&&(this.browserName=t.browserName),t.browserVersion&&(this.browserVersion=t.browserVersion),t.osName&&(this.osName=t.osName),t.deviceType&&(this.deviceType=t.deviceType),t.enabled&&(this.enabled=t.enabled),t.externalCode&&(this.externalCode=t.externalCode)),this.platform&&(this.productName=this.platform),this.version&&(this.productVersion=this.version),navigator&&"language"in navigator&&(this.locale=navigator.language),Intl&&"DateTimeFormat"in Intl&&(this.timeZone=Intl.DateTimeFormat().resolvedOptions().timeZone),this.timeOffset=-(new Date).getTimezoneOffset()}getDeviceId(){return this.deviceId}setDeviceId(t){this.deviceId=t}setExternalCode(t){this.externalCode=t}static setDeviceJson(t){(new d).setDeviceJson(JSON.stringify(t.toJSON()))}toJSON(){const t={};return this.platform&&(t.platform=this.platform),this.version&&(t.version=this.version),this.productName&&(t.productName=this.productName),this.productVersion&&(t.productVersion=this.productVersion),this.browserName&&(t.browserName=this.browserName),this.browserVersion&&(t.browserVersion=this.browserVersion),this.osName&&(t.osName=this.osName),this.osVersion&&(t.osVersion=this.osVersion),this.deviceType&&(t.deviceType=this.deviceType),this.locale&&(t.locale=this.locale),this.timeZone&&(t.timeZome=this.timeZone),this.timeOffset&&(t.timeOffset=this.timeOffset),this.enabled&&(t.enabled=this.enabled),this.browserPublicKey&&(t.browserPublicKey=this.browserPublicKey),this.browserPrivateKey&&(t.browserPrivateKey=this.browserPrivateKey),this.externalCode&&(t.externalCode=this.externalCode),t}},P=Object.freeze({DEFAULT:-1,ENABLE:1,DISABLE:0}),S=Object.freeze({EVENT_TYPE_CLICK:"click",EVENT_TYPE_RECEIVE:"receive",EVENT_TYPE_UPDATE:"update",EVENT_TYPE_ACCEPT:"accept",EVENT_TYPE_REJECT:"reject",EVENT_TYPE_ASK:"ask"}),R=class{static isServiceTimestampExceed(){return!(new d).getServiceTimestamp()||(new d).getServiceSyncTime()<=(Date.now()-(new d).getServiceTimestamp())/6e4}static isFunction(t){return!(!t||"function"!=typeof t)}},T=class{static async getPermissions(){const t=await this.getPermission("geolocation"),e={};return t&&(e.location=t.state),e}static async getPermission(t){try{if(navigator&&navigator.permissions&&navigator.permissions.query&&t)return await navigator.permissions.query({name:t,userVisibleOnly:!0})}catch(t){return null}return null}static async setPermissionsCallback(){await this.setCallback("geolocation",navigator.indigitallRequestLocationPermission)}static async setCallback(t,e){const n=await this.getPermission(t);if(n){let r=n.state;"onchange"in n&&(n.onchange=()=>{new y("[IND]CorePermissions: ").d(t+" permission state has changed from "+r+" to "+n.state).writeLog(),r=n.state,e&&e({name:t,state:n.state})})}}},A=new y("[IND]Crypto"),N=new TextEncoder("utf-8"),L="HMAC",C=class{static async createHmac(t,e){try{const n=window?.crypto?.subtle;if(!n)return;const r=await n.importKey("raw",N.encode(t),{name:L,hash:{name:"SHA-256"}},!1,["sign","verify"]),i=await n.sign(L,r,N.encode(e)),o=new Uint8Array(i),s=Array.prototype.map.call(o,(t=>("00"+t.toString(16)).slice(-2))).join("");return A.d("hmac: ",s).writeLog(),s}catch(t){return void A.e("error:",t).writeLog()}}},D=class{static compareJSON(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const r of n)if(t[r]!==e[r]){if("object"!=typeof t[r]||"object"!=typeof e[r])return!1;if(!isEqual(t[r],e[r]))return!1}return!0}},x=class{static isValidFormat(t){return null!=t&&""!=t&&"null"!=t&&t.length>8}},U={Repository:d,Config:a,Api:t,Models:e,Utils:i}})(),r})(),t.exports=e()},872:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}Object.defineProperty(e,"__esModule",{value:!0});var i={Core:!0};Object.defineProperty(e,"Core",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return o.default}});var o=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var n=u(e);if(n&&n.has(t))return n.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=t[s]}return i.default=t,n&&n.set(t,i),i}(n(153));Object.keys(o).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(i,t)||t in e&&e[t]===o[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return o[t]}}))}));var s,a=(s=n(106))&&s.__esModule?s:{default:s};function u(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(u=function(t){return t?n:e})(t)}},659:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n(545)),i=a(n(358)),o=a(n(568)),s=a(n(801));function a(t){return t&&t.__esModule?t:{default:t}}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(){c=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function h(t,e,n,i){var o=e&&e.prototype instanceof p?e:p,s=Object.create(o.prototype),a=new R(i||[]);return r(s,"_invoke",{value:b(t,n,a)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var d={};function p(){}function E(){}function g(){}var y={};l(y,o,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(T([])));v&&v!==e&&n.call(v,o)&&(y=v);var I=g.prototype=p.prototype=Object.create(y);function _(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function i(r,o,s,a){var c=f(t[r],t,o);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==u(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,s,a)}),(function(t){i("throw",t,s,a)})):e.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return i("throw",t,s,a)}))}a(c.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function b(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=w(s,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return E.prototype=g,r(I,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:E,configurable:!0}),E.displayName=l(g,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,a,"GeneratorFunction")),t.prototype=Object.create(I),t},t.awrap=function(t){return{__await:t}},_(O.prototype),l(O.prototype,s,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new O(h(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},_(I),l(I,a,"Generator"),l(I,o,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=T,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function l(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){l(o,r,i,s,a,"next",t)}function a(t){l(o,r,i,s,a,"throw",t)}s(void 0)}))}}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===u(i)?i:String(i)),r)}var i}var d=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.URL_BASE="",this.GET="GET",this.POST="POST",this.PUT="PUT",this.DELETE="DELETE"}var e,n,a,u,l,d,p,E;return e=t,n=[{key:"getURL",value:(E=h(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.URL_BASE);case 1:case"end":return t.stop()}}),t,this)}))),function(){return E.apply(this,arguments)})},{key:"call",value:(p=h(c().mark((function t(e,n,a,u){var l,h,f,d,p;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=new r.default("[IND]BaseClient: "),t.next=3,this.getURL();case 3:return t.t0=t.sent,t.t1=a.getPath(n),t.t2=t.t0+t.t1,t.t3=a.getParams(),h=t.t2+t.t3,a.isJourneyRequest()&&(h=h.replace("v1","v2")),f={method:e,headers:a.addHeaders()},e!==this.GET&&(f.body=JSON.stringify(a.getBody())),u&&(f.credentials=u),t.prev=12,t.next=15,fetch(h,f);case 15:return d=t.sent,t.next=18,d.json();case 18:if(p=t.sent,!d.ok){t.next=22;break}return l.d("Method: "+e+"\nURL: "+h+"\n"+"".concat(e!==this.GET?"Request Body: "+JSON.stringify(a.getBody(),null,"\t")+"\n":"")+"Response Code: "+p.statusCode+"\nResponse Message: "+p.message+"\nResponse Body:",JSON.stringify(p.data,null,"\t")).writeLog(),t.abrupt("return",p);case 22:return l.d("Method: "+e+"\nURL: "+h+"\n"+"".concat(e!==this.GET?"Request Body: "+JSON.stringify(a.getBody(),null,"\t")+"\n":"")+"Response Code: "+d.status+"\nResponse Message: "+d.statusText+"\n").writeLog(),t.abrupt("return",new i.default(d.status,d.statusText));case 26:return t.prev=26,t.t4=t.catch(12),l.d("Method: "+e+"\nURL: "+h+"\n"+"".concat(e!==this.GET?"Request Body: "+JSON.stringify(a.getBody(),null,"\t")+"\n":"")+"Error: "+t.t4).writeLog(),t.abrupt("return",o.default.showError(s.default,s.default.ErrorCode.GENERAL_ERROR,t.t4));case 30:case"end":return t.stop()}}),t,this,[[12,26]])}))),function(t,e,n,r){return p.apply(this,arguments)})},{key:"get",value:(d=h(c().mark((function t(e,n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(this.GET,e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return d.apply(this,arguments)})},{key:"post",value:(l=h(c().mark((function t(e,n,r){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(this.POST,e,n,r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return l.apply(this,arguments)})},{key:"put",value:(u=h(c().mark((function t(e,n,r){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(this.PUT,e,n,r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return u.apply(this,arguments)})},{key:"delete",value:(a=h(c().mark((function t(e,n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(this.DELETE,e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})}],n&&f(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=d},580:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(640))&&r.__esModule?r:{default:r};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===o(i)?i:String(i)),r)}var i}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.PARAM_APP_KEY="appKey",this.PARAM_DEVICE_ID="deviceId",this.PARAM_PUSH_TOKEN="pushToken",this.PARAM_ENABLED="enabled",this.PARAM_PLATFORM="platform",this.PARAM_VERSION="version",this.PARAM_TOPICS="topics",this.PARAM_EVENT_TYPE="eventType",this.PARAM_PUSH_ID="pushId",this.PARAM_CLICKED_BUTTON="clickedButton",this.PARAM_PERMISSION_TYPE="permissionType",this.PARAM_LATITUDE="latitude",this.PARAM_LONGITUDE="longitude",this.PARAM_INAPP_ID="inAppId",this.PARAM_INAPP_EVENT_TYPE="eventType",this.PARAM_INAPP_CLICKED_BUTTON="clickedButton",this.PARAM_INAPP_LAST_VERSION_ID="lastVersionId",this.PARAM_INBOX_EXTERNALID="externalId",this.PARAM_INBOX_PAGE="page",this.PARAM_INBOX_PAGE_SIZE="pageSize",this.PARAM_INBOX_DATE_FROM="dateFrom",this.PARAM_INBOX_DATE_TO="dateTo",this.PARAM_INBOX_STATUS="status",this.PARAM_INBOX_SENDER_IDS="sendingIds",this.PARAM_CUSTOMER_ID="customerId",this.PARAM_CUSTOMER_FIELD_NAMES="fieldNames",this.PARAM_CUSTOMER_FIELDS="fields",this.PARAM_CUSTOMER_LINK="link",this.PARAM_CUSTOMER_CHANNEL="channel",this.appKey=(new i.default).getAppKey(),this.params=null,this.pathParams={},this.headers={}}var e,n;return e=t,(n=[{key:"getParams",value:function(){return"?"+this.PARAM_APP_KEY+"="+this.appKey+(this.params?"&"+this.params:"")}},{key:"getBody",value:function(){return this.body?this.body:""}},{key:"getPath",value:function(t){var e=this,n=t;return Object.keys(this.pathParams).forEach((function(t){n=n.replace(t,e.pathParams[t])})),n}},{key:"addHeaders",value:function(){var t=this,e=new Headers({"Content-Type":"application/json"});return Object.keys(this.headers).forEach((function(n){e.append(n,t.headers[n])})),e}},{key:"isJourneyRequest",value:function(){return this.journeyRequest}},{key:"setJourneyRequest",value:function(t){this.journeyRequest=t}}])&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=a},744:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"BaseClient",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"BaseRequest",{enumerable:!0,get:function(){return i.default}});var r=o(n(659)),i=o(n(580));function o(t){return t&&t.__esModule?t:{default:t}}},802:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r={platform:"webpush",version:"0.0.1"},i=n(248);r.version=i.version;var o=r=Object.assign(r,{client:{URL_BASE:"https://".concat("","device-api.indigitall.com/v1"),URL_DEVICE_V2:"https://".concat("","device-api.indigitall.com/v2"),INAPP_URL_BASE:"https://".concat("","inapp-api.indigitall.com/v1"),INBOX_URL_BASE:"https://".concat("","inbox-api.indigitall.com/v1"),CUSTOMER_URL_BASE:"https://".concat("","device-api.indigitall.com/v2")}});e.default=o},106:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=h(n(802)),o=h(n(640)),s=l(n(744)),a=l(n(253)),u=l(n(550));function c(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(c=function(t){return t?n:e})(t)}function l(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var n=c(e);if(n&&n.has(t))return n.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=t[s]}return i.default=t,n&&n.set(t,i),i}function h(t){return t&&t.__esModule?t:{default:t}}var f={Repository:o.default,Config:i.default,Api:s,Models:a,Utils:u};e.default=f},901:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.Channel=void 0;var n=Object.freeze({PUSH:"push",INAPP:"inapp",CHAT:"chat"});e.Channel=n;var r=n;e.default=r},354:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(640))&&r.__esModule?r:{default:r};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===o(i)?i:String(i)),r)}var i}var u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;s(this,t),null==e?(this.browserPublicKey=(new i.default).getBrowserPublicKey(),this.browserPrivateKey=(new i.default).getBrowserPrivateKey(),this.platform=(new i.default).getPlatform(),this.version=(new i.default).getVersion(),this.browserName=(new i.default).getBrowserName(),this.browserVersion=(new i.default).getBrowserVersion(),this.osName=(new i.default).getOsName(),this.osVersion=(new i.default).getOsVersion(),this.deviceType=(new i.default).getDeviceType(),(new i.default).getEnabled()&&(this.enabled="true"===(new i.default).getEnabled()),(new i.default).getExternalId()&&(this.externalCode=(new i.default).getExternalId())):n?(e.enabled&&(this.enabled=e.enabled,(new i.default).setEnabled(this.enabled)),e.registeredByCookie&&(this.registeredByCookie=e.registeredByCookie,(new i.default).setRegisteredByCookie(this.registeredByCookie))):(e.browserPublicKey&&(this.browserPublicKey=e.browserPublicKey),e.browserPrivateKey&&(this.browserPrivateKey=e.browserPrivateKey),e.platform&&(this.platform=e.platform),e.version&&(this.version=e.version),e.osVersion&&(this.osVersion=e.osVersion),e.browserName&&(this.browserName=e.browserName),e.browserVersion&&(this.browserVersion=e.browserVersion),e.osName&&(this.osName=e.osName),e.deviceType&&(this.deviceType=e.deviceType),e.enabled&&(this.enabled=e.enabled),e.externalCode&&(this.externalCode=e.externalCode)),this.platform&&(this.productName=this.platform),this.version&&(this.productVersion=this.version),navigator&&"language"in navigator&&(this.locale=navigator.language),Intl&&"DateTimeFormat"in Intl&&(this.timeZone=Intl.DateTimeFormat().resolvedOptions().timeZone),this.timeOffset=-(new Date).getTimezoneOffset()}var e,n,r;return e=t,r=[{key:"setDeviceJson",value:function(t){(new i.default).setDeviceJson(JSON.stringify(t.toJSON()))}}],(n=[{key:"getDeviceId",value:function(){return this.deviceId}},{key:"setDeviceId",value:function(t){this.deviceId=t}},{key:"setExternalCode",value:function(t){this.externalCode=t}},{key:"toJSON",value:function(){var t={};return this.platform&&(t.platform=this.platform),this.version&&(t.version=this.version),this.productName&&(t.productName=this.productName),this.productVersion&&(t.productVersion=this.productVersion),this.browserName&&(t.browserName=this.browserName),this.browserVersion&&(t.browserVersion=this.browserVersion),this.osName&&(t.osName=this.osName),this.osVersion&&(t.osVersion=this.osVersion),this.deviceType&&(t.deviceType=this.deviceType),this.locale&&(t.locale=this.locale),this.timeZone&&(t.timeZome=this.timeZone),this.timeOffset&&(t.timeOffset=this.timeOffset),this.enabled&&(t.enabled=this.enabled),this.browserPublicKey&&(t.browserPublicKey=this.browserPublicKey),this.browserPrivateKey&&(t.browserPrivateKey=this.browserPrivateKey),this.externalCode&&(t.externalCode=this.externalCode),t}}])&&a(e.prototype,n),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=u},202:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=Object.freeze({DEFAULT:-1,ENABLE:1,DISABLE:0});e.default=n},801:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={ErrorCode:{GENERAL_ERROR:600,API_SERVER_ERROR:500,API_PARAMETER_MISSING:400,API_APPKEY_NOT_VALID:401,API_FORBIDDEN_REQUEST:403,API_DEVICE_NOT_FOUND:404,API_TOPICS_ARE_INSERTED:409,BAD_REQUEST_SERVER_ERROR:410},ErrorMessage:{GENERAL_ERROR:"General Error",API_SERVER_ERROR:"Error server response",API_PARAMETER_MISSING:"Api parameter missing",API_APPKEY_NOT_VALID:"appKey is not valid",API_FORBIDDEN_REQUEST:"forbidden request",API_DEVICE_NOT_FOUND:"device not found",API_TOPICS_ARE_INSERTED:"topics are inserted",BAD_REQUEST_SERVER_ERROR:"bad request"}};e.default=n},358:(t,e)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,"string");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key),"symbol"===n(o)?o:String(o)),i)}var o}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.errorCode=e,this.errorMessage=n,null!=r&&(this.exceptionMessage=r)}));e.default=i},22:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=Object.freeze({EVENT_TYPE_CLICK:"click",EVENT_TYPE_RECEIVE:"receive",EVENT_TYPE_UPDATE:"update",EVENT_TYPE_ACCEPT:"accept",EVENT_TYPE_REJECT:"reject",EVENT_TYPE_ASK:"ask"});e.default=n},253:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"Channel",{enumerable:!0,get:function(){return r.Channel}}),Object.defineProperty(e,"Device",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"DeviceStatus",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"ErrorDictionary",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"ErrorModel",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"EventType",{enumerable:!0,get:function(){return u.default}});var r=n(901),i=c(n(354)),o=c(n(202)),s=c(n(801)),a=c(n(358)),u=c(n(22));function c(t){return t&&t.__esModule?t:{default:t}}},104:(t,e)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(){r=function(){return t};var t={},e=Object.prototype,i=e.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var i=e&&e.prototype instanceof p?e:p,s=Object.create(i.prototype),a=new R(r||[]);return o(s,"_invoke",{value:b(t,n,a)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var d={};function p(){}function E(){}function g(){}var y={};l(y,a,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(T([])));v&&v!==e&&i.call(v,a)&&(y=v);var I=g.prototype=p.prototype=Object.create(y);function _(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,s,a,u){var c=f(t[o],t,s);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==n(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var s;o(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return s=s?s.then(i,i):i()}})}function b(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=w(s,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(i.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:A}}function A(){return{value:void 0,done:!0}}return E.prototype=g,o(I,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:E,configurable:!0}),E.displayName=l(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,c,"GeneratorFunction")),t.prototype=Object.create(I),t},t.awrap=function(t){return{__await:t}},_(O.prototype),l(O.prototype,u,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new O(h(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},_(I),l(I,c,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=T,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function i(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var s=t.apply(e,n);function a(t){i(s,r,o,a,u,"next",t)}function u(t){i(s,r,o,a,u,"throw",t)}a(void 0)}))}}function s(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,"string");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key),"symbol"===n(o)?o:String(o)),i)}var o}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.TAG="[IND]IndexedDB: ",this.DB_NAME="indigitall.indexedDB",this.DB_VERSION=1,this.DB_STORE_NAME="indigitallStore",this.DB_STORE_MODE="readwrite",this.DB_KEY_PATH="id",this.DB_STORE_INDEX="storeIndex",this.IDB=indexedDB||mozzIndexedDB||webkitIndexedDB||msIndexedDB}var e,n,i,a,u,c,l;return e=t,n=[{key:"getDB",value:(l=o(r().mark((function t(){var e=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=e.IDB;if(r){var i=r.open("indigitall.indexedDB",1);i.onupgradeneeded=function(){i.result.createObjectStore("indigitallStore").createIndex("storeIndex","store.key")},i.onsuccess=function(){var e=i.result,n=e.transaction("indigitallStore","readwrite"),r=n.objectStore("indigitallStore"),o=r.index("storeIndex");t({db:e,tx:n,store:r,index:o})},i.onerror=function(t){n(t)}}else n(!1)})));case 1:case"end":return t.stop()}}),t)}))),function(){return l.apply(this,arguments)})},{key:"get",value:(c=o(r().mark((function t(e,n){var i=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){e||r(!1),e.index.get(n).onsuccess=function(n){n.target.result&&(i.close(e),t(n.target.result.store.value)),r(!1)}})));case 1:case"end":return t.stop()}}),t)}))),function(t,e){return c.apply(this,arguments)})},{key:"put",value:(u=o(r().mark((function t(e,n,i){var o=this;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){e||r(!1),e.store.put({store:{key:n,value:i}},n).onsuccess=function(n){o.close(e),t(i)}})));case 1:case"end":return t.stop()}}),t)}))),function(t,e,n){return u.apply(this,arguments)})},{key:"close",value:function(t){if(t.tx)try{t.tx.oncomplete=function(){t.db.close()}}catch(t){console.error(this.TAG,t)}}},{key:"setItem",value:(a=o(r().mark((function t(e,n){var i;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getDB();case 3:return i=t.sent,t.abrupt("return",this.put(i,e,n));case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t,e){return a.apply(this,arguments)})},{key:"getItem",value:(i=o(r().mark((function t(e){var n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getDB();case 3:return n=t.sent,t.abrupt("return",this.get(n,e));case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return i.apply(this,arguments)})}],n&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());e.default=a},795:(t,e)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,"string");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key),"symbol"===n(o)?o:String(o)),i)}var o}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.storage=this.isLocalStorageAvailable()?window.localStorage:null}var e,n;return e=t,(n=[{key:"isLocalStorageAvailable",value:function(){try{var t=window.localStorage,e="__storage_test__";if(t)return t.setItem(e,e),t.removeItem(e),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==i.length}return!1}},{key:"setItem",value:function(t,e){return null!=this.storage&&(this.storage.setItem(t,e),!0)}},{key:"getItem",value:function(t){return null!=this.storage?this.storage.getItem(t):null}},{key:"deleteItem",value:function(t){return!!this.storage&&(this.storage.setItem(t,value),!0)}},{key:"clear",value:function(){this.storage&&this.storage.clear()}}])&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()),o=i;e.default=o},640:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n(802)),i=a(n(795)),o=a(n(104)),s=a(n(636));function a(t){return t&&t.__esModule?t:{default:t}}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(){c=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function h(t,e,n,i){var o=e&&e.prototype instanceof p?e:p,s=Object.create(o.prototype),a=new R(i||[]);return r(s,"_invoke",{value:b(t,n,a)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var d={};function p(){}function E(){}function g(){}var y={};l(y,o,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(T([])));v&&v!==e&&n.call(v,o)&&(y=v);var I=g.prototype=p.prototype=Object.create(y);function _(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function i(r,o,s,a){var c=f(t[r],t,o);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==u(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,s,a)}),(function(t){i("throw",t,s,a)})):e.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return i("throw",t,s,a)}))}a(c.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function b(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=w(s,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return E.prototype=g,r(I,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:E,configurable:!0}),E.displayName=l(g,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,a,"GeneratorFunction")),t.prototype=Object.create(I),t},t.awrap=function(t){return{__await:t}},_(O.prototype),l(O.prototype,s,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new O(h(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},_(I),l(I,a,"Generator"),l(I,o,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=T,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function l(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){l(o,r,i,s,a,"next",t)}function a(t){l(o,r,i,s,a,"throw",t)}s(void 0)}))}}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===u(i)?i:String(i)),r)}var i}var d=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.storage=i.default,this.db=o.default,this.BASE_TIME=60,this.REPOSITORY="indigitall.repository",this.APP_KEY=this.REPOSITORY+".APP_KEY",this.VAPID_PUBLIC=this.REPOSITORY+".VAPID_PUBLIC",this.ENABLED=this.REPOSITORY+".ENABLED",this.DEVICE_ID=this.REPOSITORY+".DEVICE_ID",this.SERVICE_SYNC_TIME=this.REPOSITORY+".SERVICE_SYNC_TIME",this.LOCATION_ENABLED=this.REPOSITORY+".LOCATION_ENABLED",this.LOCATION_UPDATE_MINUTES=this.REPOSITORY+".LOCATION_UPDATE_MINUTES",this.REQUEST_LOCATION=this.REPOSITORY+".REQUEST_LOCATION",this.BROWSER_PUBLIC_KEY=this.REPOSITORY+".BROWSER_PUBLIC_KEY",this.BROWSER_PRIVATE_KEY=this.REPOSITORY+".BROWSER_PRIVATE_KEY",this.PLATFORM=this.REPOSITORY+".PLATFORM",this.BROWSER_NAME=this.REPOSITORY+".BROWSER_NAME",this.BROWSER_VERSION=this.REPOSITORY+".BROWSER_VERSION",this.OS_NAME=this.REPOSITORY+".OS_NAME",this.OS_VERSION=this.REPOSITORY+".OS_VERSION",this.DEVICE_TYPE=this.REPOSITORY+".DEVICE_TYPE",this.SUPPORTED=this.REPOSITORY+".SUPPORTED",this.SERVICE_TIMESTAMP=this.REPOSITORY+".SERVICE_TIMESTAMP",this.LOCATION_TIMESTAMP=this.REPOSITORY+".LOCATION_TIMESTAMP",this.PERMISSION_LOCATION=this.REPOSITORY+".PERMISSION_LOCATION",this.SET_LOG_DEBUG=this.REPOSITORY+".SET_LOG_DEBUG",this.NEW_USER_TIMESTAMP=this.REPOSITORY+".NEW_USER_TIMESTAMP",this.EXTERNAL_ID=this.REPOSITORY+".EXTERNAL_ID",this.REGISTERED_BY_COOKIE=this.REPOSITORY+".REGISTERED_BY_COOKIE",this.LOG_LEVEL=this.REPOSITORY+".LOG_LEVEL",this.LATITUDE=this.REPOSITORY+".LATITUDE",this.LONGITUDE=this.REPOSITORY+".LONGITUDE"}var e,n,a,u,l,d,p,E,g,y,m,v,I;return e=t,n=[{key:"setItemSessionStorage",value:function(t,e){s.default.setItem(t,e)}},{key:"getItemSessionStorage",value:function(t){return s.default.getItem(t)}},{key:"clearSessionStorage",value:function(){s.default.clearMessages()}},{key:"setStorage",value:function(t,e){i.default.setItem(t,e)}},{key:"getStorage",value:function(t){return i.default.getItem(t)}},{key:"clearStorage",value:function(){i.default.clear()}},{key:"setBrowserPublicKey",value:function(t){i.default.setItem(this.BROWSER_PUBLIC_KEY,t)}},{key:"getBrowserPublicKey",value:function(){return i.default.getItem(this.BROWSER_PUBLIC_KEY)}},{key:"setBrowserPrivateKey",value:function(t){i.default.setItem(this.BROWSER_PRIVATE_KEY,t)}},{key:"getBrowserPrivateKey",value:function(){return i.default.getItem(this.BROWSER_PRIVATE_KEY)}},{key:"setAppKey",value:(I=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.APP_KEY,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return I.apply(this,arguments)})},{key:"getAppKey",value:function(){return i.default.getItem(this.APP_KEY)}},{key:"setVAPID",value:function(t){i.default.setItem(this.VAPID_PUBLIC,t)}},{key:"getVAPID",value:function(){return i.default.getItem(this.VAPID_PUBLIC)}},{key:"setEnabled",value:function(t){i.default.setItem(this.ENABLED,t)}},{key:"getEnabled",value:function(){return i.default.getItem(this.ENABLED)}},{key:"setServiceSyncTime",value:function(t){i.default.setItem(this.SERVICE_SYNC_TIME,t*this.BASE_TIME)}},{key:"getServiceSyncTime",value:function(){return i.default.getItem(this.SERVICE_SYNC_TIME)||1*this.BASE_TIME}},{key:"setLocationEnabled",value:function(t){i.default.setItem(this.LOCATION_ENABLED,t)}},{key:"getLocationEnabled",value:function(){return i.default.getItem(this.LOCATION_ENABLED)}},{key:"setLocationUpdateMinutes",value:function(t){i.default.setItem(this.LOCATION_UPDATE_MINUTES,t)}},{key:"getLocationUpdateMinutes",value:function(){return i.default.getItem(this.LOCATION_UPDATE_MINUTES)||30}},{key:"setRequestLocation",value:(v=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.REQUEST_LOCATION,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return v.apply(this,arguments)})},{key:"getRequestLocation",value:function(){return!!i.default&&i.default.getItem(this.REQUEST_LOCATION)}},{key:"setPlatform",value:(m=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.PLATFORM,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return m.apply(this,arguments)})},{key:"getPlatform",value:function(){return i.default&&i.default.getItem(this.PLATFORM)||r.default.platform}},{key:"getVersion",value:function(){return r.default.version}},{key:"setBrowserName",value:(y=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.BROWSER_NAME,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return y.apply(this,arguments)})},{key:"getBrowserName",value:function(){return i.default.getItem(this.BROWSER_NAME)}},{key:"setBrowserVersion",value:function(t){i.default.setItem(this.BROWSER_VERSION,t)}},{key:"getBrowserVersion",value:function(){return i.default.getItem(this.BROWSER_VERSION)}},{key:"setOsName",value:(g=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.OS_NAME,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return g.apply(this,arguments)})},{key:"getOsName",value:function(){return i.default.getItem(this.OS_NAME)}},{key:"setOsVersion",value:function(t){i.default.setItem(this.OS_VERSION,t)}},{key:"getOsVersion",value:function(){return i.default.getItem(this.OS_VERSION)}},{key:"setDeviceType",value:function(t){i.default.setItem(this.DEVICE_TYPE,t)}},{key:"getDeviceType",value:function(){return i.default.getItem(this.DEVICE_TYPE)}},{key:"setSupported",value:function(t){i.default.setItem(this.SUPPORTED,t)}},{key:"getSupported",value:function(){return i.default.getItem(this.SUPPORTED)}},{key:"setServiceTimestamp",value:function(t){i.default.setItem(this.SERVICE_TIMESTAMP,t)}},{key:"getServiceTimestamp",value:function(){return i.default.getItem(this.SERVICE_TIMESTAMP)}},{key:"setLocationTimestamp",value:function(t){i.default.setItem(this.LOCATION_TIMESTAMP,t)}},{key:"getLocationTimestamp",value:function(){return i.default.getItem(this.LOCATION_TIMESTAMP)}},{key:"setPermissionLocation",value:function(t){i.default.setItem(this.PERMISSION_LOCATION,t)}},{key:"getPermissionLocation",value:function(){return i.default.getItem(this.PERMISSION_LOCATION)}},{key:"setDebugLog",value:function(t){i.default.setItem(this.SET_LOG_DEBUG,t)}},{key:"getDebugLog",value:function(){return"false"!==i.default.getItem(this.SET_LOG_DEBUG)}},{key:"setLogLevel",value:function(t){i.default.setItem(this.LOG_LEVEL,t)}},{key:"getLogLevel",value:function(){return i.default.getItem(this.LOG_LEVEL)}},{key:"setNewUserTimestamp",value:function(t){i.default.setItem(this.NEW_USER_TIMESTAMP,t)}},{key:"getNewUserTimestamp",value:function(){return i.default.getItem(this.NEW_USER_TIMESTAMP)}},{key:"setExternalIdRequest",value:(E=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i.default&&i.default.isLocalStorageAvailable()&&i.default.setItem(this.EXTERNAL_ID,e),!o.default||!o.default.IDB){t.next=4;break}return t.next=4,o.default.setItem(this.EXTERNAL_ID,e);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return E.apply(this,arguments)})},{key:"getExternalIdRequest",value:(p=h(c().mark((function t(){var e;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!i.default||!i.default.isLocalStorageAvailable()){t.next=5;break}e=i.default.getItem(this.EXTERNAL_ID),t.next=9;break;case 5:if(!o.default||!o.default.IDB){t.next=9;break}return t.next=8,o.default.getItem(this.EXTERNAL_ID);case 8:e=t.sent;case 9:t.next=13;break;case 11:t.prev=11,t.t0=t.catch(0);case 13:return t.abrupt("return",e);case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return p.apply(this,arguments)})},{key:"setExternalId",value:function(t){i.default.setItem(this.EXTERNAL_ID,t)}},{key:"getExternalId",value:function(){return i.default.getItem(this.EXTERNAL_ID)}},{key:"getDeviceJson",value:(d=h(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.default.getItem(this.DEVICE_JSON));case 1:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"setDeviceJson",value:(l=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.DEVICE_JSON,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"getRegisteredByCookie",value:(u=h(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.default.getItem(this.REGISTERED_BY_COOKIE));case 1:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"setRegisteredByCookie",value:(a=h(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.REGISTERED_BY_COOKIE,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"setLatitude",value:function(t){i.default.setItem(this.LATITUDE,t)}},{key:"getLatitude",value:function(){return i.default.getItem(this.LATITUDE)}},{key:"setLongitude",value:function(t){i.default.setItem(this.LONGITUDE,t)}},{key:"getLongitude",value:function(){return i.default.getItem(this.LONGITUDE)}}],n&&f(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=d},636:(t,e)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,"string");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key),"symbol"===n(o)?o:String(o)),i)}var o}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.SESSION="indigitall.session.storage",this.session=this.isSessionStorageAvailable()?window.sessionStorage:null}var e,n;return e=t,(n=[{key:"isSessionStorageAvailable",value:function(){try{var t=window.sessionStorage,e="__storage_test__";if(t)return t.setItem(e,e),t.removeItem(e),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==i.length}return!1}},{key:"getItem",value:function(t){return null!=this.session?this.session.getItem(t):null}},{key:"setItem",value:function(t,e){return null!=this.session&&(this.session.setItem(t,e),!0)}},{key:"clearMessages",value:function(){this.session&&this.session.removeItem("messages")}}])&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()),o=i;e.default=o},306:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(640))&&r.__esModule?r:{default:r};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===o(i)?i:String(i)),r)}var i}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"isServiceTimestampExceed",value:function(){return!(new i.default).getServiceTimestamp()||(new i.default).getServiceSyncTime()<=(Date.now()-(new i.default).getServiceTimestamp())/6e4}},{key:"isFunction",value:function(t){return!(!t||"function"!=typeof t)}}],n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=a},897:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(545))&&r.__esModule?r:{default:r};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(){s=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function h(t,e,n,i){var o=e&&e.prototype instanceof p?e:p,s=Object.create(o.prototype),a=new R(i||[]);return r(s,"_invoke",{value:b(t,n,a)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var d={};function p(){}function E(){}function g(){}var y={};l(y,a,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(T([])));v&&v!==e&&n.call(v,a)&&(y=v);var I=g.prototype=p.prototype=Object.create(y);function _(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function i(r,s,a,u){var c=f(t[r],t,s);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==o(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,a,u)}),(function(t){i("throw",t,a,u)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return i("throw",t,a,u)}))}u(c.arg)}var s;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return s=s?s.then(r,r):r()}})}function b(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=w(s,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return E.prototype=g,r(I,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:E,configurable:!0}),E.displayName=l(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,c,"GeneratorFunction")),t.prototype=Object.create(I),t},t.awrap=function(t){return{__await:t}},_(O.prototype),l(O.prototype,u,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new O(h(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},_(I),l(I,c,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=T,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function a(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){a(o,r,i,s,u,"next",t)}function u(t){a(o,r,i,s,u,"throw",t)}s(void 0)}))}}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===o(i)?i:String(i)),r)}var i}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r,o,a,l;return e=t,n=[{key:"getPermissions",value:(l=u(s().mark((function t(){var e,n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getPermission("geolocation");case 2:return e=t.sent,n={},e&&(n.location=e.state),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"getPermission",value:(a=u(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(navigator&&navigator.permissions&&navigator.permissions.query&&e)){t.next=5;break}return t.next=4,navigator.permissions.query({name:e,userVisibleOnly:!0});case 4:return t.abrupt("return",t.sent);case 5:t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",null);case 10:return t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(t){return a.apply(this,arguments)})},{key:"setPermissionsCallback",value:(o=u(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.setCallback("geolocation",navigator.indigitallRequestLocationPermission);case 2:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"setCallback",value:(r=u(s().mark((function t(e,n){var r,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getPermission(e);case 2:(r=t.sent)&&(o=r.state,"onchange"in r&&(r.onchange=function(){new i.default("[IND]CorePermissions: ").d(e+" permission state has changed from "+o+" to "+r.state).writeLog(),o=r.state,n&&n({name:e,state:r.state})}));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})}],n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=l},95:(t,e,n)=>{"use strict";var r;function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(){o=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function h(t,e,n,i){var o=e&&e.prototype instanceof p?e:p,s=Object.create(o.prototype),a=new R(i||[]);return r(s,"_invoke",{value:b(t,n,a)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var d={};function p(){}function E(){}function g(){}var y={};l(y,a,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(T([])));v&&v!==e&&n.call(v,a)&&(y=v);var I=g.prototype=p.prototype=Object.create(y);function _(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function o(r,s,a,u){var c=f(t[r],t,s);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==i(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var s;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return s=s?s.then(r,r):r()}})}function b(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=w(s,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return E.prototype=g,r(I,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:E,configurable:!0}),E.displayName=l(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,c,"GeneratorFunction")),t.prototype=Object.create(I),t},t.awrap=function(t){return{__await:t}},_(O.prototype),l(O.prototype,u,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new O(h(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},_(I),l(I,c,"Generator"),l(I,a,(function(){return this})),l(I,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=T,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function s(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===i(o)?o:String(o)),r)}var o}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.CryptoUtils=void 0;var u=new(((r=n(545))&&r.__esModule?r:{default:r}).default)("[IND]Crypto"),c=new TextEncoder("utf-8"),l="HMAC",h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r,i;return e=t,n=[{key:"createHmac",value:(r=o().mark((function t(e,n){var r,i,s,a,h,f,d;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,s=null===(r=window)||void 0===r||null===(i=r.crypto)||void 0===i?void 0:i.subtle){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,s.importKey("raw",c.encode(e),{name:l,hash:{name:"SHA-256"}},!1,["sign","verify"]);case 6:return a=t.sent,t.next=9,s.sign(l,a,c.encode(n));case 9:return h=t.sent,f=new Uint8Array(h),d=Array.prototype.map.call(f,(function(t){return("00"+t.toString(16)).slice(-2)})).join(""),u.d("hmac: ",d).writeLog(),t.abrupt("return",d);case 16:return t.prev=16,t.t0=t.catch(0),u.e("error:",t.t0).writeLog(),t.abrupt("return");case 20:case"end":return t.stop()}}),t,null,[[0,16]])})),i=function(){var t=this,e=arguments;return new Promise((function(n,i){var o=r.apply(t,e);function a(t){s(o,n,i,a,u,"next",t)}function u(t){s(o,n,i,a,u,"throw",t)}a(void 0)}))},function(t,e){return i.apply(this,arguments)})}],n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.CryptoUtils=h;var f=h;e.default=f},568:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(358))&&r.__esModule?r:{default:r};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===o(i)?i:String(i)),r)}var i}var a=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"showError",value:function(t,e,n){if(null!=t){var r=Object.values(t.ErrorCode).indexOf(e);return r>=0?new i.default(Object.keys(t.ErrorCode)[r],Object.keys(t.ErrorMessage)[r],n):new i.default(GENERAL_ERROR,"general error",n)}}}])&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());e.default=a},970:(t,e)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,"string");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key),"symbol"===n(o)?o:String(o)),i)}var o}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i;return e=t,i=[{key:"compareJSON",value:function(t,e){var r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(var o=0,s=r;o<s.length;o++){var a=s[o];if(t[a]!==e[a]){if("object"!=n(t[a])||"object"!=n(e[a]))return!1;if(!isEqual(t[a],e[a]))return!1}}return!0}}],i&&r(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=i},545:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(n(640)),i=o(n(136));function o(t){return t&&t.__esModule?t:{default:t}}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=function(t,e){if("object"!==s(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===s(i)?i:String(i)),r)}var i}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tag="[IND]",e&&(this.tag=e),this.level=i.default.INFO,this.setLogLevel((new r.default).getLogLevel()),this.log=[]}var e,n,o;return e=t,n=[{key:"setLogLevel",value:function(t){t&&t>=i.default.DEBUG&&t<=i.default.ERROR&&(this.level=t)}},{key:"d",value:function(){if(this.level<=i.default.DEBUG)for(var e=0;e<arguments.length;e++)this.log+=t.addedAsString(arguments[e]);return this}},{key:"i",value:function(){if(this.level<=i.default.INFO)for(var e=0;e<arguments.length;e++)this.log+=t.addedAsString(arguments[e]);return this}},{key:"w",value:function(){if(this.level<=i.default.WARNING)for(var e=0;e<arguments.length;e++)this.log+=t.addedAsString(arguments[e]);return this}},{key:"e",value:function(t){return this.level<=i.default.ERROR&&(this.log+="".concat(t.errorCode,": ").concat(t.errorMessage)),this}},{key:"writeLog",value:function(){this.log.length>0&&console.log(this.tag,this.log),this.log=[]}}],o=[{key:"addedAsString",value:function(t){return"string"==typeof t?t:JSON.stringify(t,null,2)}}],n&&a(e.prototype,n),o&&a(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=u},136:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.LogLevel=void 0;var n=Object.freeze({DEBUG:1,INFO:2,WARNING:3,ERROR:4});e.LogLevel=n;var r=n;e.default=r},506:(t,e)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(o=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,"string");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key),"symbol"===n(o)?o:String(o)),i)}var o}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"isValidFormat",value:function(t){return null!=t&&""!=t&&"null"!=t&&t.length>8}}],n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=i},550:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"CommonUtils",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"CorePermissions",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"CryptoUtils",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"ErrorUtils",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"JsonUtils",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"Log",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return c.LogLevel}}),Object.defineProperty(e,"Validations",{enumerable:!0,get:function(){return l.default}});var r=h(n(306)),i=h(n(897)),o=h(n(95)),s=h(n(568)),a=h(n(970)),u=h(n(545)),c=n(136),l=h(n(506));function h(t){return t&&t.__esModule?t:{default:t}}},248:t=>{"use strict";t.exports=JSON.parse('{"_from":"indigitall-web-core@4.1.1","_id":"indigitall-web-core@4.1.1","_inBundle":false,"_integrity":"sha512-Il5ljK7XeabRPG4szoYtZglGZ75LeQ2YYnUO8Rk8QZu+sim0eNUniYixMgpMzr+eC4rYPfMv4XiVgLO/o5bl3g==","_location":"/indigitall-web-core","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"indigitall-web-core@4.1.1","name":"indigitall-web-core","escapedName":"indigitall-web-core","rawSpec":"4.1.1","saveSpec":null,"fetchSpec":"4.1.1"},"_requiredBy":["#USER","/"],"_resolved":"https://registry.npmjs.org/indigitall-web-core/-/indigitall-web-core-4.1.1.tgz","_shasum":"3128221c365e132f9db788724a7ab241411e3b6c","_spec":"indigitall-web-core@4.1.1","_where":"/home/circleci/webpush/inapp","author":{"name":"Smart2me S.L."},"bundleDependencies":false,"deprecated":false,"description":"indigitall web core","devDependencies":{"@babel/preset-env":"^7.18.10","babel-loader":"^8.2.5","filemanager-webpack-plugin":"^7.0.0","idempotent-babel-polyfill":"^7.4.4","script-loader":"^0.7.2","webpack":"^5.74.0","webpack-bundle-analyzer":"^4.6.1","webpack-cli":"^4.10.0"},"homepage":"https://indigitall.com","main":"index.js","name":"indigitall-web-core","scripts":{"build":"webpack --config webpack.config.js --mode=production","build-dev":"webpack --config webpack.config.js --watch --mode=development","delete-node-modules":"rm -rf node_modules/ && rm -f package-lock.json","install-core":"npm install && npm run build","public":"ws --directory ./public --port 80 --log.format dev","test":"echo \'There are not tests\'"},"version":"4.1.1"}')}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return(()=>{"use strict";n.r(r),n.d(r,{default:()=>$});const{Repository:t}=n(872).Core,e=new class extends t{constructor(){super(),this.INAPP_ENABLED=this.REPOSITORY+".INAPP_ENABLED",this.URL_INAPP_API=this.REPOSITORY+".URL_INAPP_API",this.INAPP_SHOW_ONCE=this.REPOSITORY+".INAPP_SHOW_ONCE",this.INAPP_TIMES_CLICKED=this.REPOSITORY+".INAPP_TIMES_CLICKED",this.INAPP_DISMISS_FOREVER=this.REPOSITORY+".INAPP_DISMISS_FOREVER",this.INAPP_TOPICS=this.REPOSITORY+".INAPP_TOPICS",this.URL_DEVICE_API=this.REPOSITORY+".URL_DEVICE_API"}setItemStorage(t){this.setItemSessionStorage(this.REPOSITORY,t)}getItemStorage(){return this.getItemSessionStorage(this.REPOSITORY)}setDeviceId(t){this.setStorage(this.DEVICE_ID,t)}getDeviceId(){return this.getStorage(this.DEVICE_ID)}setInAppEnabled(t){this.setStorage(this.INAPP_ENABLED,t)}getInAppEnabled(){return this.getStorage(this.INAPP_ENABLED)}getUrlInappApi(){return this.getStorage(this.URL_INAPP_API)}setUrlInappApi(t){this.setStorage(this.URL_INAPP_API,t)}getInAppShowOnce(){return this.getStorage(this.INAPP_SHOW_ONCE)}setInAppShowOnce(t){this.setStorage(this.INAPP_SHOW_ONCE,t)}getInAppTimesClicked(){return this.getStorage(this.INAPP_TIMES_CLICKED)}setInAppTimesClicked(t){this.setStorage(this.INAPP_TIMES_CLICKED,t)}getInAppDismissForever(){return this.getStorage(this.INAPP_DISMISS_FOREVER)}setInAppDismissForever(t){this.setStorage(this.INAPP_DISMISS_FOREVER,t)}getInAppTopics(){return this.getStorage(this.INAPP_TOPICS)}setInAppTopics(t){this.setStorage(this.INAPP_TOPICS,t)}async getUrlDeviceApi(){let t;try{this.storage&&this.storage.isLocalStorageAvailable()?t=this.getStorage(this.URL_DEVICE_API):this.db&&this.db.IDB&&(t=await this.db.getItem(this.URL_DEVICE_API))}catch(t){}return t}},{Validations:i,Log:o}=n(872).Core.Utils,s=class extends i{static isAppKeyFormat(){const t=e.getAppKey();return null!=t&&""!=t&&"null"!=t&&t.length>3}static isValidFormatRequest(){const t=new o("[IND]InAppValidations: "),n=e.getDeviceId();let r=!0;return this.isAppKeyFormat()||(r=!1,t.w("appKey is null or empty").writeLog()),this.isValidFormat(n)||(r=!1,t.w("deviceId is null or empty").writeLog()),r}},{ErrorDictionary:a}=n(872).Core.Models,u=a.ErrorCode;Object.assign(u,{INAPP_ERROR:2e3,INAPP_SHOW_INAPP_ERROR:2100,INAPP_WAS_EXPIRED:2101,INAPP_WAS_SHOWN_MANY_TIMES:2102,INAPP_WAS_CLICKED_MANY_TIMES:2103,INAPP_FORM_TYPE_NOT_CORRECT:2120,INAPP_FORM_FIELD_IS_EMPTY:2121,INAPP_POPUP_ERROR:2300,INAPP_WAS_DISMISSED_FOREVER:2304,INAPP_ERROR_CONTENT_MESSAGE:2305,INAPP_INSTANCE_TOPICS_ERROR:2306,INAPP_GENERAL_ERROR:2600});const c=a.ErrorMessage;Object.assign(c,{INAPP_ERROR:"inApp error",INAPP_SHOW_INAPP_ERROR:"error on show inApp",INAPP_WAS_EXPIRED:"InApp was expired",INAPP_WAS_SHOWN_MANY_TIMES:"InApp was shown more than $x times",INAPP_WAS_CLICKED_MANY_TIMES:"InApp was clicked more than $x times",NAPP_FORM_TYPE_NOT_CORRECT:"Input type is not correct",INAPP_FORM_FIELD_IS_EMPTY:"Field is empty",INAPP_POPUP_ERROR:"error on popup",INAPP_WAS_DISMISSED_FOREVER:"InApp was dismissed forever",INAPP_ERROR_CONTENT_MESSAGE:"InApp error with content",INAPP_INSTANCE_TOPICS_ERROR:"topics instance is not correct, only string[] is valid types",INAPP_GENERAL_ERROR:"inApp general error"});const l={ErrorCode:u,ErrorMessage:c},h=class{static searchInApp(t){const e=this.getListInApp();return null==e?null:this.findInAppFromInAppList(e,t)}static searchInAppWithInAppId(t){const e=this.getListInApp();return null==e?null:this.findInAppFromInAppListWithInAppId(e,t)}static addInApp(t){let n=this.getListInApp();null!=n?n.push(t):n=[t],e.setItemStorage(JSON.stringify(n))}static getListInApp(){let t=null;try{e.getItemStorage()&&(t=JSON.parse(e.getItemStorage()))}catch(t){console.error(t.message)}return t}static addInAppNewClick(t){this.updateInAppField(t.inAppId,!0,null,null)}static addInAppNewShow(t){this.updateInAppField(t.inAppId,null,!0,null)}static addInAppDismissForever(t){this.updateInAppField(t.inAppId,null,null,!0)}static updateInAppField(t,n,r,i){const o=this.getListInApp(),s=[];if(null!=o)for(let e=0;e<o.length;e++)o[e].inAppId==t&&(null!=n&&(o[e].inAppShow.timesClicked+=1),null!=r&&(o[e].inAppShow.timesShowed+=1),null!=i&&(o[e].inAppShow.wasDismissed=!0)),s.push(o[e]);e.setItemStorage(JSON.stringify(s))}static deleteInApp(t){const n=this.getListInApp(),r=[];if(null!=n)for(let e=0;e<n.length;e++)n[e].inAppId!=t.inAppId&&r.push(n[e]);e.setItemStorage(JSON.stringify(r))}static findInAppFromInAppListWithInAppId(t,e){if(null!=t)for(let n=0;n<t.length;n++)if(t[n].inAppId&&t[n].inAppId==e)return t[n];return null}static findInAppFromInAppList(t,e){if(null!=t)for(let n=0;n<t.length;n++)if(t[n].schema.code&&t[n].schema.code==e)return t[n];return null}static findInAppFromInAppListWithInAppId(t,e){if(null!=t)for(let n=0;n<t.length;n++)if(t[n].inAppId&&t[n].inAppId==e)return t[n];return null}},f=class{constructor(t){this.URL="url",t.actionId&&(this.actionId=t.actionId),t.destroy&&(this.destroy=t.destroy),t.topics&&(this.topics=t.topics),t.type&&(this.type=t.type),t.url&&(this.url=t.url),t.no_action&&(this.no_action=t.no_action)}},d=class{constructor(t){if(t.cacheTtl&&(this.cacheTtl=t.cacheTtl),t.inAppId&&(this.inAppId=t.inAppId),t.showOnce&&(this.showOnce=t.showOnce),t.version&&(this.version=t.version),t.customData&&(this.customData=t.customData),t.creationDate?this.creationDate=t.creationDate:this.creationDate=S.getDate((new Date).getTime()),t.expiredDate)this.expiredDate=t.expiredDate;else{let t=24192e5;this.cacheTtl&&(t=60*this.cacheTtl*60*1e3),this.expiredDate=S.getDate((new Date).getTime()+t)}t.schema&&(this.schema=new class{constructor(t){t.code&&(this.code=t.code),t.width&&(this.width=t.width),t.height&&(this.height=t.height)}}(t.schema)),t.properties&&(this.properties=new class{constructor(t){t.contentUrl&&(this.contentUrl=t.contentUrl),t.showTime&&(this.showTime=t.showTime),t.numberOfShows&&(this.numberOfShows=t.numberOfShows),t.numberOfClicks&&(this.numberOfClicks=t.numberOfClicks),t.dismissForever&&(this.dismissForever=t.dismissForever),t.layout&&(this.layout=new class{constructor(t){t.borderRadius&&(this.borderRadius=t.borderRadius)}}(t.layout)),t.action&&(this.action=new f(t.action))}setAction(t){this.action=t}}(t.properties)),this.inAppShow=new class{constructor(t){this.timesShowed=0,this.timesClicked=0,this.wasDismissed=!1,t&&(t.timesShowed&&(this.timesShowed=t.timesShowed),t.timesClicked&&(this.timesClicked=t.timesClicked),t.wasDismissed&&(this.wasDismissed=t.wasDismissed))}}(t.inAppShow)}},{BaseRequest:p}=n(872).Core.Api,{Config:E}=n(872).Core,g=class extends p{constructor(){super()}setEventType(t){this.eventType=t}setInAppId(t){this.inAppId=t}setActionId(t){this.actionId=t}setClickedButton(t){this.clickedButton=t}setLastVersionId(t){this.lastVersionId=t}setVersion(t){this.version=t}setDeviceId(t){this.deviceId=t}setPlatform(t){this.platform=t}postEventPrintRequest(){const t=this.fillJsonEventRequest();return this.body=t,this}postEventClickRequest(){const t=this.fillJsonEventRequest();return t.actionId=this.actionId,this.body=t,this}fillJsonEventRequest(){const t={};return e.getDeviceId()&&(t.deviceId=e.getDeviceId()),e.getExternalId()&&(t.externalId=e.getExternalId()),t.inAppId=this.inAppId,t.platform=E.platform,t.version=this.version,t}postEventInAppRequest(){const t={};return t.inAppId=this.inAppId,t.lastVersionId=this.lastVersionId,t.deviceId=this.deviceId,this.eventType&&(t.eventType=this.eventType),t.platform=this.platform,t.clickedButton=this.clickedButton,this.body=t,this}},{BaseRequest:y}=n(872).Core.Api,m=class extends y{constructor(){super(),null!=e.getExternalId()&&(this.customerId=e.getExternalId()),null!=e.getDeviceId()&&(this.deviceId=e.getDeviceId())}setFields(t){this.fields=t}putCustomerFieldRequest(){return this.params=this.createQueryStringCustomerId(),this.body=this.createBodyJson(),this}createQueryStringCustomerId(){return this.PARAM_CUSTOMER_ID+"="+this.customerId}createBodyJson(){let t={};try{t.channel="inapp",this.device&&(t.deviceId=this.device.deviceId),this.customerId&&(t.customerId=this.customerId),this.fields&&(t=this.fields)}catch(t){console.log("Error fieldNames request :"+t)}return t}},{BaseRequest:v}=n(872).Core.Api,{Config:I}=n(872).Core,_=class extends v{constructor(){super()}setInAppId(t){this.inAppId=t}setVersion(t){this.version=t}setJsonForm(t){this.jsonForm=t}postForm(){return this.body=this.createBody(),this}createBody(){const t={};return e.getDeviceId()&&(t.deviceId=e.getDeviceId()),e.getExternalId()&&(t.externalCode=e.getExternalId()),this.jsonForm&&(t.form=this.jsonForm),t.inAppId=this.inAppId,t.platform=I.platform,t.version=this.version,t}},O=class{static sendEventPrint(t){const e=new g;e.setInAppId(t.inAppId),e.setVersion(t.version),C.postEventPrint(e)}static sendEventClick(t){const e=new g;e.setActionId(t.properties.action.actionId),e.setInAppId(t.inAppId),e.setVersion(t.version),C.postEventClick(e)}static sendEventForm(t,e,n){const r=new _;r.setVersion(e),r.setInAppId(t),r.setJsonForm(n),C.postEventForm(r)}static sendEventFormToCustomer(t){const e=new m;e.setFields(t),C.putCustomerField(e)}},{Log:b,ErrorUtils:w,CommonUtils:P}=n(872).Core.Utils,S=class{constructor(){this.MONTH=24192e5}static async inAppWasShown(t,e,n,r,i){const o=new b("[IND]InAppUtils: ");t.schema.code&&this.inAppWasGot(t.schema.code,e,(t=>{P.isFunction(i)&&i(t)}),(()=>{P.isFunction(i)&&i(t)}),((t,e)=>{o.d("inAppWasShown: "+t.inAppId+" with error: "+e.errorMessage).writeLog()}),n,r)}static async inAppWasGot(t,e,n,r,i,o,s){const a=h.searchInApp(t),u=(new Date).getTime();if(null!=a){const t=new d(a);if(u<new Date(t.expiredDate).getTime()){if(t.properties.dismissForever&&t.inAppShow.wasDismissed)P.isFunction(i)&&i(t,w.showError(l,l.INAPP_POPUP_ERROR));else{const e=t.properties.numberOfShows,n=t.inAppShow?t.inAppShow.timesShowed:null,r=t.properties.numberOfClicks,i=t.inAppShow?t.inAppShow.timesClicked:null;if(e>0){if(!(n&&n<e))return void(P.isFunction(o)&&o(t,w.showError(l,l.ErrorCode.INAPP_WAS_SHOWN_MANY_TIMES)));h.addInAppNewShow(t)}if(r>0&&i&&i>=r)return void(P.isFunction(s)&&s(t,w.showError(l,l.ErrorCode.INAPP_WAS_CLICKED_MANY_TIMES)))}return void(P.isFunction(n)&&n(t))}P.isFunction(e)&&e(t,w.showError(l,l.ErrorCode.INAPP_WAS_EXPIRED))}else P.isFunction(r)&&r()}static addNewInApp(t){h.addInApp(t)}static addNewInAppClick(t){t.properties.numberOfClicks&&t.properties.numberOfClicks>0&&h.addInAppNewClick(t),O.sendEventClick(t)}static addNewInApptoDismissForever(t){h.addInAppDismissForever(t)}static isInAppDismissForever(t){const e=h.searchInAppWithInAppId(t.inAppId);return!(null==e||!new d(e).inAppShow.wasDismissed)}static async convertToJSONArray(t){if(t&&""!=t)return await Promise.resolve(t).then((t=>JSON.parse(t)))}static getDate(t){const e=new Date(t);let n=""+(e.getMonth()+1),r=""+e.getDate();const i=e.getFullYear();let o=e.getHours(),s=e.getMinutes(),a=e.getSeconds();return n.length<2&&(n="0"+n),r.length<2&&(r="0"+r),o.length<2&&(o="0"+o),s.length<2&&(s="0"+s),a.length<2&&(a="0"+a),`${i}-${n}-${r} ${o}:${s}:${a}`}},{BaseClient:R}=n(872).Core.Api,{Config:T}=n(872).Core,{ErrorModel:A}=n(872).Core.Models,{CommonUtils:N,ErrorUtils:L}=n(872).Core.Utils,C=new class extends R{constructor(){super(),this.ENDPOINT_INAPP="/inapp",this.URL_BASE=T.client.URL_DEVICE_V2+this.ENDPOINT_INAPP,this.ENDPOINT_CAMPAIGN="/campaign",this.ENDPOINT_CAMPAIGN_TAG=this.ENDPOINT_CAMPAIGN+"/{tag}",this.ENDPOINT_EVENT_INAPP="/event",this.ENDPOINT_EVENT_INAPP_PRINT=this.ENDPOINT_EVENT_INAPP+"/print",this.ENDPOINT_EVENT_INAPP_CLICK=this.ENDPOINT_EVENT_INAPP+"/click",this.ENDPOINT_EVENT_INAPP_FORM=this.ENDPOINT_EVENT_INAPP+"/form",this.ENDPOINT_DEVICE="/device",this.ENDPOINT_DEVICE_TOPICS=this.ENDPOINT_DEVICE+"/topics",this.ENDPOINT_CUSTOMER="/customer",this.ENDPOINT_CUSTOMER_FIELD=this.ENDPOINT_CUSTOMER+"/field",this.isCustomerRequest=!1}async getURL(){if(this.isCustomerRequest)return this.isCustomerRequest=!1,await e.getUrlDeviceApi()||T.client.CUSTOMER_URL_BASE;const t=await e.getUrlInappApi();return t?t+this.ENDPOINT_INAPP:this.URL_BASE}async getCampaignTag(t,e,n){const r=await this.get(this.ENDPOINT_CAMPAIGN_TAG,t.getCampaignTagRequest());if(!r||r instanceof A&&r.data!={})r?N.isFunction(n)&&n(r):N.isFunction(n)&&n(L.showError(l,l.ErrorCode.INAPP_ERROR_CONTENT_MESSAGE));else if(N.isFunction(e)){const t={inAppId:r.data.inAppId,version:r.data.version,showOnce:r.data.showOnce,creationDate:S.getDate((new Date).getTime()),expiredDate:r.data.cacheTtl?S.getDate((new Date).getTime()+60*r.data.cacheTtl*1e3):S.getDate((new Date).getTime()+(new S).MONTH),properties:r.data.properties,renewalTime:r.data.renewalTime,schema:r.data.schema};S.addNewInApp(new d(t)),e(t)}return null}async getInAppTopics(t,e,n){if(s.isAppKeyFormat()){const r=await this.get(this.ENDPOINT_DEVICE_TOPICS,t.getDeviceTopicsRequest());if(!r||r instanceof A)r?N.isFunction(n)&&n(r):N.isFunction(n)&&n();else{const t=r.data.topics;N.isFunction(e)&&e(t)}}else N.isFunction(n)&&n(L.showError(l,l.ErrorCode.INAPP_GENERAL_ERROR));return!0}postEventClick(t){s.isAppKeyFormat()&&this.post(this.ENDPOINT_EVENT_INAPP_CLICK,t.postEventClickRequest())}postEventPrint(t){s.isAppKeyFormat()&&this.post(this.ENDPOINT_EVENT_INAPP_PRINT,t.postEventClickRequest())}postEventForm(t){s.isAppKeyFormat()&&this.post(this.ENDPOINT_EVENT_INAPP_FORM,t.postForm())}putCustomerField(t){s.isAppKeyFormat()&&(this.isCustomerRequest=!0,this.put(this.ENDPOINT_CUSTOMER_FIELD,t.putCustomerFieldRequest()))}},{BaseRequest:D}=n(872).Core.Api,x=class extends D{constructor(){super(),this.PARAM_DEVICE_TYPE="deviceType",this.PARAM_EXTERNAL_CODE="externalCode",this.PARAM_BROWSER_NAME="browerName"}setTag(t){this.tag=t}getCampaignTagRequest(){return this.params=this.createQueryString(),this.pathParams["{tag}"]=this.tag,this}createQueryString(){let t="";return null!=e.getDeviceId()&&(t+=`${this.PARAM_DEVICE_ID}=${e.getDeviceId()}&`),null!=e.getExternalId()&&(t+=`${this.PARAM_EXTERNAL_CODE}=${e.getExternalId()}&`),null!=e.getDeviceType()&&(t+=`${this.PARAM_DEVICE_TYPE}=${e.getDeviceType()}&`),null!=e.getBrowserName()&&(t+=`${this.PARAM_BROWSER_NAME}=${e.getBrowserName()}&`),null!=e.getLatitude()&&(t+=`${this.PARAM_LATITUDE}=${e.getLatitude()}&`),null!=e.getLongitude()&&(t+=`${this.PARAM_LONGITUDE}=${e.getLongitude()}&`),null!=e.getInAppTopics()&&0!==e.getInAppTopics().length&&(t+=`${this.PARAM_TOPICS}=${e.getInAppTopics()}&`),t+=`${this.PARAM_PLATFORM}=webpush`,t}},{BaseRequest:U}=n(872).Core.Api,M=class extends U{constructor(){super()}getDeviceTopicsRequest(){return this.PARAM_DEVICE_ID+"="+e.getDeviceId()}},{CommonUtils:k,ErrorUtils:B}=n(872).Core.Utils,F=class{static saveTopics(t,n,r){if(t instanceof Array){let r=[];if(null!=e.getInAppTopics()&&(r=e.getInAppTopics()),0!==r.length){const e=t.filter((t=>!r.includes(t)));0!==e.length&&r.push(e)}else for(let e=0;e<t.length;e++)r.push(t[e]);e.setInAppTopics(r),k.isFunction(n)&&n(r)}else k.isFunction(r)&&r(B.showError(l,l.ErrorCode.INAPP_INSTANCE_TOPICS_ERROR))}static deleteTopics(t,n,r){if(t instanceof Array){let r=[];if(null!=e.getInAppTopics()&&(r=e.getInAppTopics()),0!==r.length){const n=t.filter((t=>!r.includes(t)));0!==n.length&&e.setInAppTopics(n)}k.isFunction(n)&&n(r)}else k.isFunction(r)&&r(B.showError(l,l.ErrorCode.INAPP_INSTANCE_TOPICS_ERROR))}},V=new class{constructor(){this.sliderScript=' let slideIndex = 1;\n        showSlides(slideIndex);\n        let timeSlide = 10000;\n        \n        const slider = document.querySelector(\'.slider-container-actions\');\n        let sliderTotal = document.getElementsByClassName("slideshow-item").length;\n        let slides = document.getElementsByClassName("slideshow-item");\n        \n        var interval = setInterval(() => {\n            newSlide();\n        }, timeSlide);\n        \n        var startMove = null;\n        \n        slider.addEventListener(\'touchstart\', handleStart, false);\n        slider.addEventListener(\'touchend\', handleEnd, false);\n        slider.addEventListener(\'mousedown\', mouseStart);\n        slider.addEventListener(\'mouseup\', mouseEnd);\n        \n        function mouseStart(evt) {\n            evt.preventDefault();\n            startMove = evt.clientX;\n        }\n        \n        function mouseEnd(evt) {\n            evt.preventDefault();\n            var endMove = evt.clientX;\n            setEndMove(endMove);\n        }\n        \n        function handleStart(evt) {\n            evt.preventDefault();\n            startMove = evt.touches[0].clientX;\n        }\n        function handleEnd(evt) {\n            evt.preventDefault();\n            var endMove = evt.changedTouches[0].pageX;\n            setEndMove(endMove);\n        }\n        \n        function setEndMove(endMove) {\n            if (startMove != null) {\n                if (startMove > endMove) {\n                    slideIndex++;\n                    if (slideIndex > sliderTotal) {\n                        slideIndex = 1;\n                    }\n                } else {\n                    if (slideIndex == 0) {\n                        slideIndex = sliderTotal;\n                    } else {\n                        slideIndex--;\n                    }\n                }\n                showSlides(slideIndex );\n               setNewInterval();\n            } \n        }\n          \n        function plusSlides(n) {\n          showSlides(slideIndex += n);\n          setNewInterval();\n        }\n        \n        function currentSlide(n) {\n          showSlides(slideIndex = n);\n          \n        }\n        \n        function setNewInterval() {\n          clearInterval(interval);\n          interval = setInterval(() => {\n            newSlide();\n          }, timeSlide);\n        }\n        \n        function newSlide(){\n            slideIndex++;\n            if (slideIndex > sliderTotal) {\n                slideIndex = 1;\n            }\n            showSlides(slideIndex);\n        }\n        \n        function showSlides(n) {\n          let i;\n          let slides = document.getElementsByClassName("slideshow-item");\n          let dots = document.getElementsByClassName("dot");\n          if (n > slides.length) {slideIndex = 1;}    \n          if (n < 1) {slideIndex = slides.length;}\n          for (i = 0; i < slides.length; i++) {\n            slides[i].style.display = "none";  \n          }\n          for (i = 0; i < dots.length; i++) {\n            dots[i].className = dots[i].className.replace(" active", "");\n          }\n          slides[slideIndex-1].style.display = "block";  \n          dots[slideIndex-1].className += " active";\n        }\n  ',this.script=" \n          function inAppIndigitallOnClick(action) {\n                 InAppIndigitallInterface.onClick(action);                 \n          }\n          function inAppIndigitallSubmit(formOptions) {\n              const jsonForm = {}\n              const jsonCustomer = {}\n              const form = document.querySelector('[id=\"'+formOptions.formId+'\"]');\n              if (form) {\n                  formOptions.inputs.forEach((el) => {\n                      let value;\n                      if (el.type === 'text' || el.type === 'number') {\n                          if (form && form.querySelector('input[id^=\"'+el.id+'\"]')) {\n                              value = form.querySelector('input[id^=\"'+el.id+'\"]').value;            \n                          }            \n                      }\n                      if (el.type === 'checkbox') {\n                          if (form && form.querySelectorAll('input[id^=\"'+el.id +'\"]')) {\n                              let values = form.querySelectorAll('input[id^=\"'+el.id +'\"]');\n                              var valuesChecked = [];\n                              for (var i = 0; i < values.length; i++) {\n                                  if (values[i].checked) {\n                                      valuesChecked.push(values[i].value);                                \n                                  }                                        \n                              }\n                              value = valuesChecked;\n                          }\n                      }\n                      if (el.type === 'radio') {\n                          if (form && form.querySelectorAll('input[id^=\"'+el.id +'\"]')) {\n                              let values = form.querySelectorAll('input[id^=\"'+el.id +'\"]');\n                              var valuesChecked;\n                              for (var i = 0; i < values.length; i++) {\n                                  if (values[i].checked) {\n                                      valuesChecked = values[i].value;                                \n                                  }                                        \n                              }\n                              value = valuesChecked;\n                          }\n                      }\n                      if (el.type === 'select') {\n                          if (form && form.querySelector('select[id^=\"'+el.id+'\"]')) {\n                              value = form.querySelector('select[id^=\"'+el.id+'\"]').value;            \n                          }\n                      }       \n                      if (value) jsonForm[el.id] = value;\n                      if (el.sendToCustomer) jsonCustomer[el.id] = value;                    \n                  })\n              }\n              InAppIndigitallInterface.submit(JSON.stringify(formOptions), JSON.stringify(jsonForm), JSON.stringify(jsonCustomer));\n          }\n          ",this.htmlTest="\n          <!DOCTYPE html>\n          <html lang=\"en\" dir=\"ltr\">\n            <head>\n              <meta charset=\"utf-8\" />\n              <meta name=\"viewport\" content=\"width=device-width\" />\n              <title>guille test</title>\n              <style>\n                html,\n                body {\n                  margin: 0;\n                  padding: 0;\n                  height: 100%;\n                  width: 100%;\n                }\n                body p:first-child {\n                  margin: 0;\n                }\n              </style>\n            </head>\n            <body>\n              \n      <!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n        <html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"en\" xml:lang=\"en\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\">\n          <head>\n            <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n            \x3c!--[if !mso]>\x3c!--\x3e\n            \x3c!--[if (gte mso 9)|(IE)]>\x3c!--\x3e\n            <link href=\"https://fonts.googleapis.com/css2?family=EB+Garamond&family=Merriweather&family=Montserrat&family=Open+Sans&family=Oswald&family=Playfair+Display&family=Raleway&family=Roboto&family=Roboto+Slab&family=Source+Sans+Pro&display=swap\" rel=\"stylesheet\">\n            \x3c!--<![endif]--\x3e\n            <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n            \x3c!--<![endif]--\x3e\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <link href=\"http://fonts.cdnfonts.com/css/arial\" rel=\"stylesheet\">\n            <link href=\"http://fonts.cdnfonts.com/css/courier-new\" rel=\"stylesheet\">\n            <link href=\"http://fonts.cdnfonts.com/css/georgia-2\" rel=\"stylesheet\">\n            <link href=\"http://fonts.cdnfonts.com/css/trebuchet-ms-2\" rel=\"stylesheet\">\n            <link href=\"http://fonts.cdnfonts.com/css/verdana-pro-cond\" rel=\"stylesheet\">\n                    \n            <link href=\"https://fonts.googleapis.com/css2?family=EB+Garamond&family=Merriweather&family=Montserrat&family=Open+Sans&family=Oswald&family=Playfair+Display&family=Raleway&family=Roboto&family=Roboto+Slab&family=Source+Sans+Pro&display=swap\" rel=\"stylesheet\">\n            <title>InApp Sample</title>\n            \n            <style type=\"text/css\">\n              html {\n              width: 100%;\n              height: 100%;\n              }\n              @font-face {\n                font-family: 'Merriweather';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/merriweather/v28/u-440qyriQwlOrhSvowK_l5OeA.woff) format('woff');\n              }\n              @font-face {\n                font-family: 'Montserrat';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/montserrat/v23/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCtr6Ew9.woff) format('woff');\n              }\n              @font-face {\n                font-family: 'Open Sans';\n                font-style: normal;\n                font-weight: 400;\n                font-stretch: normal;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/opensans/v28/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0C4k.woff) format('woff');\n              }\n              @font-face {\n                font-family: 'Oswald';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/oswald/v47/TK3_WkUHHAIjg75cFRf3bXL8LICs1_FvgUI.woff) format('woff');\n              }\n              @font-face {\n                font-family: 'Playfair Display';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/playfairdisplay/v28/nuFvD-vYSZviVYUb_rj3ij__anPXJzDwcbmjWBN2PKdFvUDT.woff) format('woff');\n              }\n              @font-face {\n                font-family: 'Raleway';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/raleway/v26/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvaooCM.woff) format('woff');\n              }\n              @font-face {\n                font-family: 'Roboto';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Me5g.woff) format('woff');\n              }\n              @font-face {\n                font-family: 'Roboto Slab';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/robotoslab/v22/BngbUXZYTXPIvIBgJJSb6s3BzlRRfKOFbvjojISWaw.woff) format('woff');\n              }\n              @font-face {\n                font-family: 'Source Sans Pro';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/sourcesanspro/v19/6xK3dSBYKcSV-LCoeQqfX1RYOo3aPA.woff) format('woff');\n              }\n              @font-face {\n                font-family: 'EB Garamond';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/ebgaramond/v24/SlGDmQSNjdsmc35JDF1K5E55YMjF_7DPuGi-6_RUAA.woff) format('woff');\n              }\n              /* latin-ext */\n              @font-face {\n                font-family: 'Merriweather';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/merriweather/v28/u-440qyriQwlOrhSvowK_l5-ciZMZ-Y.woff2) format('woff2');\n                unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;\n              }\n              /* latin */\n              @font-face {\n                font-family: 'Merriweather';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/merriweather/v28/u-440qyriQwlOrhSvowK_l5-fCZM.woff2) format('woff2');\n                unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n              }\n              /* latin-ext */\n              @font-face {\n                font-family: 'Montserrat';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/montserrat/v23/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCtr6Hw3aXpsog.woff2) format('woff2');\n                unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;\n              }\n              /* latin */\n              @font-face {\n                font-family: 'Montserrat';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/montserrat/v23/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCtr6Hw5aXo.woff2) format('woff2');\n                unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n              }\n              /* latin-ext */\n              @font-face {\n                font-family: 'Open Sans';\n                font-style: normal;\n                font-weight: 400;\n                font-stretch: 100%;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/opensans/v28/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4uaVIGxA.woff2) format('woff2');\n                unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;\n              }\n              /* latin */\n              @font-face {\n                font-family: 'Open Sans';\n                font-style: normal;\n                font-weight: 400;\n                font-stretch: 100%;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/opensans/v28/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4gaVI.woff2) format('woff2');\n                unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n              }\n              /* latin-ext */\n              @font-face {\n                font-family: 'Oswald';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/oswald/v47/TK3_WkUHHAIjg75cFRf3bXL8LICs1_FvsUhiZTaR.woff2) format('woff2');\n                unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;\n              }\n              /* latin */\n              @font-face {\n                font-family: 'Oswald';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/oswald/v47/TK3_WkUHHAIjg75cFRf3bXL8LICs1_FvsUZiZQ.woff2) format('woff2');\n                unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n              }\n              /* latin-ext */\n              @font-face {\n                font-family: 'Playfair Display';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/playfairdisplay/v28/nuFvD-vYSZviVYUb_rj3ij__anPXJzDwcbmjWBN2PKdFvXDZbtPY_Q.woff2) format('woff2');\n                unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;\n              }\n              /* latin */\n              @font-face {\n                font-family: 'Playfair Display';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/playfairdisplay/v28/nuFvD-vYSZviVYUb_rj3ij__anPXJzDwcbmjWBN2PKdFvXDXbtM.woff2) format('woff2');\n                unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n              }\n              /* latin-ext */\n              @font-face {\n                font-family: 'Raleway';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/raleway/v26/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvaorCGPrEHJA.woff2) format('woff2');\n                unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;\n              }\n              /* latin */\n              @font-face {\n                font-family: 'Raleway';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/raleway/v26/1Ptxg8zYS_SKggPN4iEgvnHyvveLxVvaorCIPrE.woff2) format('woff2');\n                unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n              }\n              /* latin-ext */\n              @font-face {\n                font-family: 'Roboto';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7GxKOzY.woff2) format('woff2');\n                unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;\n              }\n              /* latin */\n              @font-face {\n                font-family: 'Roboto';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4mxK.woff2) format('woff2');\n                unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n              }\n              /* latin-ext */\n              @font-face {\n                font-family: 'Roboto Slab';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/robotoslab/v22/BngbUXZYTXPIvIBgJJSb6s3BzlRRfKOFbvjojISmYWRjRdE.woff2) format('woff2');\n                unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;\n              }\n              /* latin */\n              @font-face {\n                font-family: 'Roboto Slab';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/robotoslab/v22/BngbUXZYTXPIvIBgJJSb6s3BzlRRfKOFbvjojISmb2Rj.woff2) format('woff2');\n                unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n              }\n              /* latin-ext */\n              @font-face {\n                font-family: 'Source Sans Pro';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/sourcesanspro/v19/6xK3dSBYKcSV-LCoeQqfX1RYOo3qNq7lqDY.woff2) format('woff2');\n                unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;\n              }\n              /* latin */\n              @font-face {\n                font-family: 'Source Sans Pro';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/sourcesanspro/v19/6xK3dSBYKcSV-LCoeQqfX1RYOo3qOK7l.woff2) format('woff2');\n                unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n              }\n              /* latin-ext */\n              @font-face {\n                font-family: 'EB Garamond';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/ebgaramond/v24/SlGDmQSNjdsmc35JDF1K5E55YMjF_7DPuGi-6_RkCo9_S6w.woff2) format('woff2');\n                unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;\n              }\n              /* latin */\n              @font-face {\n                font-family: 'EB Garamond';\n                font-style: normal;\n                font-weight: 400;\n                font-display: swap;\n                src: url(https://fonts.gstatic.com/s/ebgaramond/v24/SlGDmQSNjdsmc35JDF1K5E55YMjF_7DPuGi-6_RkBI9_.woff2) format('woff2');\n                unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n              }\n      \n            </style>\n            <style>\n              .slideshow-item {\n                cursor: grabbing;\n                scroll-snap-align: start;\n                display: none; \n                scroll-snap-type: x mandatory;\n                scroll-behavior: smooth;\n                -webkit-overflow-scrolling: touch; /* For mobile */\n                -ms-overflow-style: none; /* For hide scrollbar */\n                scrollbar-width: none; /* For hide scrollbar */\n              }\n              .slideshow-item-preview {\n                cursor: grabbing;\n                scroll-snap-align: start;\n                display: block; \n                scroll-snap-type: x mandatory;\n                scroll-behavior: smooth;\n                -webkit-overflow-scrolling: touch; /* For mobile */\n                -ms-overflow-style: none; /* For hide scrollbar */\n                scrollbar-width: none; /* For hide scrollbar */\n              }\n              img {vertical-align: middle;}\n              \n              /* Slideshow container */\n              .slideshow-container {\n              /*   max-width: 1000px; */\n                position: relative;\n                margin: auto;\n                -webkit-overflow-scrolling: touch; /* For mobile */\n              }\n              \n              /* Next & previous buttons */\n              .prev, .next {\n                cursor: pointer;\n                position: absolute;\n                top: 50%;\n                width: auto;\n                padding: 16px;\n                margin-top: -22px;\n                color: white;\n                font-weight: bold;\n                font-size: 18px;\n                transition: 0.6s ease;\n                border-radius: 0 3px 3px 0;\n                user-select: none;\n              }\n              \n              /* Position the \"next button\" to the right */\n              .next {\n                right: 0;\n                border-radius: 3px 0 0 3px;\n              }\n              \n              /* On hover, add a black background color with a little bit see-through */\n              .prev:hover, .next:hover {\n                background-color: rgba(0,0,0,0.8);\n              }\n              \n              .points {\n                padding: 8px 12px;\n                position: absolute;\n                bottom: 8px;\n                text-align: center;\n                width:100%;\n              }\n              \n              /* The dots/bullets/indicators */\n              .dot {\n                cursor: pointer;\n                height: 15px;\n                width: 15px;\n                margin: 0 2px;\n                background-color: #bbb;\n                border-radius: 50%;\n                display: inline-block;\n                transition: background-color 0.6s ease;\n              }\n              \n              .active, .dot:hover {\n                background-color: #717171;\n              }\n              \n              /* On smaller screens, decrease text size */\n              @media only screen and (max-width: 300px) {\n                .prev, .next,.text {font-size: 11px}\n              }\n          </style>\n            \n          </head>\n          <body style=\"margin:0; height: 100%; width: 100%;\">\n            <div style=\"\n                background-color: rgba(244, 244, 244, 1);\n                width: 100%;\n                height: 100%;\n                margin: 0 auto;\n              \">\n              \n            <div style=\"\n          display: flex;\n          flexDirection: row;\n          box-sizing: border-box;\n          padding: 0px 0px 0px 0px ;\n          margin: 0px 0px 0px 0px ;\n          background-color: rgba(244, 244, 244, 0);\n          border: 0px solid rgba(244, 244, 244, 0);\n          width: 100%;\">\n              \n                <div style=\"\n          width: 100%;\n        \">\n                  \n                        <div style=\"\n                            margin: 0px 0px 0px 0px ;\n                            padding: 15px 15px 15px 15px ;\n                            background-color: rgba(244, 244, 244, 0);\n                            text-align: left;\n                            font-family: 'Roboto';\n                          \">\n                          \n          <form id=\"5kZSrg6xbKyX\" class=\"form-style-1\">\n            \n        <style type=\"text/css\">\n          .form-style-1 {\n          }\n          .form-style-1 li {\n            padding: 0;\n            display: block;\n            list-style: none;\n            margin: 10px 0 0 0;\n          }\n          .form-style-1 label{\n            margin:0 0 3px 0;\n            padding:0px;\n            display:block;\n            font-weight: bold;\n          }\n          .form-style-1 input[type=text], \n          .form-style-1 input[type=date],\n          .form-style-1 input[type=datetime],\n          .form-style-1 input[type=number],\n          .form-style-1 input[type=search],\n          .form-style-1 input[type=time],\n          .form-style-1 input[type=url],\n          .form-style-1 input[type=email],\n          textarea, \n          select{\n            box-sizing: border-box;\n            -webkit-box-sizing: border-box;\n            -moz-box-sizing: border-box;\n            border:1px solid #BEBEBE;\n            padding: 7px;\n            margin:0px;\n            -webkit-transition: all 0.30s ease-in-out;\n            -moz-transition: all 0.30s ease-in-out;\n            -ms-transition: all 0.30s ease-in-out;\n            -o-transition: all 0.30s ease-in-out;\n            outline: none;\n          }\n          .form-style-1 input[type=text]:focus, \n          .form-style-1 input[type=date]:focus,\n          .form-style-1 input[type=datetime]:focus,\n          .form-style-1 input[type=number]:focus,\n          .form-style-1 input[type=search]:focus,\n          .form-style-1 input[type=time]:focus,\n          .form-style-1 input[type=url]:focus,\n          .form-style-1 input[type=email]:focus,\n          .form-style-1 textarea:focus, \n          .form-style-1 select:focus{\n            -moz-box-shadow: 0 0 8px #88D5E9;\n            -webkit-box-shadow: 0 0 8px #88D5E9;\n            box-shadow: 0 0 8px #88D5E9;\n            border: 1px solid #88D5E9;\n          }\n          .form-style-1 .field-divided{\n            width: 49%;\n          }\n      \n          .form-style-1 .field-long{\n            width: 100%;\n          }\n          .form-style-1 .field-select{\n            width: 100%;\n          }\n          .form-style-1 .field-textarea{\n            height: 100px;\n          }\n          \n          .form-style-1 input[type=submit]:hover, .form-style-1 input[type=button]:hover{\n            background: #4691A4;\n            box-shadow:none;\n            -moz-box-shadow:none;\n            -webkit-box-shadow:none;\n          }\n          .form-style-1 input[type=radio]{\n            transform: scale(1.2);\n          }\n          .form-style-1 input[type=checkbox]{\n            transform: scale(1.2);\n          }\n          .form-style-1 .required{\n            color:red;\n          }\n          </style>\n        \n            \n          <div style=\"margin-top: 10px;\">\n            <label>\n              Escribe algo\n              <span class=\"required\">*</span>\n            </label>\n            <input type=\"text\" name=\"algo\" id=\"algo\" required=\"true\" sendToCustomer=\"true\" style=\"width: 100%;\n        padding: 12px 20px;\n        margin: 8px 0;\n        display: inline-block;\n        border: 1px solid #ccc;\n        border-radius: 4px;\n        box-sizing: border-box;\">\n          </div><div style=\"margin-top: 10px;\">\n          <label style=\"\n          margin:0 0 3px 0;\n          padding:0px;\n          display:block;\n        \">\n            Selecciona algo\n            \n          </label>\n          <select style=\"width: 100%;\n          padding: 12px 20px;\n          margin: 8px 0;\n          display: inline-block;\n          border: 1px solid #ccc;\n          border-radius: 4px;\n          box-sizing: border-box;\" id=\"selector\" required=\"undefined\" sendToCustomer=\"true\">\n            <option value=\"algo\">Algo</option><option value=\"masalgo\">Mas algo</option><option value=\"variosalgos\">Varios algos</option>\n          </select>\n        </div>\n          <div style=\"\n          margin-top: 10px;\n        \">\n            <label style=\"\n          margin-bottom: 10px;\n        \">\n              ¿Cuál de las dos opciones te gusta más?\n              \n            </label>\n            \n                <div style=\"margin-bottom: 5px; display: flex; flex-direction: row; align-items: baseline; gap:0px;\">\n                  <input style=\"margin-right: 10px;\" type=\"radio\" id=\"radio0\" name=\"radio\" value=\"opcion1\"><label style=\"font-weight: 100; margin-right: 10px;\" for=\"radio0\">Opcion 1</label>\n                </div>\n              \n                <div style=\"margin-bottom: 5px; display: flex; flex-direction: row; align-items: baseline; gap:0px;\">\n                  <input style=\"margin-right: 10px;\" type=\"radio\" id=\"radio1\" name=\"radio\" value=\"opcion2\"><label style=\"font-weight: 100; margin-right: 10px;\" for=\"radio1\">Opcion 2</label>\n                </div>\n              \n          </div>\n        \n        <div style=\"margin-top: 10px;\">\n          <label style=\"\n          margin-bottom: 10px;\n        \">\n            Marca las casillas que quieras\n            \n          </label>\n          \n              <div style=\"display: flex; flex-direction: row; margin-bottom: 5px; align-items: flex-start;\">\n                <input style=\"margin-right: 10px;\" type=\"checkbox\" id=\"casilla0\" name=\"casilla\" value=\"casilla1\"><label style=\"font-weight: 100; margin-right: 10px;\" for=\"casilla0\">Casilla 1</label>\n              </div>\n            \n              <div style=\"display: flex; flex-direction: row; margin-bottom: 5px; align-items: flex-start;\">\n                <input style=\"margin-right: 10px;\" type=\"checkbox\" id=\"casilla1\" name=\"casilla\" value=\"casilla2\"><label style=\"font-weight: 100; margin-right: 10px;\" for=\"casilla1\">Casilla 2</label>\n              </div>\n            \n        </div>\n            \n          <tr style=\"\n              display: block;\n              text-align: left; \">\n            <td style=\"\n                display: inline-block;\n                width: auto;\n                padding: 15px 15px 15px 15px ;\n                margin: 0px 0px 0px 0px ;\n                background-color: rgba(244, 244, 244, 0);\">\n              <div target=\"_blank\" rel=\"noreferrer\" onclick=\"InAppIndigitall.submit({'schemaId':217,'inAppId':22,'inputs':[{'type':'text','label':'Escribe algo','name':'algo','subtype':'text','required':true,'sendToCustomer':true,'id':'algo'},{'type':'select','label':'Selecciona algo','name':'selector','options':[{'name':'Algo','value':'algo'},{'name':'Mas algo','value':'masalgo'},{'name':'Varios algos','value':'variosalgos'}],'sendToCustomer':true,'id':'selector'},{'type':'radio','label':'¿Cuál de las dos opciones te gusta más?','name':'radio','options':[{'name':'Opcion 1','value':'opcion1'},{'name':'Opcion 2','value':'opcion2'}],'labelPosition':'right','id':'radio'},{'type':'checkbox','label':'Marca las casillas que quieras','options':[{'name':'Casilla 1','value':'casilla1'},{'name':'Casilla 2','value':'casilla2'}],'subtype':'right','name':'casilla','id':'casilla'}],'formId':'5kZSrg6xbKyX'})\" style=\"text-decoration: none; width: auto; cursor: pointer;\">\n                <div style=\"\n                    padding: 8px 16px 8px 16px;\n                    width: auto;\n                    display: inline-block;\n                    text-align: left;\n                    background-color: rgba(200, 200, 200, 1);\n                    border-radius: 3px 3px 3px 3px;\n                    border: 0px solid transparent;\n                    box-sizing: border-box;\n                    margin-top: 15px;\">\n                  <span style=\"text-align: center; \"><span style=\"font-size: 16px\"><span style=\"font-family: Roboto, sans-serif !important\"><span style=\"color: #555555\"><span style=\"background-color: transparent\"><span style=\"letter-spacing: 0px;\">Botón</span></span></span></span></span></span>\n                </div>\n              </div>\n            </td>\n          </tr>\n        \n            </form>\n            \n                        </div>\n                      \n                </div>\n            </div>\n            </div>\n          </body>\n        </html>\n              <script>\n                // Created event\n                var event = document.createEvent('Event');\n            \n                /* defined event 'click'.*/\n                event.initEvent('click', true, true);\n            \n                // to assign event click.\n                document.addEventListener('click', function (e) {\n                  window.parent.document.dispatchEvent(new CustomEvent('indigitall_on_click_inapp', {detail: {\n                    inAppId: 217,\n                    lastVersionId: 431,\n                    clickedButton: 'content',\n                    action: {\n                        type: 'url',\n                        url: 'https://indigitall.com'\n                    }\n                  }}));\n                }, false);\n              <\/script>\n            </body>\n          </html>\n           \n         "}},j=Object.freeze({TEXT:"text",NUMBER:"number",RADIO:"radio",CHECKBOX:"checkbox",SELECT:"select"}),Y=class{constructor(t){if(t.id&&(this.id=t.id),t.name&&(this.name=t.name),t.type)switch(t.type){case"text":this.type=j.TEXT;break;case"checkbox":this.type=j.CHECKBOX;break;case"number":this.type=j.NUMBER;break;case"radio":this.type=j.RADIO;break;case"select":this.type=j.SELECT}t.required&&(this.required=t.required),t.sendToCustomer&&(this.sendToCustomer=t.sendToCustomer)}},{ErrorUtils:G}=n(872).Core.Utils,K=class{static checkFieldsForm(t,e,n){const r=[];if(null!=e&&t.inputs&&t.inputs.length>0)for(let n=0;n<t.inputs.length;n++){const i=this.checkInputType(t.inputs[n],e);null!=i&&r.push(i)}if(r.length>0)return r;null!=e&&O.sendEventForm(t.inAppId,t.inappVersion,e),null!=n&&O.sendEventFormToCustomer(n)}static checkInputType(t,e){if(null!=t.id)switch(t.type){case j.TEXT:if(t.required){if(!e[t.id])return G.showError(l,2121,t.id);if(!e[t.id]instanceof String)return G.showError(l,2120,`The field ${t.id} is not text`)}break;case j.NUMBER:if(t.required){if(!e[t.id])return G.showError(l,2121,t.id);if(!e[t.id]instanceof String){if(!parseInt(e[t.id]))return G.showError(l,2120,`The field ${t.id} is not number`)}else if(!e[t.id]instanceof int)return G.showError(l,2120,`The field ${t.id} is not number`)}break;default:if(t.required&&e[t.id]&&""==e[t.id])return G.showError(l,2121,t.id)}return null}static editingFormHtml(t){return t.replace("InAppIndigitall.onClick","inAppIndigitallOnClick").replace("InAppIndigitall.submit","inAppIndigitallSubmit")}},{EventType:q}=n(872).Core.Models,{Log:W,ErrorUtils:J,CommonUtils:X,CorePermissions:H,LogLevel:Q}=n(872).Core.Utils,z="[IND]InAppIndigitall: ";class Z{constructor(){this.LogLevel=Q}static async init(t){let n=new W(z);null!=t.appKey&&e.setAppKey(t.appKey),t.urlInAppApi&&e.setUrlInappApi(t.urlInAppApi),t.logLevel&&(e.setLogLevel(t.logLevel),n=new W(z)),await H.getPermissions(),navigator.geolocation.getCurrentPosition((t=>{e.setLatitude(t.coords.latitude),e.setLongitude(t.coords.longitude)}),(t=>{n.e("error "+t).writeLog(),e.getPermissionLocation()||e.getPermissionLocation()==q.EVENT_TYPE_REJECT||e.setPermissionLocation(q.EVENT_TYPE_REJECT)}))}static async showInApp(t,n,r,i){const o={appKey:e.getAppKey(),urlInAppApi:"https://device-api.indigitall.com/v2",requestLocation:!0,logLevel:Q.DEBUG,inAppCode:t,viewId:n};this.showInAppWithConfig(o,null,null,null,null,null,null,r,i,null,null)}static async showInAppWithConfig(t,e,n,r,i,o,a,u,c,h,f){await this.init(t),s.isAppKeyFormat()?S.inAppWasGot(t.inAppCode,n,(async n=>{n&&n.properties&&this.createInApp(n,t.viewId,a,u,c,e,h,f)}),(()=>{this.drawInApp(t.inAppCode,t.viewId,e,a,u,c,h,f)}),o,r,i):X.isFunction(c)&&c(J.showError(l,l.ErrorCode.BAD_REQUEST_SERVER_ERROR))}static showMultipleInApp(t,n,r,i){const o={appKey:e.getAppKey(),urlInAppApi:"https://device-api.indigitall.com/v2",requestLocation:!0,logLevel:Q.DEBUG,inAppCodeList:t,divList:n};this.showMultipleInAppWithConfig(o,null,null,null,null,null,null,r,i,null,null)}static async showMultipleInAppWithConfig(t,e,n,r,i,o,a,u,c,h,f){if(await this.init(t),s.isAppKeyFormat()){if(t.inAppCodeList.length==t.divList.length&&t.inAppCodeList.length>0)for(var d=0;d<t.inAppCodeList.length;d++)S.inAppWasGot(t.inAppCodeList[d],n,(async n=>{n&&n.properties&&this.createInApp(n,t.divList[d],a,u,c,e,h,f)}),(()=>{Z.drawInApp(t.inAppCodeList[d],t.divList[d],e,a,u,c,h,f)}),o,r,i)}else X.isFunction(c)&&c(J.showError(l,l.ErrorCode.BAD_REQUEST_SERVER_ERROR))}static async drawInApp(t,e,n,r,i,o,s,a){this.getInApp(t,(async t=>{t&&t.properties&&this.createInApp(t,e,r,i,o,n,s,a)}),o)}static async createInApp(t,e,n,r,i,o,s,a){if(t&&t.properties&&t.properties.contentUrl)try{const i=document.getElementById(e);i.style.position="relative",i.style.overflow="hidden";const u=await fetch(t.properties.contentUrl),c=await u.text();let l=c;null!=t.customData&&Object.keys(t.customData).forEach((function(e){l=c.replaceAll(e,t.customData[e])})),t.version&&(l=l.replaceAll("'inappVersion':'{{version}}'","'inappVersion':"+t.version));const h=document.createElement("script");h.innerHTML=V.script,document.head.appendChild(h);const f=K.editingFormHtml(l);if(i.innerHTML=f,self.addEventListener("didClicked",(function(t){n&&n()})),self.addEventListener("didFormError",(function(e){s&&s(t,e.detail.errorList)})),self.addEventListener("didFormSubmit",(function(e){a&&a(t)})),t.properties.showTime){let e=0;const n=setInterval((function(){e++,e==parseInt(t.properties.showTime)&&(i.style.display="none",clearInterval(n),X.isFunction(o)&&o(t,i,1e3*t.properties.showTime))}),1e3)}if(t.properties.layout&&t.properties.layout.borderRadius){const e=`${parseInt(t.properties.layout.borderRadius)}px`;i.style.borderRadius=e}X.isFunction(r)&&(r(t,i),O.sendEventPrint(t))}catch(t){X.isFunction(i)&&i(t)}}static topicsList(t,e){return C.getInAppTopics(new M,t,e),!0}static async topicsSubscribe(t,e,n){F.saveTopics(t,e,n)}static async topicsUnsubscribe(t,e,n){F.deleteTopics(t,e,n)}static inAppGet(t,e,n){this.getInApp(t,e,n)}static getInApp(t,e,n){if(s.isAppKeyFormat()){const r=new x;r.setTag(t),C.getCampaignTag(r,e,n)}else X.isFunction(n)&&n(J.showError(l,l.ErrorCode.BAD_REQUEST_SERVER_ERROR))}static addNewInAppToDismissForever(t){S.addNewInApptoDismissForever(t)}static async isInAppDismissForever(t){S.isInAppDismissForever(t)}static async inAppWasShown(t,e,n,r,i){S.inAppWasShown(t,e,n,r,i)}static async downloadHTML(t){const e=await fetch(t,{method:"GET"});console.log(e)}}const $=Z;window.indigitall||(window.indigitall={}),window.indigitall.InApp=Z,window.indigitall.InApp.Utils=S,window.indigitall.LogLevel=Q,window.InAppIndigitallInterface=class{static onClick(t){if(t){const e=JSON.parse(t);let n;e.inAppId&&(n=e.inAppId),e.inappId&&(n=e.inappId);const r=h.searchInAppWithInAppId(n);if(r&&e.action){const t=new d(r),n=new f(e.action);if(t.properties.setAction(n),n.type==n.URL&&window.open(n.url),t){S.addNewInAppClick(t);const e=new CustomEvent("didClicked",{detail:{},bubbles:!0,cancelable:!0,composed:!1});self.dispatchEvent(e)}}else console.log(`InApp ${e.schema} not found`)}else console.log("InApp action is empty")}static submit(t,e,n){if(null!=t){const r=new class{constructor(t){if(t.inAppId&&(this.inAppId=t.inAppId),t.formId&&(this.formId=t.formId),t.inappVersion&&(this.inappVersion=t.inappVersion),t.inputs&&Array.isArray(t.inputs)){this.inputs=[];for(let e=0;e<t.inputs.length;e++)this.inputs.push(new Y(t.inputs[e]))}}}(JSON.parse(t));if(null!=e){const t=K.checkFieldsForm(r,JSON.parse(e),JSON.parse(n));if(t&&t.length>0){const e=new CustomEvent("didFormError",{detail:{errorList:t},bubbles:!0,cancelable:!0,composed:!1});self.dispatchEvent(e)}else{const t=new CustomEvent("didFormSubmit",{detail:{},bubbles:!0,cancelable:!0,composed:!1});self.dispatchEvent(t)}}}}}})(),r})(),t.exports=e()},396:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}Object.defineProperty(e,"__esModule",{value:!0});var i={};Object.defineProperty(e,"default",{enumerable:!0,get:function(){return o.default}});var o=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var n=s(e);if(n&&n.has(t))return n.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var u=o?Object.getOwnPropertyDescriptor(t,a):null;u&&(u.get||u.set)?Object.defineProperty(i,a,u):i[a]=t[a]}i.default=t,n&&n.set(t,i);return i}(n(899));function s(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(s=function(t){return t?n:e})(t)}Object.keys(o).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(i,t)||t in e&&e[t]===o[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return o[t]}}))}))},248:t=>{"use strict";t.exports=JSON.parse('{"_from":"indigitall-web-core@4.1.1","_id":"indigitall-web-core@4.1.1","_inBundle":false,"_integrity":"sha512-Il5ljK7XeabRPG4szoYtZglGZ75LeQ2YYnUO8Rk8QZu+sim0eNUniYixMgpMzr+eC4rYPfMv4XiVgLO/o5bl3g==","_location":"/indigitall-web-core","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"indigitall-web-core@4.1.1","name":"indigitall-web-core","escapedName":"indigitall-web-core","rawSpec":"4.1.1","saveSpec":null,"fetchSpec":"4.1.1"},"_requiredBy":["#USER","/","/indigitall-web-inapp"],"_resolved":"https://registry.npmjs.org/indigitall-web-core/-/indigitall-web-core-4.1.1.tgz","_shasum":"3128221c365e132f9db788724a7ab241411e3b6c","_spec":"indigitall-web-core@4.1.1","_where":"/home/circleci/webpush/sdk","author":{"name":"Smart2me S.L."},"bundleDependencies":false,"deprecated":false,"description":"indigitall web core","devDependencies":{"@babel/preset-env":"^7.18.10","babel-loader":"^8.2.5","filemanager-webpack-plugin":"^7.0.0","idempotent-babel-polyfill":"^7.4.4","script-loader":"^0.7.2","webpack":"^5.74.0","webpack-bundle-analyzer":"^4.6.1","webpack-cli":"^4.10.0"},"homepage":"https://indigitall.com","main":"index.js","name":"indigitall-web-core","scripts":{"build":"webpack --config webpack.config.js --mode=production","build-dev":"webpack --config webpack.config.js --watch --mode=development","delete-node-modules":"rm -rf node_modules/ && rm -f package-lock.json","install-core":"npm install && npm run build","public":"ws --directory ./public --port 80 --log.format dev","test":"echo \'There are not tests\'"},"version":"4.1.1"}')}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return(()=>{"use strict";n.r(r);var t=n(396),e=n.n(t);const{Repository:o}=n(872).Core;const s=new class extends o{constructor(){super(),this.AUTH_TOKEN=this.REPOSITORY+".AUTH_TOKEN",this.INBOX_AUTH_MODE=this.REPOSITORY+".INBOX_AUTH_MODE",this.URL_INBOX_API=this.REPOSITORY+".URL_INBOX_API"}async setDeviceId(t){this.setStorage(this.DEVICE_ID,t)}getDeviceId(){return this.getStorage(this.DEVICE_ID)}setAuthToken(t){this.setStorage(this.AUTH_TOKEN,t)}getAuthToken(){return this.getStorage(this.AUTH_TOKEN)}setInboxAuthMode(t){this.setStorage(this.INBOX_AUTH_MODE,t)}getInboxAuthMode(){return this.getStorage(this.INBOX_AUTH_MODE)}async getUrlInboxApi(){return this.getStorage(this.URL_INBOX_API)}async setUrlInboxApi(t){this.setStorage(this.URL_INBOX_API,t)}},{BaseClient:a}=n(872).Core.Api,{Config:u}=n(872).Core,{ErrorModel:c}=n(872).Core.Models,{CommonUtils:l}=n(872).Core.Utils;const h=new class extends a{constructor(){super(),this.URL_BASE=u.client.INBOX_URL_BASE,this.ENDPOINT_INBOX_NOTIFICATIONS="/notification",this.ENDPOINT_INBOX_NOTIFICATIONS_WITH_SENDINGID=this.ENDPOINT_INBOX_NOTIFICATIONS+"/{sendingId}",this.ENDPOINT_INBOX_COUNTER="/counters",this.ENDPOINT_INBOX_AUTH="/auth/webhook"}async getURL(){const t=await s.getUrlInboxApi();return t||this.URL_BASE}async postInboxAuth(t,e,n){const r=await this.post(this.ENDPOINT_INBOX_AUTH,t.postInboxAuth());if(!r||r instanceof c||!r.data)r?l.isFunction(n)&&n(r):l.isFunction(n)&&n();else{const t=r.data.token;s.setAuthToken(t),l.isFunction(e)&&e(r)}return!0}async getInbox(t,e,n){const r=await this.get(this.ENDPOINT_INBOX_NOTIFICATIONS,t.getInboxPushRequest());return this.getInboxResponseStatus(r,e,n),!0}async putInboxPush(t,e,n){const r=await this.put(this.ENDPOINT_INBOX_NOTIFICATIONS,t.putInboxPushRequest());return this.getInboxResponseEdit(r,e,n),!0}async getInboxPushWithSendingId(t,e,n,r){const i=await this.get(this.ENDPOINT_INBOX_NOTIFICATIONS_WITH_SENDINGID,t.getInboxPushRequestWithSendingId());return this.getNotificationResponseStatus(i,e,n,r),!0}async putInboxPushWithSendingId(t,e,n,r){const i=await this.put(this.ENDPOINT_INBOX_NOTIFICATIONS_WITH_SENDINGID,t.putInboxWithSendingId());return this.getNotificationResponseStatus(i,e,n,r),!0}async getInboxCounter(t,e,n){const r=await this.get(this.ENDPOINT_INBOX_COUNTER,t.getCounter());this.getCounterStatus(r,e,n)}async getInboxResponseStatus(t,e,n){if(t&&!(t instanceof c)&&t.statusCode>=200&&t.statusCode<300){const n=new x(t.data);l.isFunction(e)&&e(n)}else t?l.isFunction(n)&&n(t):l.isFunction(n)&&n()}async getInboxResponseEdit(t,e,n){t&&!(t instanceof c)&&t.statusCode>=200&&t.statusCode<300?l.isFunction(e)&&e():t?l.isFunction(n)&&n(t):l.isFunction(n)&&n()}getNotifications(t,e){const n=[];for(let r=0;r<t.length;r++){null!=t[r].sentAt&&null!=e&&t[r].sentAt<e&&(read=!0);const i=new InboxNotification(t[r],e);n.push(i)}return n}async getNotificationResponseStatus(t,e,n,r){if(t&&!(t instanceof c)&&t.statusCode>=200&&t.statusCode<300){const t=new InboxNotification(notifications[i],e);l.isFunction(n)&&n(t)}else t?l.isFunction(r)&&r(t):l.isFunction(r)&&r()}async getCounterStatus(t,e,n){if(t&&!(t instanceof c)&&t.statusCode>=200&&t.statusCode<300){const n={click:t.data.click,sent:t.data.sent,deleted:t.data.deleted,unread:this.getUnreadCounters(t.data.unread)};l.isFunction(e)&&e(n)}else t?l.isFunction(n)&&n(t):l.isFunction(n)&&n()}getUnreadCounters(t){return{count:t.count,lastAccess:t.lastAccess}}},{BaseRequest:f}=n(872).Core.Api;const d=class extends f{constructor(){super()}postInboxAuth(){return this.body=this.json,this}setJson(t){this.json=t}addHeaders(){const t=new Headers({"Content-Type":"application/json"});return Object.keys(this.headers).forEach((e=>{t.append(e,this.headers[e])})),t}},p=Object.freeze({SENT:"sent",CLICK:"click",DELETED:"deleted"});window.inboxStatus=p;const E=p,g=Object.freeze({NONE:"none",DEFAULT:"default",WEBHOOK:"webhook"}),{BaseRequest:y}=n(872).Core.Api;const m=class extends y{constructor(){super(),null!=s.getExternalId()&&(this.externalId=s.getExternalId()),null!=s.getAuthToken()&&s.getInboxAuthMode()==g.WEBHOOK&&(this.headers.Authorization="Bearer "+s.getAuthToken()),this.sendingId="",this.sendingIds=null,this.page=0,this.pageSize=0,this.dateFrom="",this.dateTo="",this.status=E.INBOXSTATUS_SENT,this.statusList=null}getInboxPushRequest(){return this.params=this.createQueryString(),this}putInboxPushRequest(){return this.params=this.createQueryStringExternalId(),this.body=this.createBodyJson(),this}getInboxPushRequestWithSendingId(){return this.pathParams["{sendingId}"]=this.sendingId,this.params=this.createQueryStringExternalId(),this}putInboxWithSendingId(){return this.pathParams["{sendingId}"]=this.sendingId,this.params=this.createQueryStringExternalId(),this.body=this.createBodyStatusJson(),this}addHeaders(){const t=new Headers({"Content-Type":"application/json"});return Object.keys(this.headers).forEach((e=>{t.append(e,this.headers[e])})),t}createQueryString(){let t="";if(this.page&&(t+=this.PARAM_INBOX_PAGE+"="+this.page+"&"),this.pageSize&&(t+=this.PARAM_INBOX_PAGE_SIZE+"="+this.pageSize+"&"),this.dateFrom&&(t+=this.PARAM_INBOX_DATE_FROM+"="+this.dateFrom+"&"),this.dateTo&&(t+=this.PARAM_INBOX_DATE_TO+"="+this.dateTo+"&"),this.statusList){let e="";for(let t=0;t<this.statusList.length;t++)e+=this.statusList[t],t!=this.statusList.length-1&&(e+=",");t+=this.PARAM_INBOX_STATUS+"="+e+"&"}return t+this.createQueryStringExternalId()}createQueryStringExternalId(){return this.PARAM_INBOX_EXTERNALID+"="+this.externalId}createBodyJson(){let t={};const e=[];try{if(t=this.createBodyStatusJson(),this.sendingIds)for(let t=0;t<this.sendingIds.length;t++)e.push(this.sendingIds[t]);t.sendingIds=e}catch(t){console.log("Error Inbox request :"+t)}return t}createBodyStatusJson(){const t={};return this.status&&(t.status=this.status),t}setSendingId(t){this.sendingId=t}setSendingIds(t){this.sendingIds=t}setPage(t){this.page=t}setPageSize(t){this.pageSize=t}setDateFrom(t){this.dateFrom=t}setDateTo(t){this.dateTo=t}setStatus(t){this.status=t}setStatusList(t){this.statusList=t}},{BaseRequest:v}=n(872).Core.Api;const I=class extends v{constructor(){super(),null!=s.getExternalId()&&(this.externalId=s.getExternalId()),null!=s.getAuthToken()&&s.getInboxAuthMode()==g.WEBHOOK&&(this.headers.Authorization="Bearer "+s.getAuthToken())}getCounter(){return this.params=this.createQueryStringExternalId(),this}addHeaders(){const t=new Headers({"Content-Type":"application/json"});return Object.keys(this.headers).forEach((e=>{t.append(e,this.headers[e])})),t}createQueryStringExternalId(){return this.PARAM_INBOX_EXTERNALID+"="+this.externalId}};class _{constructor(t,e){t&&(t.id&&(this.id=t.id),t.externalId&&(this.externalId=t.externalId),t.sentAt&&(this.sentAt=t.sentAt),t.status&&(this.status=t.status),t.sendingId&&(this.sendingId=t.sendingId),t.message&&(this.message=t.message),t.campaignId&&(this.campaignId=t.campaignId),this.read=!1,this.sentAt&&e&&this.sentAt<e&&(this.read=!0))}}window.inboxNotification=_;const O=_,{ErrorDictionary:b}=n(872).Core.Models,w=b.ErrorCode;Object.assign(w,{INBOX_GET_ERROR:3001,INBOX_GET_PAGE_ERROR:3011,INBOX_EXTERNAL_ID_NO_REGISTERED:3012,INBOX_NO_MESSAGES:3013,INBOX_IS_REQUESTING_PAGE:3014,INBOX_EMPTY:3015,INBOX_GENERAL_ERROR:3600});const P=b.ErrorMessage;Object.assign(P,{INBOX_GET_ERROR:"inbox GET request error",INBOX_GET_PAGE_ERROR:"error inbox get page",INBOX_EXTERNAL_ID_NO_REGISTERED:"external Id is not registered",INBOX_NO_MESSAGES:"There are no more messages on Inbox",INBOX_IS_REQUESTING_PAGE:"Wait. Is Requesting new page",INBOX_EMPTY:"There are no messages on Inbox",INBOX_GENERAL_ERROR:"general error"});const S={ErrorCode:w,ErrorMessage:P},{Validations:R,Log:T}=n(872).Core.Utils;const A=class extends R{static isAppKeyFormat(){const t=s.getAppKey();return null!=t&&""!=t&&"null"!=t&&t.length>3}static isValidFormatRequest(){const t=new T("[IND]InboxValidations: "),e=s.getDeviceId();let n=!0;return this.isAppKeyFormat()||(n=!1,t.w("appKey is null or empty").writeLog()),this.isValidFormat(e)||(n=!1,t.w("deviceId is null or empty").writeLog()),n}},{CommonUtils:N,ErrorUtils:L,Log:C}=n(872).Core.Utils;class D{constructor(t){if(t){if(t.lastAccess&&(this.lastAccess=t.lastAccess),t.numPage?this.page=t.numPage:this.page=0,t.pageSize&&(this.pageSize=t.pageSize),t.count&&(this.count=t.count),t.notifications){this.notifications=[];const e=t.notifications;for(let t=0;t<e.length;t++){const n=new O(e[t],this.lastAccess);this.notifications.push(n)}}this.totalPages=Math.trunc(this.count/this.pageSize)}this.dateFrom=null,this.dateTo=null,this.statusList=null,this.newNotifications=[O],this.isRequestingPage=!1}static generateAuthToken(t,e){let n={};navigator.indigitallGetAuthConfig&&N.isFunction(navigator.indigitallGetAuthConfig)&&(n=navigator.indigitallGetAuthConfig());const r=new d;r.setJson(n),h.postInboxAuth(r,t,e)}static getMessagesCount(t,e){if(A.isValidFormatRequest())if(A.isValidFormat(s.getExternalId())){const e=new I;h.getInboxCounter(e,t,(n=>{401===n.errorCode?this.generateAuthToken((()=>{h.getInboxCounter(e,t,n)}),n):N.isFunction(n)&&n(n)}))}else N.isFunction(e)&&e(L.showError(S,S.ErrorCode.INBOX_GET_ERROR));else N.isFunction(e)&&e(L.showError(S,S.ErrorCode.GENERAL_ERROR_BAD_REQUEST))}static getInbox(t,e){D.getInboxWithPage(null,null,null,null,null,t,e)}static getInboxWithPage(t,e,n,r,i,o,a){if(A.isValidFormatRequest())if(A.isValidFormat(s.getExternalId())){const s=new m;t&&s.setPage(t),e&&s.setPageSize(e),n&&(s.setDateFrom(n),this.dateFrom=n),r&&(s.setDateTo(r),this.dateTo=r),i&&(s.setStatusList(i),this.statusList=i),h.getInbox(s,(t=>{this.totalPages=t.totalPages,0!=t.count?N.isFunction(o)&&o(t):N.isFunction(a)&&a(L.showError(S,S.ErrorCode.INBOX_GET_PAGE_ERROR))}),(t=>{401==t.errorCode?this.generateAuthToken((()=>{h.getInbox(s,(t=>{this.totalPages=t.totalPages,N.isFunction(o)&&o(t)}),t)}),t):N.isFunction(t)&&t(t)}))}else N.isFunction(a)&&a(L.showError(S,S.ErrorCode.INBOX_EXTERNAL_ID_NO_REGISTERED));else N.isFunction(a)&&a(L.showError(S,S.ErrorCode.GENERAL_ERROR_BAD_REQUEST))}getNextPage(t,e){const n=new C("[IND]Inbox: ");if(this.isRequestingPage)n.w(S.ErrorMessage.INBOX_IS_REQUESTING_PAGE).writeLog();else if(this.isRequestingPage=!0,this.page+1<this.totalPages)if(A.isValidFormatRequest())if(A.isValidFormat(s.getExternalId())){const e=new m;(this.page||0==this.page)&&e.setPage(this.page+1),this.pageSize&&e.setPageSize(this.pageSize),this.dateFrom&&e.setDateFrom(this.dateFrom),this.dateTo&&e.setDateTo(this.dateTo),this.statusList&&e.setStatusList(this.statusList),h.getInbox(e,(e=>{this.notifications=this.notifications.concat(e.notifications),this.newNotifications=e.notifications,this.lastAccess=e.lastAccess,this.count=e.count,this.page=e.page,this.pageSize=e.pageSize,this.totalPages=e.totalPages,this.isRequestingPage=!1,N.isFunction(t)&&t(this,this.newNotifications)}),(n=>{401===n.errorCode?this.generateAuthToken((()=>{h.getInbox(e,(e=>{this.notifications=this.notifications.concat(e.notifications),this.newNotifications=e.notifications,this.lastAccess=e.lastAccess,this.count=e.count,this.page=e.page,this.pageSize=e.pageSize,this.totalPages=e.totalPages,this.isRequestingPage=!1,N.isFunction(t)&&t(this,this.newNotifications)}),n)}),n):(this.isRequestingPage=!1,N.isFunction(n)&&n())}))}else this.isRequestingPage=!1,N.isFunction(e)&&e(L.showError(S,S.ErrorCode.INBOX_EXTERNAL_ID_NO_REGISTERED));else N.isFunction(e)&&e(L.showError(S,S.ErrorCode.GENERAL_ERROR_BAD_REQUEST));else this.isRequestingPage=!1,N.isFunction(e)&&e(L.showError(S,S.ErrorCode.INBOX_NO_MESSAGES))}massiveEditNotifications(t,e,n,r){if(A.isValidFormatRequest())if(A.isValidFormat(s.getExternalId())){if(t&&e){const r=new m;r.setSendingIds(t),r.setStatus(e),h.putInboxPush(r,n,(t=>{401===t.errorCode?this.generateAuthToken((()=>{h.putInboxPush(r,n,t)}),t):N.isFunction(t)&&t(t)}))}}else N.isFunction(r)&&r(L.showError(S,S.ErrorCode.INBOX_EXTERNAL_ID_NO_REGISTERED));else N.isFunction(r)&&r(L.showError(S,S.ErrorCode.BAD_REQUEST_SERVER_ERROR))}getInfoFromNotification(t,e,n){if(A.isValidFormatRequest())if(A.isValidFormat(s.getExternalId())){if(t){const n=new m;n.setSendingId(t),h.getInboxPushWithSendingId(n,this.lastAccess,e,(t=>{401===t.errorCode?this.generateAuthToken((()=>{h.getInboxPushWithSendingId(n,this.lastAccess,e,t)}),t):N.isFunction(t)&&t(t)}))}}else N.isFunction(n)&&n(L.showError(S,S.ErrorCode.INBOX_EXTERNAL_ID_NO_REGISTERED));else N.isFunction(n)&&n(L.showError(S,S.ErrorCode.BAD_REQUEST_SERVER_ERROR))}modifyStatusFromNotification(t,e,n,r){if(A.isValidFormatRequest())if(A.isValidFormat(s.getExternalId())){if(t&&e){const r=new m;r.setSendingId(t),r.setStatus(e),h.putInboxPushWithSendingId(r,this.lastAccess,n,(t=>{401===t.errorCode?this.generateAuthToken((()=>{h.putInboxPushWithSendingId(r,this.lastAccess,n,t)}),t):N.isFunction(t)&&t(t)}))}}else N.isFunction(r)&&r(L.showError(S,S.ErrorCode.INBOX_EXTERNAL_ID_NO_REGISTERED));else N.isFunction(r)&&r(L.showError(S,S.ErrorCode.BAD_REQUEST_SERVER_ERROR))}}const x=D,{Repository:U}=n(872).Core;const M=new class extends U{constructor(){super(),this.SAFARI_WEBSITE_PUSH_ID=this.REPOSITORY+".SAFARI_WEBSITE_PUSH_ID",this.PUSH_TOKEN=this.REPOSITORY+".PUSH_TOKEN",this.PERMISSION_PUSH=this.REPOSITORY+".PERMISSION_PUSH",this.URL_DEVICE_API=this.REPOSITORY+".URL_DEVICE_API",this.DEVICE_JSON=this.REPOSITORY+".DEVICE_JSON",this.PUT_REQUEST_TIMESTAMP=this.REPOSITORY+".PUT_REQUEST_TIMESTAMP"}async setDeviceId(t){this.setStorage(this.DEVICE_ID,t)}getDeviceId(){return this.getStorage(this.DEVICE_ID)}setPushToken(t){this.setStorage(this.PUSH_TOKEN,t)}getPushToken(){return this.getStorage(this.PUSH_TOKEN)}setSafariWebsitePushId(t){this.setStorage(this.SAFARI_WEBSITE_PUSH_ID,t)}getSafariWebsitePushId(){return this.getStorage(this.SAFARI_WEBSITE_PUSH_ID)}setPermissionPush(t){this.setStorage(this.PERMISSION_PUSH,t)}getPermissionPush(){return this.getStorage(this.PERMISSION_PUSH)}async getUrlDeviceApi(){let t;try{this.storage&&this.storage.isLocalStorageAvailable()?t=this.getStorage(this.URL_DEVICE_API):this.db&&this.db.IDB&&(t=await this.db.getItem(this.URL_DEVICE_API))}catch(t){}return t}async setUrlDeviceApi(t){this.storage&&this.storage.isLocalStorageAvailable()&&this.setStorage(this.URL_DEVICE_API,t),this.db&&this.db.IDB&&await this.db.setItem(this.URL_DEVICE_API,t)}async getDeviceJson(){return this.getStorage(this.DEVICE_JSON)}async setDeviceJson(t){this.setStorage(this.DEVICE_JSON,t)}async getPutRequestTimestamp(){return this.getStorage(this.PUT_REQUEST_TIMESTAMP)}async setPutRequestTimestamp(t){this.setStorage(this.PUT_REQUEST_TIMESTAMP,t)}},{ErrorDictionary:k}=n(872).Core.Models,B=k.ErrorCode;Object.assign(B,{GENERAL_ERROR_BAD_REQUEST:601,GENERAL_ERROR_APPKEY_BAD_REQUEST:602,PUSH_INITIALIZATION_ERROR:1e3,PUSH_RECEPTION_ERROR:1200,PUSH_TOPICS_ERROR:1400,PUSH_DEVICE_ERROR:1500,PUSH_EVENT_ERROR:1600,API_APPKEY_NOT_VALID:1601});const F=k.ErrorMessage;Object.assign(F,{GENERAL_ERROR_BAD_REQUEST:"AppKey or DeviceId are null or empty",GENERAL_ERROR_APPKEY_BAD_REQUEST:"AppKey is null or empty",PUSH_INITIALIZATION_ERROR:"initialization error",PUSH_RECEPTION_ERROR:"push reception error",PUSH_TOPICS_ERROR:"push topics error",PUSH_DEVICE_ERROR:"device error",PUSH_EVENT_ERROR:"event error",API_APPKEY_NOT_VALID:"appKey is missing'"});const V={ErrorCode:B,ErrorMessage:F},{BaseRequest:j}=n(872).Core.Api,{EventType:Y}=n(872).Core.Models;const G=class extends j{constructor(){super()}setEventType(t){this.eventType=t}setPushId(t){this.pushId=t}setClickedButton(t){this.clickedButton=t}setSendingId(t){this.sendingId=t}setPermissionType(t){this.permissionType=t}setLocation(t,e){this.latitude=t,this.longitude=e}setDeviceId(t){this.deviceId=t}setPlatform(t){this.platform=t}setAppKey(t){this.appKey=t}setCustomData(t){this.customData=t}async setExternalCodeRequest(){this.externalCode=await M.getExternalIdRequest()}setExternalCode(t){this.externalCode=t}setCampaingId(t){this.campaignId=t}setJourneyStateId(t){this.journeyStateId=t}setJourneyExecution(t){this.journeyExecution=t}setCjCurrentStateId(t){this.cjCurrentStateId=t}postEventPushRequest(){const t={};return t.deviceId=this.deviceId,t.platform=this.platform,this.eventType&&(t.eventType=this.eventType),this.pushId&&(t.pushId=this.pushId),t.clickedButton=this.clickedButton,null!=this.externalCode&&(t.externalCode=this.externalCode),this.sendingId&&"undefined"!=this.sendingId&&(t.sendingId=this.sendingId),this.journeyStateId&&(t.journeyStateId=this.journeyStateId),this.campaignId&&(t.campaignId=this.campaignId),this.body=t,this}postEventVisitRequest(){const t={};return t.deviceId=M.getDeviceId(),t.eventType=Y.EVENT_TYPE_UPDATE,this.body=t,this}postEventPermissionRequest(){const t={};return t.deviceId=M.getDeviceId(),this.eventType&&(t.eventType=this.eventType),this.permissionType&&(t.permissionType=this.permissionType),this.body=t,this}postEventLocationRequest(){const t={};return t.deviceId=M.getDeviceId(),t.eventType=Y.EVENT_TYPE_UPDATE,this.latitude&&(t.latitude=this.latitude),this.longitude&&(t.longitude=this.longitude),this.body=t,this}postEventCustomRequest(){const t={};return this.deviceId&&(t.deviceId=this.deviceId),this.eventType&&(t.eventType=this.eventType),this.customData&&(t.customData=this.customData),this.externalCode&&(t.externalCode=this.externalCode),this.body=t,this}};const K=class{static urlBase64ToUint8Array(t){const e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(e),r=new Uint8Array(n.length);for(let t=0;t<n.length;++t)r[t]=n.charCodeAt(t);return r}static callEventPermission(t,e){const n=new G;n.setAppKey(M.getAppKey()),n.setDeviceId(M.getDeviceId()),n.setPermissionType(t),n.setEventType(e),nt.postEventPermission(n)}static async getPutRequestTimestamp(){return await M.getPutRequestTimestamp()?M.getPutRequestTimestamp():Date.now()+6048e5}},{Validations:q,Log:W}=n(872).Core.Utils;const J=class extends q{static isAppKeyFormat(){const t=M.getAppKey();return null!=t&&""!=t&&"null"!=t&&t.length>3}static isValidFormatRequest(){const t=new W("[IND]PushValidations: "),e=M.getDeviceId();let n=!0;return this.isAppKeyFormat()||(n=!1,t.w("appKey is null or empty").writeLog()),this.isValidFormat(e)||(n=!1,t.w("deviceId is null or empty").writeLog()),n}static async isPutRequestExceed(){return await K.getPutRequestTimestamp()<=Date.now()}},{Device:X}=n(872).Core.Models;const H=class extends X{constructor(t=null,e){super(t,e),null==t?(null!=M.getDeviceId()&&(this.deviceId=M.getDeviceId()),null!=M.getPushToken()&&(this.pushToken=M.getPushToken())):e?t.deviceId&&(this.deviceId=t.deviceId,M.setDeviceId(this.deviceId)):(t.deviceId&&(this.deviceId=t.deviceId),t.pushToken&&(this.pushToken=t.pushToken))}getDeviceId(){return this.deviceId}getPushToken(){return this.pushToken}toJSON(){const t=super.toJSON();return this.deviceId&&(t.deviceId=this.deviceId),this.pushToken&&(t.pushToken=this.pushToken),t}},{Config:Q}=n(872).Core,{BaseClient:z}=n(872).Core.Api,{ErrorModel:Z}=n(872).Core.Models,{Log:$,CommonUtils:tt,ErrorUtils:et}=n(872).Core.Utils;const nt=new class extends z{constructor(){super(),this.URL_BASE=Q.client.URL_BASE,this.ENDPOINT_APPLICATION="/application",this.ENDPOINT_APPLICATION_ALL=this.ENDPOINT_APPLICATION+"/all",this.ENDPOINT_DEVICE="/device",this.ENDPOINT_DEVICE_TOPICS=this.ENDPOINT_DEVICE+"/topics",this.ENDPOINT_PUSH="/push",this.ENDPOINT_EVENT="/event",this.ENDPOINT_EVENT_PUSH=this.ENDPOINT_EVENT+"/push",this.ENDPOINT_EVENT_VISIT=this.ENDPOINT_EVENT+"/visit",this.ENDPOINT_EVENT_PERMISSION=this.ENDPOINT_EVENT+"/permission",this.ENDPOINT_EVENT_LOCATION=this.ENDPOINT_EVENT+"/location",this.ENDPOINT_EVENT_CUSTOM=this.ENDPOINT_EVENT+"/custom",this.ENDPOINT_EVENT_CUSTOM_BEACON=this.ENDPOINT_EVENT_CUSTOM+"/beacon",this.ENDPOINT_BROWSER="/browser",this.log=new $("[IND]Client: ")}async getURL(){const t=await M.getUrlDeviceApi();return t||this.URL_BASE}async getApplicationAll(t,e,n){if(J.isAppKeyFormat()){const r=await this.get(this.ENDPOINT_APPLICATION_ALL,t.getApplicationRequest());!r||r instanceof Z?r?tt.isFunction(n)&&n(r):tt.isFunction(n)&&n():tt.isFunction(e)&&e(r)}else tt.isFunction(n)&&n(et.showError(V,V.ErrorCode.BAD_REQUEST_SERVER_ERROR));return!0}async postDevice(t,e,n){if(J.isAppKeyFormat()){const r=await this.post(this.ENDPOINT_DEVICE,t.postDeviceRequest(),"include");if(!r||r instanceof Z)r?tt.isFunction(n)&&n(r):tt.isFunction(n)&&n();else{const t={enabled:r.data.enabled,deviceId:r.data.deviceId,registeredByCookie:r.data.registeredByCookie};await M.setDeviceId(t.deviceId),tt.isFunction(e)&&e(new H(t,!0))}}else tt.isFunction(n)&&n(et.showError(V,V.ErrorCode.GENERAL_ERROR_APPKEY_BAD_REQUEST));return!0}async putDevice(t,e,n){const r=new H,i=await J.isPutRequestExceed();if(null==await M.getPutRequestTimestamp()||i)if(J.isValidFormatRequest()){M.setPutRequestTimestamp(await K.getPutRequestTimestamp());const i=await this.put(this.ENDPOINT_DEVICE,t.putDeviceRequest(r),"include");if(!i||i instanceof Z)i?tt.isFunction(n)&&n(i):tt.isFunction(n)&&n();else{const t={enabled:i.data.enabled,deviceId:i.data.deviceId,registeredByCookie:i.data.registeredByCookie};tt.isFunction(e)&&e(new H(t,!0))}}else tt.isFunction(n)&&n(et.showError(V,V.ErrorCode.GENERAL_ERROR_BAD_REQUEST));else tt.isFunction(e)&&e(r)}async getDevice(t,e,n){if(J.isValidFormatRequest()){const r=await this.get(this.ENDPOINT_DEVICE,t.getDeviceRequest());if(!r||r instanceof Z)r?tt.isFunction(n)&&n(r):tt.isFunction(n)&&n();else{const t={enabled:r.data.enabled,deviceId:r.data.deviceId};tt.isFunction(e)&&e(new H(t,!0))}}else tt.isFunction(n)&&n(et.showError(V,V.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async getDeviceTopics(t,e,n){if(J.isValidFormatRequest()){const r=await this.get(this.ENDPOINT_DEVICE_TOPICS,t.getDeviceTopicsRequest());if(!r||r instanceof Z)r?tt.isFunction(n)&&n(r):tt.isFunction(n)&&n();else{const t=r.data.topics;tt.isFunction(e)&&e(t)}}else tt.isFunction(n)&&n(et.showError(V,V.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async postDeviceTopics(t,e,n){if(J.isValidFormatRequest()){const r=await this.post(this.ENDPOINT_DEVICE_TOPICS,t.postDeviceTopicsRequest());if(!r||r instanceof Z)r?tt.isFunction(n)&&n(r):tt.isFunction(n)&&n();else{const t=r.data.topics;tt.isFunction(e)&&e(t)}}else tt.isFunction(n)&&n(et.showError(V,V.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async deleteDeviceTopics(t,e,n){if(J.isValidFormatRequest()){const r=await this.delete(this.ENDPOINT_DEVICE_TOPICS,t.deleteDeviceTopicsRequest());if(!r||r instanceof Z)r?tt.isFunction(n)&&n(r):tt.isFunction(n)&&n();else{const t=r.data.topics;tt.isFunction(e)&&e(t)}}else tt.isFunction(n)&&n(et.showError(V,V.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async postEventPush(t){J.isValidFormatRequest()&&await this.post(this.ENDPOINT_EVENT_PUSH,t.postEventPushRequest())}postEventVisit(t){J.isValidFormatRequest()&&this.post(this.ENDPOINT_EVENT_VISIT,t.postEventVisitRequest())}postEventPermission(t){J.isValidFormatRequest()&&this.post(this.ENDPOINT_EVENT_PERMISSION,t.postEventPermissionRequest())}postEventLocation(t){J.isValidFormatRequest()&&this.post(this.ENDPOINT_EVENT_LOCATION,t.postEventLocationRequest())}async getBrowser(t,e,n){if(J.isAppKeyFormat()){const r=await this.get(this.ENDPOINT_BROWSER,t);if(!r||r instanceof Z)r?tt.isFunction(n)&&n(r):tt.isFunction(n)&&n();else{const t={browserName:r.data.browserName,browserVersion:r.data.browserVersion,deviceType:r.data.deviceType,osName:r.data.osName,osVersion:r.data.osVersion,supported:r.data.supported,platform:r.data.platform};await M.setBrowserName(t.browserName),M.setBrowserVersion(t.browserVersion),await M.setOsName(t.osName),M.setOsVersion(t.osVersion),M.setDeviceType(t.deviceType),M.setSupported(t.supported),await M.setPlatform(t.platform),tt.isFunction(e)&&e(t)}}else tt.isFunction(n)&&n(et.showError(V,V.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async postEventCustom(t,e,n){if(J.isValidFormatRequest()){const r=await this.post(this.ENDPOINT_EVENT_CUSTOM,t.postEventCustomRequest());!r||r instanceof Z?r?tt.isFunction(n)&&n(r):tt.isFunction(n)&&n():tt.isFunction(e)&&e(r)}else tt.isFunction(n)&&n(et.showError(V,V.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async postEventCustomSync(t,e,n){if(J.isValidFormatRequest()){t=t.postEventCustomRequest();try{if(navigator&&"sendBeacon"in navigator){const n=await this.getURL()+this.ENDPOINT_EVENT_CUSTOM_BEACON+t.getParams();navigator.sendBeacon(n,JSON.stringify(t.getBody())),tt.isFunction(e)&&e()}else{const r=await this.getURL()+this.ENDPOINT_EVENT_CUSTOM+t.getParams(),i=new XMLHttpRequest;i.open("POST",r,!1),i.setRequestHeader("Content-Type","application/json"),i.onreadystatechange=()=>{i.readyState===XMLHttpRequest.DONE&&(i.status>=200||i.status<300)?tt.isFunction(e)&&e():tt.isFunction(n)&&n()},i.send(JSON.stringify(t.getBody()))}}catch(t){tt.isFunction(n)&&n(et.showError(V,V.ErrorCode.PUSH_EVENT_ERROR,t))}}else tt.isFunction(n)&&n(et.showError(V,V.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async postEventJourney(t,e,n){if(J.isValidFormatRequest()){const r=await this.post(this.ENDPOINT_PUSH+this.ENDPOINT_EVENT_CUSTOM,t.postEventCustomRequest());!r||r instanceof Z?r?tt.isFunction(n)&&n(r):tt.isFunction(n)&&n():tt.isFunction(e)&&e(r)}else tt.isFunction(n)&&n(et.showError(V,V.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async postEventJourneySync(t,e,n){if(J.isValidFormatRequest()){t=t.postEventCustomRequest();try{let r=await this.getURL();if(r=r.replace("v1","v2"),navigator&&"sendBeacon"in navigator){const n=r+this.ENDPOINT_PUSH+this.ENDPOINT_EVENT_CUSTOM+t.getParams();navigator.sendBeacon(n,JSON.stringify(t.getBody())),tt.isFunction(e)&&e()}else{const r=await this.getURL().replace("v1","v2")+this.ENDPOINT_PUSH+this.ENDPOINT_EVENT_CUSTOM+t.getParams(),i=new XMLHttpRequest;i.open("POST",r,!1),i.setRequestHeader("Content-Type","application/json"),i.onreadystatechange=()=>{i.readyState===XMLHttpRequest.DONE&&(i.status>=200||i.status<300)?tt.isFunction(e)&&e():tt.isFunction(n)&&n()},i.send(JSON.stringify(t.getBody()))}}catch(t){tt.isFunction(n)&&n(et.showError(V,V.ErrorCode.PUSH_EVENT_ERROR,t))}}else tt.isFunction(n)&&n(et.showError(V,V.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}},{Config:rt}=n(872).Core,{BaseRequest:it}=n(872).Core.Api;const ot=class extends it{getApplicationRequest(){return this.params=this.PARAM_PLATFORM+"="+rt.platform,this}},{DeviceStatus:st}=n(872).Core.Models,{BaseRequest:at}=n(872).Core.Api;const ut=class extends at{constructor(t=st.DEFAULT){super(),this.device=new H,this.status=t,this.notToUpdate=!1}setDeviceId(t){this.device&&(this.device.deviceId=t)}setAppKey(t){this.appKey=t}getDeviceRequest(){return this.params=this.createQueryString(),this}postDeviceRequest(){return this.body=this.createDeviceJson(),this.status!==st.DEFAULT&&(this.body.enabled=1===this.status),this}putDeviceRequest(t){return this.params=this.createQueryString(),this.body=this.createPUTDeviceJson(t),this.status!==st.DEFAULT&&(this.body.enabled=1===this.status),this}getDeviceTopicsRequest(){return this.params=this.createQueryString(),this}postDeviceTopicsRequest(){return this.params=this.createQueryString(),this.body=this.createTopicsJson(),this}deleteDeviceTopicsRequest(){return this.params=this.createQueryString(),this.body=this.createTopicsJson(),this}createQueryString(){return this.PARAM_DEVICE_ID+"="+this.device.deviceId}createDeviceJson(){let t={};try{t=this.device.toJSON()}catch(t){}return t}createPUTDeviceJson(t){let e={};try{H.setDeviceJson(t),e=t.toJSON()}catch(t){}return e}createTopicsJson(){const t={};return this.topics&&(t.topics=this.topics),t}getDeviceId(){return this.device.getDeviceId()}setTopics(t){this.topics=t}setExternalCode(t){this.device.setExternalCode(t)}},ct=Object.freeze({PERMISSION_TYPE_PUSH:"push",PERMISSION_TYPE_LOCATION:"location"}),{CorePermissions:lt}=n(872).Core.Utils;const ht=class{static async getPermissions(){const t=await lt.getPermissions(),e=await lt.getPermission("push");return e&&(t.push=e.state),null===e&&window.Notification&&window.Notification.permission&&(t.push=window.Notification.permission),t}static async setPermissionsCallback(){lt.setPermissionsCallback(),await lt.setCallback("push",navigator.indigitallRequestPushPermission)}},{Repository:ft}=n(872).Core;const dt=new class extends ft{constructor(){super(),this.DEVICE_ID=this.REPOSITORY+".DEVICE_ID"}async setDeviceId(t){this.setStorage(this.DEVICE_ID,t)}getDeviceId(){return this.getStorage(this.DEVICE_ID)}},{Validations:pt,Log:Et}=n(872).Core.Utils;const gt=class extends pt{static isAppKeyFormat(){const t=dt.getAppKey();return null!=t&&""!=t&&"null"!=t&&t.length>3}static isValidFormatRequest(){const t=new Et("[IND]CustomerValidations: "),e=dt.getDeviceId();let n=!0;return this.isAppKeyFormat()||(n=!1,t.w("appKey is null or empty").writeLog()),this.isValidFormat(e)||(n=!1,t.w("deviceId is null or empty").writeLog()),n}};const yt=class{constructor(t){t.id&&(this.id=t.id),t.customerId&&(this.customerId=t.customerId),t.applicationId&&(this.applicationId=t.applicationId),t.createdAt&&(this.createdAt=t.createdAt),t.updatedAt&&(this.updatedAt=t.updatedAt)}getCustomerId(){return this.customerId}getApplicationId(){return this.applicationId}getId(){return this.id}getCreatedAt(){return this.createdAt}getUpdatedAt(){return this.updatedAt}toJSON(){return{id:this.id,customerId:this.customerId,applicationId:this.applicationId,createdAt:this.createdAt,updatedAt:this.updatedAt}}};const mt=class{constructor(t,e){this.customerFieldKey=t,this.customerFieldValue=e}getCustomerFieldKey(){return this.customerFieldKey}getCutomerFieldValue(){return this.customerFieldValue}toJSON(){return JSON.parse(`"${this.customerFieldKey}":"${this.customerFieldValue}"`)}},{ErrorDictionary:vt}=n(872).Core.Models,It=vt.ErrorCode;Object.assign(It,{CUSTOMER_GET_ERROR:4001,CUSTOMER_PARAMS_ERROR:4011,CUSTOMER_GENERAL_ERROR:4600,CUSTOMER_NO_EXTERNAL_CODE:4601});const _t=vt.ErrorMessage;Object.assign(_t,{CUSTOMER_GET_ERROR:"customer get error",CUSTOMER_PARAMS_ERROR:"Params are not correct",CUSTOMER_GENERAL_ERROR:"general error",CUSTOMER_NO_EXTERNAL_CODE:"no external code registered"});const Ot={ErrorCode:It,ErrorMessage:_t},{Config:bt}=n(872).Core,{BaseClient:wt}=n(872).Core.Api,{ErrorModel:Pt}=n(872).Core.Models,{CommonUtils:St,ErrorUtils:Rt}=n(872).Core.Utils;const Tt=new class extends wt{constructor(){super(),this.URL_BASE=bt.client.CUSTOMER_URL_BASE,this.ENDPOINT_CUSTOMER="/customer",this.ENDPOINT_CUSTOMER_FIELD=this.ENDPOINT_CUSTOMER+"/field",this.ENDPOINT_CUSTOMER_LINK=this.ENDPOINT_CUSTOMER+"/link",this.ENDPOINT_EVENT="/event",this.ENDPOINT_EVENT_JOURNEY=this.ENDPOINT_EVENT+"/custom",this.ENDPOINT_EVENT_JOURNEY_BEACON=this.ENDPOINT_EVENT_JOURNEY+"/beacon"}async getCustomer(t,e,n){if(gt.isAppKeyFormat()&&gt.isValidFormat(dt.getExternalId)){const r=await this.get(this.ENDPOINT_CUSTOMER,t.getCustomerRequest());r&&!(r instanceof Pt)&&r.statusCode>=200&&r.statusCode<300?St.isFunction(e)&&e(new yt(r.data)):r?St.isFunction(n)&&n(r):St.isFunction(n)&&n()}else St.isFunction(n)&&n(Rt.showError(Ot,Ot.ErrorCode.BAD_REQUEST_SERVER_ERROR))}async getCustomerField(t,e,n){if(gt.isAppKeyFormat()&&gt.isValidFormat(dt.getExternalId)){const r=await this.get(this.ENDPOINT_CUSTOMER_FIELD,t.getCustomerFieldRequest()),i=[];for(const t in r.data)r.data.hasOwnProperty(t)&&i.push(new mt(t,r.data[t]));r&&i.length>0&&!(r instanceof Pt)&&r.statusCode>=200&&r.statusCode<300?St.isFunction(e)&&e(i):r?St.isFunction(n)&&n(r):St.isFunction(n)&&n()}else St.isFunction(n)&&n(Rt.showError(Ot,Ot.ErrorCode.BAD_REQUEST_SERVER_ERROR))}async putCustomerField(t,e,n){if(gt.isAppKeyFormat()&&gt.isValidFormat(dt.getExternalId)){const r=await this.put(this.ENDPOINT_CUSTOMER_FIELD,t.putCustomerFieldRequest());this.getCustomerResponse(r,e,n)}else St.isFunction(n)&&n(Rt.showError(Ot,Ot.ErrorCode.BAD_REQUEST_SERVER_ERROR))}async deleteCustomerField(t,e,n){if(gt.isAppKeyFormat()&&gt.isValidFormat(dt.getExternalId)){const r=await this.delete(this.ENDPOINT_CUSTOMER_FIELD,t.deleteCustomerFieldRequest());this.getCustomerResponse(r,e,n)}else St.isFunction(n)&&n(Rt.showError(Ot,Ot.ErrorCode.BAD_REQUEST_SERVER_ERROR))}async postCustomerLink(t,e,n){if(gt.isValidFormatRequest()&&gt.isValidFormat(dt.getExternalId)){const r=await this.post(this.ENDPOINT_CUSTOMER_LINK,t.postAndDeleteCustomerLinkRequest());this.getCustomerResponse(r,e,n)}else St.isFunction(n)&&n(Rt.showError(Ot,Ot.ErrorCode.BAD_REQUEST_SERVER_ERROR))}async deleteCustomerLink(t,e,n){if(gt.isValidFormatRequest()&&gt.isValidFormat(dt.getExternalId)){const r=await this.delete(this.ENDPOINT_CUSTOMER_LINK,t.postAndDeleteCustomerLinkRequest());this.getCustomerResponse(r,e,n)}else St.isFunction(n)&&n(Rt.showError(Ot,Ot.ErrorCode.BAD_REQUEST_SERVER_ERROR))}async getCustomerResponse(t,e,n){t&&!(t instanceof Pt)&&t.statusCode>=200&&t.statusCode<300?St.isFunction(e)&&(""!=t.data?e(t.data):e()):t?St.isFunction(n)&&n(t):St.isFunction(n)&&n()}},{BaseRequest:At}=n(872).Core.Api,{Device:Nt}=n(872).Core.Models;const Lt=class extends At{constructor(){super(),this.device=new Nt,null!=dt.getExternalId()&&(this.customerId=dt.getExternalId()),this.fieldNames,this.link,this.fields}getCustomerRequest(){return this.params=this.createQueryStringCustomerId(),this}getCustomerFieldRequest(){return this.params=this.createQueryString(),this}putCustomerFieldRequest(){return this.params=this.createQueryStringCustomerId(),this.body=this.createBodyJson(),this}deleteCustomerFieldRequest(){return this.params=this.createQueryStringCustomerId(),this.body=this.createDeleteBodyJson(),this}postAndDeleteCustomerLinkRequest(){return this.params="",this.body=this.createBodyJson(),this}createQueryString(){let t="";return t+=this.createQueryStringCustomerId(),this.fieldNames&&(t+=`&${this.PARAM_CUSTOMER_FIELD_NAMES}=${this.fieldNames}`),this.fields&&(t+=`&${this.PARAM_CUSTOMER_FIELDS}=${this.fields}`),this.link&&(t+=`&${this.PARAM_CUSTOMER_LINK}=${this.link}`),t}createQueryStringCustomerId(){return this.PARAM_CUSTOMER_ID+"="+this.customerId}createBodyJson(){let t={};try{this.channel&&(t.channel=this.channel,this.device&&(t.deviceId=this.device.deviceId),this.customerId&&(t.customerId=this.customerId)),this.link&&(t.link=this.link),this.fields&&(t=this.fields)}catch(t){console.log("Error fieldNames request :"+t)}return t}createDeleteBodyJson(){const t={},e=[];try{if(this.fieldNames){for(let t=0;t<this.fieldNames.length;t++)e.push(this.fieldNames[t]);t.fields=e}}catch(t){console.log("Error fieldNames request :"+t)}return t}setFields(t){this.fields=t}setFieldNames(t){this.fieldNames=t}setLink(t){this.link=t}setChannel(t){this.channel=t}},{CommonUtils:Ct,ErrorUtils:Dt}=n(872).Core.Utils;const xt=class{static async getCustomer(t,e){const n=new Lt;await Tt.getCustomer(n,t,e)}static async getCustomerInformation(t,e,n){const r=new Lt;null!=t&&(Array.isArray(t)?r.setFieldNames(t):Ct.isFunction(n)&&n(Dt.customerError(4011,Dt.CUSTOMER_ERROR_PARAMS))),await Tt.getCustomerField(r,e,n)}static async updateValueToCustomerFields(t,e,n){let r;try{"string"==typeof t?r=JSON.parse(r):"object"==typeof t&&(r=t)}catch(t){Ct.isFunction(n)&&n(Dt.customerError(4011,Dt.CUSTOMER_ERROR_PARAMS))}if(r){const t=new Lt;t.setFields(r),await Tt.putCustomerField(t,e,n)}else Ct.isFunction(n)&&n(Dt.customerError(4900,Dt.CUSTOMER_ERROR_PARAMS))}static async deleteValuesFromCustomerFields(t,e,n){if(Array.isArray(t)){const r=new Lt;r.setFieldNames(t),await Tt.deleteCustomerField(r,e,n)}else Ct.isFunction(n)&&n(Dt.customerError(4011,Dt.CUSTOMER_ERROR_PARAMS))}static async linkCustomer(t,e,n){const r=new Lt;r.setChannel(t),await Tt.postCustomerLink(r,e,n)}static async unlinkCustomer(t,e,n){const r=new Lt;r.setChannel(t),await Tt.deleteCustomerLink(r,e,n)}},{EventType:Ut,DeviceStatus:Mt,Channel:kt}=n(872).Core.Models,{LogLevel:Bt,Log:Ft,CommonUtils:Vt,ErrorUtils:jt,CryptoUtils:Yt}=n(872).Core.Utils,Gt="[IND]Indigitall: ";class Kt{constructor(){this.config=null}static async init(t){try{let e=new Ft(Gt);if(!t)return void e.w("config is not defined").writeLog();t.onPushPermissionChanged&&(t.requestPushPermission=t.onPushPermissionChanged),t.onLocationPermissionChanged&&(t.requestLocationPermission=t.onLocationPermissionChanged),this.config=t,this.config.logLevel?(M.setLogLevel(this.config.logLevel),e=new Ft(Gt)):this.config.setDebugLog&&(M.setLogLevel(Bt.WARNING),e=new Ft(Gt));let n="https://device-api.indigitall.com/v1",r="https://inbox-api.indigitall.com/v1";this.config.urlDeviceApi&&(n=this.config.urlDeviceApi),this.config.urlInboxApi&&(r=this.config.urlInboxApi),await M.setUrlDeviceApi(n),await s.setUrlInboxApi(r),Vt.isFunction(this.config.requestPushPermission)&&(navigator.indigitallRequestPushPermission=this.config.requestPushPermission),Vt.isFunction(this.config.requestLocationPermission)&&(navigator.indigitallRequestLocationPermission=this.config.requestLocationPermission),Vt.isFunction(this.config.onNewUserRegistered)&&(navigator.indigitallOnNewUserRegistered=this.config.onNewUserRegistered),Vt.isFunction(this.config.onInitialized)&&(navigator.indigitallOnInitialized=this.config.onInitialized),Vt.isFunction(this.config.onError)&&(navigator.indigitallOnError=this.config.onError),Vt.isFunction(this.config.onLocationUpdated)&&(navigator.indigitallOnLocationUpdated=this.config.onLocationUpdated);const i=await ht.getPermissions();if(ht.setPermissionsCallback(),i&&"denied"===i.push)return e.i("Push permission denied").writeLog(),Vt.isFunction(navigator.indigitallOnError)&&navigator.indigitallOnError("Push permission denied"),!1;if(!Vt.isServiceTimestampExceed())return this.device=new H,ht.getPermissions().then((t=>{Vt.isFunction(navigator.indigitallOnInitialized)&&navigator.indigitallOnInitialized(t,new H)})),e.d("Device enabled").writeLog(),!0;{let t="",n=null;if(!this.config||!this.config.appKey)return e.w("config.appKey is not defined").writeLog(),!1;if(t=this.config.appKey,this.config.requestLocation&&await M.setRequestLocation(this.config.requestLocation),this.config.workerPath&&(n=this.config.workerPath),t){if(await M.setAppKey(t),Kt.isServiceWorkerSupported()||Kt.isSafariPushNotificationSupported()){const t=new ot;return nt.getBrowser(t,(t=>{if(t.supported){e.d("browser supported for webpush").writeLog();const t=new ot;nt.getApplicationAll(t,(async t=>{if(e.d("application ",t).writeLog(),t&&t.data&&t.data.configuration){const n=t.data.configuration;e.d("configuration ",n).writeLog(),n.vapidPublic&&M.setVAPID(n.vapidPublic),n.safariWebsitePushId&&M.setSafariWebsitePushId(n.safariWebsitePushId),n.enabled&&M.setEnabled(n.enabled),n.serviceSyncTime&&M.setServiceSyncTime(n.serviceSyncTime),n.locationEnabled&&M.setLocationEnabled(n.locationEnabled),n.locationUpdateMinutes&&M.setLocationUpdateMinutes(n.locationUpdateMinutes),n.inboxAuthMode&&s.setInboxAuthMode(n.inboxAuthMode),n.inAppEnabled}const r=new ut;M.getDeviceId()&&M.getPushToken()?nt.putDevice(r,(t=>{try{if(Vt.isServiceTimestampExceed()){const t=new G;t.setAppKey(M.getAppKey()),t.setDeviceId(M.getDeviceId()),nt.postEventVisit(t)}t.registeredByCookie?(M.setServiceTimestamp(Date.now()),ht.getPermissions().then((t=>{const n=new H;n.deviceId&&e.i("deviceId:",n.deviceId).writeLog(),n.pushToken&&e.i("pushToken:",n.pushToken).writeLog(),this.config&&Vt.isFunction(navigator.indigitallOnInitialized)&&navigator.indigitallOnInitialized(t,n)}))):Kt.registerForPush(n)}catch(t){Vt.isFunction(navigator.indigitallOnError)&&navigator.indigitallOnError(jt.showError(V,V.ErrorCode.PUSH_INITIALIZATION_ERROR,t))}}),navigator.indigitallOnError):nt.postDevice(r,(t=>{try{const e=new G;e.setAppKey(M.getAppKey()),e.setDeviceId(M.getDeviceId()),nt.postEventVisit(e),t.registeredByCookie?M.setServiceTimestamp(Date.now()):Kt.registerForPush(n)}catch(t){Vt.isFunction(navigator.indigitallOnError)&&navigator.indigitallOnError(jt.showError(V,V.ErrorCode.PUSH_INITIALIZATION_ERROR,t))}}),(t=>{404===t.errorCode&&M.clearStorage(),Vt.isFunction(navigator.indigitallOnError)&&navigator.indigitallOnError(t)}))}),navigator.indigitallOnError)}else e.w("Browser not Supported").writeLog()}),navigator.indigitallOnError),!0}e.w("ServiceWorker and SafariPushNotification not supported").writeLog()}else e.w("appKey is not found").writeLog()}}catch(t){Vt.isFunction(navigator.indigitallOnError)&&navigator.indigitallOnError(jt.showError(V,V.ErrorCode.PUSH_INITIALIZATION_ERROR,t))}return!1}static deviceGet(t,e){return nt.getDevice(new ut,t,e),!0}static deviceEnable(t,e){return nt.putDevice(new ut(Mt.ENABLE),t,e),!0}static deviceDisable(t,e){return nt.putDevice(new ut(Mt.DISABLE),t,e),!0}static topicsList(t,e){return nt.getDeviceTopics(new ut,t,e),!0}static topicsSubscribe(t,e,n){const r=new ut;return r.setTopics(t),nt.postDeviceTopics(r,e,n),!0}static topicsUnsubscribe(t,e,n){const r=new ut;return r.setTopics(t),nt.deleteDeviceTopics(r,e,n),!0}static registerForPush(t){Kt.isSafariPushNotificationSupported()?Kt.launchNotificationPermissionForSafari():Kt.isServiceWorkerSupported()&&Kt.launchNotificationPermission(t)}static isServiceWorkerSupported(){return"serviceWorker"in navigator}static isSafariPushNotificationSupported(){return"safari"in window&&"pushNotification"in window.safari}static registerServiceWorker(t){const e=new Ft(Gt);let n="/service-worker.js";return t&&(n=t),navigator.serviceWorker.register(n).then((t=>(e.d("ServiceWorker registration successful with scope: "+t.scope).writeLog(),t))).catch((t=>(e.e("ServiceWorker registration failed: ",t).writeLog(),t)))}static launchNotificationPermission(t){const e=new Ft(Gt);this.registerServiceWorker(t).then((t=>{try{let n;t.installing?n=t.installing:t.waiting?n=t.waiting:t.active&&(n=t.active),n&&(e.d("sw current state "+n.state).writeLog(),"activated"==n.state?Kt.subscribeForPushNotification(t):("installed"==n.state&&M.getPushToken()&&t.update(),n.addEventListener("statechange",(function(n){e.d("sw statechange : "+n.target.state).writeLog(),"activated"==n.target.state&&Kt.subscribeForPushNotification(t)}))))}catch(t){Vt.isFunction(navigator.indigitallOnError)&&navigator.indigitallOnError(jt.showError(V,V.ErrorCode.PUSH_INITIALIZATION_ERROR,t))}}))}static subscribeForPushNotification(t){const e=new Ft(Gt);return new Promise(((n,r)=>{const i={userVisibleOnly:!0,applicationServerKey:K.urlBase64ToUint8Array(M.getVAPID())};return e.d("Registration: ",t).writeLog(),M.getPermissionPush()||K.callEventPermission(ct.PERMISSION_TYPE_PUSH,Ut.EVENT_TYPE_ASK),n(t.pushManager.subscribe(i))})).then((t=>{e.d("Received PushSubscription: ",t).writeLog(),M.getPermissionPush()&&M.getPermissionPush()===Ut.EVENT_TYPE_ACCEPT||(K.callEventPermission(ct.PERMISSION_TYPE_PUSH,Ut.EVENT_TYPE_ACCEPT),M.setPermissionPush(Ut.EVENT_TYPE_ACCEPT));const n=t.toJSON();M.setBrowserPublicKey(n.keys.p256dh),M.setBrowserPrivateKey(n.keys.auth),M.setPushToken(n.endpoint),nt.putDevice(new ut,(t=>{ht.getPermissions().then((t=>{Vt.isFunction(navigator.indigitallOnInitialized)&&navigator.indigitallOnInitialized(t,new H)})),Vt.isFunction(navigator.indigitallOnNewUserRegistered)&&!M.getNewUserTimestamp()&&(M.setNewUserTimestamp(Date.now()),navigator.indigitallOnNewUserRegistered(t)),Kt.registerLocation()}),navigator.indigitallOnError),M.setServiceTimestamp(Date.now())})).catch((t=>{e.e("No Registration: "+t).writeLog(),M.getPermissionPush()&&M.getPermissionPush()===Ut.EVENT_TYPE_REJECT||(K.callEventPermission(ct.PERMISSION_TYPE_PUSH,Ut.EVENT_TYPE_REJECT),M.setPermissionPush(Ut.EVENT_TYPE_REJECT)),Vt.isFunction(navigator.indigitallOnError)&&navigator.indigitallOnError(t)}))}static launchNotificationPermissionForSafari(){const t=new Ft(Gt);if(M.getSafariWebsitePushId()&&M.getDeviceId()){const t=window.safari.pushNotification.permission(M.getSafariWebsitePushId());Kt.checkRemotePermission(t)}else M.getSafariWebsitePushId()?t.w("error Device Id is not found").writeLog():t.w("error Safari Website Push Id is not found").writeLog()}static async checkRemotePermission(t){const e=new Ft(Gt);try{if("default"===t.permission){const t={deviceCode:M.getDeviceId()};e.d("permission default: ",t).writeLog(),M.getPermissionPush()||K.callEventPermission(ct.PERMISSION_TYPE_PUSH,Ut.EVENT_TYPE_ASK),window.safari.pushNotification.requestPermission(await nt.getURL()+"/safari",M.getSafariWebsitePushId(),t,window.indigitall.checkRemotePermission)}else"denied"===t.permission?(e.w("permission denied: ",t).writeLog(),M.getPermissionPush()&&M.getPermissionPush()!=Ut.EVENT_TYPE_REJECT&&(K.callEventPermission(ct.PERMISSION_TYPE_PUSH,Ut.EVENT_TYPE_REJECT),M.setPermissionPush(Ut.EVENT_TYPE_REJECT))):"granted"===t.permission&&(e.d("permission granted: ",t).writeLog(),M.getPermissionPush()&&M.getPermissionPush()!=Ut.EVENT_TYPE_ACCEPT&&(K.callEventPermission(ct.PERMISSION_TYPE_PUSH,Ut.EVENT_TYPE_ACCEPT),M.setPermissionPush(Ut.EVENT_TYPE_ACCEPT)),t.deviceToken&&t.deviceToken!==M.getPushToken()&&(M.setPushToken(t.deviceToken),nt.putDevice(new ut,(t=>{if(Vt.isFunction(navigator.indigitallOnInitialized)){const t={};t.push=M.getPermissionPush(),t.location=M.getPermissionLocation(),navigator.indigitallOnInitialized(t,new H)}Vt.isFunction(navigator.indigitallOnNewUserRegistered)&&!M.getNewUserTimestamp()&&(M.setNewUserTimestamp(Date.now()),navigator.indigitallOnNewUserRegistered(t)),Kt.registerLocation()}),navigator.indigitallOnError),M.setServiceTimestamp(Date.now()),M.setServiceTimestamp(Date.now())))}catch(t){Vt.isFunction(navigator.indigitallOnError)&&navigator.indigitallOnError(jt.showError(V,V.ErrorCode.PUSH_INITIALIZATION_ERROR,t))}}static registerLocation(){const t=new Ft(Gt);try{navigator.geolocation&&M.getRequestLocation()&&M.getLocationEnabled()&&(!M.getLocationTimestamp()||M.getLocationUpdateMinutes()<=(Date.now()-M.getLocationTimestamp())/6e4)&&(M.getPermissionLocation()||K.callEventPermission(ct.PERMISSION_TYPE_LOCATION,Ut.EVENT_TYPE_ASK),navigator.geolocation.getCurrentPosition((t=>{M.getPermissionLocation()||M.getPermissionLocation()==Ut.EVENT_TYPE_ACCEPT||(K.callEventPermission(ct.PERMISSION_TYPE_LOCATION,Ut.EVENT_TYPE_ACCEPT),M.setPermissionLocation(Ut.EVENT_TYPE_ACCEPT));const e=new G;e.setLocation(t.coords.latitude,t.coords.longitude),nt.postEventLocation(e),Vt.isFunction(navigator.indigitallOnLocationUpdated)&&navigator.indigitallOnLocationUpdated(t),M.setLocationTimestamp(Date.now())}),(e=>{t.e("error "+e).writeLog(),M.getPermissionLocation()||M.getPermissionLocation()==Ut.EVENT_TYPE_REJECT||(K.callEventPermission(ct.PERMISSION_TYPE_LOCATION,Ut.EVENT_TYPE_REJECT),M.setPermissionLocation(Ut.EVENT_TYPE_REJECT))})))}catch(t){Vt.isFunction(navigator.indigitallOnError)&&navigator.indigitallOnError(jt.showError(V,V.ErrorCode.PUSH_EVENT_ERROR,t))}}static requestPushPermission(t){ht.getPushPermission().then((e=>{Vt.isFunction(t)&&t(e)}))}static onPermissionChange(){ht.setPermissionCallback()}static requestLocationPermission(t){ht.getLocationPermission().then((e=>{Vt.isFunction(t)&&t(e)}))}static logIn(t,e,n){Kt.setExternalId(t,e,n)}static logout(t,e){Kt.setExternalId(null,t,e)}static setExternalCode(t,e,n){Kt.setExternalId(t,e,n)}static async setExternalId(t,e,n){try{const r=M.getAppKey();if(!r)return void(Vt.isFunction(n)&&n(jt.showError(V,V.ErrorCode.API_APPKEY_NOT_VALID)));if(null!=t){const i=await Yt.createHmac(r,t);i&&this.setExternalIdRequest(i,e,n)}else this.setExternalIdRequest(null,e,n)}catch(t){Vt.isFunction(n)&&n(jt.showError(V,V.ErrorCode.PUSH_DEVICE_ERROR,t))}}static async setExternalIdRequest(t,e,n){const r=new ut;M.setExternalId(t),await M.setExternalIdRequest(t),r.setExternalCode(t),nt.putDevice(r,(t=>{Vt.isFunction(e)&&e(new H(t))}),n)}static sendCustomEvent(t,e,n){try{let r="",i={},o=!0;"string"==typeof t?r=t:"object"==typeof t&&(r=t.eventType,t.customData&&(i=t.customData),!1===t.async&&(o=t.async));const s=new G;s.setDeviceId(M.getDeviceId()),s.setEventType(r),s.setCustomData(i),null!=M.getExternalId()&&"null"!=M.getExternalId()?(s.setExternalCode(M.getExternalId()),s.setJourneyRequest(!0),!1===o?nt.postEventJourneySync(s,e,n):nt.postEventJourney(s,e,n)):!1===o?nt.postEventCustomSync(s,e,n):nt.postEventCustom(s,e,n)}catch(t){Vt.isFunction(navigator.indigitallOnError)&&navigator.indigitallOnError(jt.showError(V,V.ErrorCode.PUSH_EVENT_ERROR,t))}}static sendJourneyEvent(t,e,n){try{let r="",i={},o=!0;"string"==typeof t?r=t:"object"==typeof t&&(r=t.eventType,t.customData&&(i=t.customData),!1===t.async&&(o=t.async));const s=new G;s.setDeviceId(M.getDeviceId()),s.setExternalCodeRequest(),s.setEventType(r),s.setCustomData(i),s.setJourneyRequest(!0),!1===o?nt.postEventJourneySync(s,e,n):nt.postEventJourney(s,e,n)}catch(t){Vt.isFunction(navigator.indigitallOnError)&&navigator.indigitallOnError(jt.showError(V,V.ErrorCode.PUSH_EVENT_ERROR,t))}}static getInboxMessagesCount(t,e,n){Vt.isFunction(t.getAuthConfig)&&(navigator.indigitallGetAuthConfig=getAuthConfig),x.getMessagesCount(e,n)}static getInbox(t,e,n){Vt.isFunction(t.getAuthConfig)&&(navigator.indigitallGetAuthConfig=getAuthConfig),x.getInbox(e,n)}static getInboxWithPage(t,e,n,r,i,o,s,a){Vt.isFunction(t.getAuthConfig)&&(navigator.indigitallGetAuthConfig=getAuthConfig),x.getInboxWithPage(e,n,r,i,o,s,a)}static getCustomer(t,e){xt.getCustomer(t,e)}static getCustomerInformation(t,e){this.getCustomerInformationWithFields(null,t,e)}static getCustomerInformationWithFields(t,e,n){xt.getCustomerInformation(t,e,n)}static assignOrUpdateValueToCustomerFields(t,e,n){xt.updateValueToCustomerFields(t,e,n)}static deleteValuesFromCustomerFields(t,e,n){xt.deleteValuesFromCustomerFields(t,e,n)}static link(t,e,n,r){Kt.logIn(t,(t=>{xt.linkCustomer(e,n,r)}),(t=>{Vt.isFunction(r)&&r(t)}))}static unlink(t,e,n){Kt.logout((r=>{xt.unlinkCustomer(t,e,n)}),(t=>{Vt.isFunction(n)&&n(t)}))}}window.indigitall=Kt,window.indigitall.InApp=e(),window.indigitall.InApp.Utils=e().Utils,window.indigitall.Channel=kt,window.indigitall.LogLevel=Bt,window.indigitall.version=M.getVersion()})(),r})()));